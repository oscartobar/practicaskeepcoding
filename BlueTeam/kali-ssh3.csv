"@timestamp","_id","_ignored","_index","_score","agent.ephemeral_id","agent.id","agent.name","agent.name.text","agent.type","agent.version",channel,"component.binary","component.dataset","component.id","component.type","container.id","container.image.name","container.labels.org_opencontainers_image_authors","container.labels.org_opencontainers_image_base_name","container.labels.org_opencontainers_image_description","container.labels.org_opencontainers_image_documentation","container.labels.org_opencontainers_image_licenses","container.labels.org_opencontainers_image_ref_name","container.labels.org_opencontainers_image_revision","container.labels.org_opencontainers_image_source","container.labels.org_opencontainers_image_title","container.labels.org_opencontainers_image_url","container.labels.org_opencontainers_image_vendor","container.labels.org_opencontainers_image_version","container.name","data_stream.dataset","data_stream.namespace","data_stream.type","ecs.version","elastic_agent.id","elastic_agent.snapshot","elastic_agent.version","error.message","event.action","event.agent_id_status","event.category","event.code","event.created","event.dataset","event.ingested","event.kind","event.module","event.provider","event.type",eventlog,"file.directory","file.extension","file.name","file.path","file.path.text","host.architecture","host.containerized","host.hostname","host.id","host.ip","host.mac","host.name","host.os.build","host.os.codename","host.os.family","host.os.kernel","host.os.name","host.os.name.text","host.os.platform","host.os.type","host.os.version",id,"input.type","input_source","log.file.device_id","log.file.idxhi","log.file.idxlo","log.file.inode","log.file.path","log.file.vol","log.level","log.logger","log.offset","log.origin.file.line","log.origin.file.name","log.origin.function","log.source",message,"powershell.file.script_block_hash","powershell.file.script_block_id","powershell.file.script_block_text","powershell.sequence","powershell.total","service.name",stream,"user.id","winlog.activity_id","winlog.api","winlog.channel","winlog.computer_name","winlog.event_id","winlog.opcode","winlog.process.pid","winlog.process.thread.id","winlog.provider_guid","winlog.provider_name","winlog.record_id","winlog.task","winlog.user.domain","winlog.user.identifier","winlog.user.name","winlog.user.type","winlog.version"
"Jan 26, 2025 @ 22:04:38.519",AZSluEqFUxAORxFspb13,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","3ddd6de1-3e5a-4bd4-92a7-04d7f0e27626","d743733b-391f-44ff-b176-42cf5485ef34",parrot,"-",filebeat,"8.17.1","-","-","-","-","-","elastic-agent-8.17.1-b46c28","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","d743733b-391f-44ff-b176-42cf5485ef34",false,"8.17.1","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 22:05:14.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,parrot,0e1cc8d71b094c0b9bd6303327405c60,"192.168.250.100, fe80::3089:5ee2:8ca4:d46a","52-54-00-A0-A2-5E",parrot,"-",lory,debian,"6.10.11-amd64","Parrot Security","Parrot Security",debian,linux,"6.2 (lorikeet)","-",filestream,"-",28,"-","-",19227,"/opt/Elastic/Agent/data/elastic-agent-8.17.1-b46c28/logs/elastic-agent-20250127-1.ndjson","-",info,"-","3,809",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 22:04:27.375",AZSluEqFUxAORxFspb12,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","3ddd6de1-3e5a-4bd4-92a7-04d7f0e27626","d743733b-391f-44ff-b176-42cf5485ef34",parrot,"-",filebeat,"8.17.1","-","-","-","-","-","elastic-agent-8.17.1-b46c28","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","d743733b-391f-44ff-b176-42cf5485ef34",false,"8.17.1","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 22:05:14.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,parrot,0e1cc8d71b094c0b9bd6303327405c60,"192.168.250.100, fe80::3089:5ee2:8ca4:d46a","52-54-00-A0-A2-5E",parrot,"-",lory,debian,"6.10.11-amd64","Parrot Security","Parrot Security",debian,linux,"6.2 (lorikeet)","-",filestream,"-",28,"-","-",19204,"/opt/Elastic/Agent/data/elastic-agent-8.17.1-b46c28/logs/elastic-agent-20250127.ndjson","-",info,"-","3,809",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:20.267","AZSlmEqFUxAORxGeoT-u","-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:30.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","36,723","-","-","-","-","2025-01-27T02:30:20+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: exit 
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:17.179","AZSlmEqFUxAORxGeoT-s","-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:30.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","36,428","-","-","-","-","2025-01-27T02:30:17+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: cd ..
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:12.732","AZSlmEqFUxAORxGeoT-q","-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:30.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","36,132","-","-","-","-","2025-01-27T02:30:12+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: cd aa
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:09.940","AZSlmEqFUxAORxGeoT-o","-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:30.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","35,833","-","-","-","-","2025-01-27T02:30:09+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: mkdir aa
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:04.884",AZSlmEqFUxAORxFqoQmk,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:16.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","35,535","-","-","-","-","2025-01-27T02:30:04+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: dir 
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:30:01.420",AZSlmEqFUxAORxFqoQmi,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:30:16.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","35,243","-","-","-","-","2025-01-27T02:30:01+0000 [HoneyPotSSHTransport,4,192.168.0.7] Command found: ls 
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:11:14.563",AZSlh0qFUxAORxFAoCli,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:11:32.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","25,218","-","-","-","-","2025-01-27T02:11:14+0000 [HoneyPotSSHTransport,2,192.168.0.7] Command found: ls 
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:11:12.589",AZSlh0qFUxAORxFAoClg,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:11:32.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","24,920","-","-","-","-","2025-01-27T02:11:12+0000 [HoneyPotSSHTransport,2,192.168.0.7] Command found: cd prueba/
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 21:11:08.093",AZSlh0qFUxAORxFAoCle,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 21:11:32.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, 192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","24,612","-","-","-","-","2025-01-27T02:11:08+0000 [HoneyPotSSHTransport,2,192.168.0.7] Command found: mkdir prueba
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 19:44:29.920",AZSlN0qFUxAORxH2m5sZ,"-",".ds-logs-docker.container_logs-default-2025.01.16-000001","-","92ed5737-d862-4904-8980-d85b168cf1d0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,kali,filebeat,"8.17.0","-","-","-","-","-",ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4,"cowrie/cowrie","Michel Oosterhof <michel@oosterhof.net>","gcr.io/distroless/python3-debian12","Cowrie SSH/Telnet Honeypot","https://docs.cowrie.org","BSD-3-Clause","(empty)","Source control revision identifier for the packaged software.","https://github.com/cowrie/cowrie","Cowrie SSH/Telnet Honeypot","https://cowrie.org/",Cowrie,"(empty)","vigilant_moser","docker.container_logs",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","docker.container_logs","Jan 26, 2025 @ 19:44:55.000","-",docker,"-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.101, fe80::440b:b545:c45:ae87, 172.17.0.1, fe80::42:38ff:fe51:c55d, fe80::c80b:f2ff:fe4e:485b","02-42-38-51-C5-5D, 52-54-00-A8-96-C6, CA-0B-F2-4E-48-5B",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",2100222,"/var/lib/docker/containers/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4/ed99302cb07deda46bb0eaa93c62f2cdf486d6749c6fb4e081ae34a239f2b1a4-json.log","-","-","-","13,288","-","-","-","-","2025-01-27T00:44:29+0000 [HoneyPotSSHTransport,0,192.168.0.7] Command found: ls 
","-","-","-","-","-","-",stdout,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 19:08:04.566",AZSlIEqFUxAORxFHjLaB,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","8505ae6c-3010-42f5-932e-28283c7fe8f0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 19:19:03.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-38-51-C5-5D, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836142,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126-5.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 18:52:55.545",AZSlIEqFUxAORxFHjLZu,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","8505ae6c-3010-42f5-932e-28283c7fe8f0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 19:19:03.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-38-51-C5-5D, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836164,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126-4.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 16:39:40.261",AZSlIEqFUxAORxFHjLZp,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","8505ae6c-3010-42f5-932e-28283c7fe8f0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 19:19:03.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-38-51-C5-5D, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836133,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126-3.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 15:22:28.337",AZSlIEqFUxAORxFHjLZy,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","8505ae6c-3010-42f5-932e-28283c7fe8f0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 19:19:03.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.200.100, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-38-51-C5-5D, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836155,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126-2.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 15:15:25.117",AZSkQUqFUxAORxGVfvaZ,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","fe11df50-ab42-4893-a22f-bfb95e1fb0bc","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 15:15:49.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.0.4, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-F5-F4-3C-32, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836168,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126-1.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 15:14:09.252",AZSkQEqFUxAORxGCfVq8,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","b916ee6a-cf70-4ac3-a20a-db5f945c790c","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",kali,"-",filebeat,"8.17.0","-","-","-","-","-","elastic-agent-8.17.0-96f2b9","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","a84ffcf3-fe20-432e-94ad-4fc01e4f4098",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 15:14:38.000","-","-","-","-","-","-","-","-","-","-","x86_64",false,kali,30e662c5c81d4191bd2444a79c97d2e0,"192.168.0.4, fe80::440b:b545:c45:ae87, 172.17.0.1","02-42-79-84-25-B9, 52-54-00-A8-96-C6",kali,"-","kali-rolling",debian,"6.8.11-amd64","Kali GNU/Linux","Kali GNU/Linux",kali,linux,"2024.3","-",filestream,"-",65025,"-","-",1836131,"/opt/Elastic/Agent/data/elastic-agent-8.17.0-96f2b9/logs/elastic-agent-20250126.ndjson","-",info,"-","3,803",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in /opt/Elastic/Agent/capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 07:53:09.443",AZSkGDvraPYB5YGn4oA4,"-",".ds-logs-windows.powershell_operational-default-2025.01.16-000001","-","1b1740d7-63e5-4411-9ae3-c43191946b3d","da9a681c-3265-4f44-a820-d74d0444418d","DESKTOP-PGGB831","DESKTOP-PGGB831",filebeat,"8.17.0","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","windows.powershell_operational",default,logs,"8.0.0","da9a681c-3265-4f44-a820-d74d0444418d",false,"8.17.0","-","Ejecutar un comando remoto",verified,process,4104,"Jan 26, 2025 @ 07:53:10.598","windows.powershell_operational","Jan 26, 2025 @ 14:31:06.000",event,windows,"Microsoft-Windows-PowerShell",info,"-","C:\Users\PC\AppData\Local\Temp\SDIAG_90a9d252-1307-48dc-9aab-4143b5824556",ps1,"UtilityFunctions.ps1","C:\Users\PC\AppData\Local\Temp\SDIAG_90a9d252-1307-48dc-9aab-4143b5824556\UtilityFunctions.ps1","C:\Users\PC\AppData\Local\Temp\SDIAG_90a9d252-1307-48dc-9aab-4143b5824556\UtilityFunctions.ps1","x86_64","-","DESKTOP-PGGB831","caa1d453-ab67-4999-bba9-2a27f98fe24d","fe80::5266:3ed0:990b:b7ba, 192.168.0.5","52-54-00-F1-EB-C3","desktop-pggb831","19045.5371","-",windows,"10.0.19041.5369 (WinBuild.160101.0800)","Windows 10 Pro N","Windows 10 Pro N",windows,windows,"10.0","-",winlog,"-","-","-","-","-","-","-",advertencia,"-","-","-","-","-","-","Creando texto de bloque de script (4 de 4):

            }
        }
    }
    trap [Exception]
    {
        if($script:ExpectingException)
        {
            ""No admin helper class events were found."" | convertto-xml | Update-DiagReport -id DiagEvents -name ""Helper Class Events"" -verbosity Debug
        }
        else
        {
            ""Exception: "" + $_.Exception.GetType().FullName + "" Message: "" + $_.Exception.Message  | convertto-xml | Update-DiagReport -id DiagEventsFailure -name ""Helper Class Events"" -description ""Failed while retrieving helper class events."" -verbosity Debug
        }
        return
    }
}

function LoadResourceString($ResourceString)
{
    [string]$bufStr = $null
    $dll = ""NetworkDiagnosticSnapIn.dll""

    try
    {
        RegSnapin $dll
        
        $bufferSize = 512
        $buffer = New-Object System.Text.StringBuilder $bufferSize
        [Microsoft.Windows.Diagnosis.Network.NativeShellMethods]::SHLoadIndirectString($ResourceString, $buffer, $bufferSize, [IntPtr]::Zero)
        $bufStr = $buffer.ToString()
    }
    finally
    {
        UnregSnapin $dll
    }

    return $bufStr
}

function IsDPSStarted()
{
    $dpsService = get-service ""DPS""
    if($dpsService)
    {
        if($dpsService.Status -ne ""Running"")
        {
            return $false;
        }
    }
    return $true;
}

function IsDPSDisabled()
{
    $dpsService = gwmi win32_service -f ""name='DPS'""
    if($dpsService)
    {
        if($dpsService.StartMode -eq ""Disabled"")
        {
            return $true;
        }
    }
    return $false;
}

function IsSafeMode()
{
    [void] [Reflection.Assembly]::LoadWithPartialName(""System.Windows.Forms"")
    return [System.Windows.Forms.SystemInformation]::BootMode -ne 0
}

function IsHelpTopicAllowed($Link)
{
    $regValue = get-itemproperty -path hklm:\SYSTEM\CurrentControlSet\Control\NetDiagFx\Config\HelpTopic  -name $Link -ErrorAction SilentlyContinue -ErrorVariable regError
    if($regValue)
    {
        # check the DWORD value (the key to the value is the Value name: i.e., $Link) 
        # 1         - enabled
        # otherwise - disabled
        $filterValue = $regValue.$Link;
        if($filterValue -eq 1)
        {
            return $true;
        }
        else
        {
            return $false;
        }
    }
    elseif ($regError)
    {
        if(!($regError[0].CategoryInfo.Category -eq ""InvalidArgument"") -and  !($regError[0].CategoryInfo.Category -eq ""ObjectNotFound""))
        {
            "" Warning: Unexpected error when reading Help Topic Cause key : "" + $regError[0].CategoryInfo.Category | convertto-xml | Update-DiagReport -id UnexpectedRegError -name ""Unexpected Registry Error"" -verbosity Debug
        }
        return $false;
    }
}


Id. de bloque de script: 9717733f-6cca-4044-97f4-9c3e91ee9ede
Ruta de acceso: C:\Users\PC\AppData\Local\Temp\SDIAG_90a9d252-1307-48dc-9aab-4143b5824556\UtilityFunctions.ps1","WfTDdJa2NIMgUXGZfBUar22258o=","9717733f-6cca-4044-97f4-9c3e91ee9ede","}
        }
    }
    trap [Exception]
    {
        if($script:ExpectingException)
        {
            ""No admin helper class events were found."" | convertto-xml | Update-DiagReport -id DiagEvents -name ""Helper Class Events"" -verbosity Debug
        }
        else
        {
            ""Exception: "" + $_.Exception.GetType().FullName + "" Message: "" + $_.Exception.Message  | convertto-xml | Update-DiagReport -id DiagEventsFailure -name ""Helper Class Events"" -description ""Failed while retrieving helper class events."" -verbosity Debug
        }
        return
    }
}

function LoadResourceString($ResourceString)
{
    [string]$bufStr = $null
    $dll = ""NetworkDiagnosticSnapIn.dll""

    try
    {
        RegSnapin $dll
        
        $bufferSize = 512
        $buffer = New-Object System.Text.StringBuilder $bufferSize
        [Microsoft.Windows.Diagnosis.Network.NativeShellMethods]::SHLoadIndirectString($ResourceString, $buffer, $bufferSize, [IntPtr]::Zero)
        $bufStr = $buffer.ToString()
    }
    finally
    {
        UnregSnapin $dll
    }

    return $bufStr
}

function IsDPSStarted()
{
    $dpsService = get-service ""DPS""
    if($dpsService)
    {
        if($dpsService.Status -ne ""Running"")
        {
            return $false;
        }
    }
    return $true;
}

function IsDPSDisabled()
{
    $dpsService = gwmi win32_service -f ""name='DPS'""
    if($dpsService)
    {
        if($dpsService.StartMode -eq ""Disabled"")
        {
            return $true;
        }
    }
    return $false;
}

function IsSafeMode()
{
    [void] [Reflection.Assembly]::LoadWithPartialName(""System.Windows.Forms"")
    return [System.Windows.Forms.SystemInformation]::BootMode -ne 0
}

function IsHelpTopicAllowed($Link)
{
    $regValue = get-itemproperty -path hklm:\SYSTEM\CurrentControlSet\Control\NetDiagFx\Config\HelpTopic  -name $Link -ErrorAction SilentlyContinue -ErrorVariable regError
    if($regValue)
    {
        # check the DWORD value (the key to the value is the Value name: i.e., $Link) 
        # 1         - enabled
        # otherwise - disabled
        $filterValue = $regValue.$Link;
        if($filterValue -eq 1)
        {
            return $true;
        }
        else
        {
            return $false;
        }
    }
    elseif ($regError)
    {
        if(!($regError[0].CategoryInfo.Category -eq ""InvalidArgument"") -and  !($regError[0].CategoryInfo.Category -eq ""ObjectNotFound""))
        {
            "" Warning: Unexpected error when reading Help Topic Cause key : "" + $regError[0].CategoryInfo.Category | convertto-xml | Update-DiagReport -id UnexpectedRegError -name ""Unexpected Registry Error"" -verbosity Debug
        }
        return $false;
    }
}",4,4,"-","-","S-1-5-21-2510084649-976009835-3302264030-1001","{efbe5ff7-6fed-0000-5774-beefed6fdb01}",wineventlog,"Microsoft-Windows-PowerShell/Operational","DESKTOP-PGGB831",4104,"Al crear llamadas","5,668","9,540","{a0c1853b-5c40-4b15-8766-3cf1c58f985a}","Microsoft-Windows-PowerShell",31475,"Ejecutar un comando remoto","DESKTOP-PGGB831","S-1-5-21-2510084649-976009835-3302264030-1001",PC,User,1
"Jan 26, 2025 @ 07:44:25.439",AZSkGDvraPYB5YGn4oAS,"-",".ds-logs-windows.powershell_operational-default-2025.01.16-000001","-","1b1740d7-63e5-4411-9ae3-c43191946b3d","da9a681c-3265-4f44-a820-d74d0444418d","DESKTOP-PGGB831","DESKTOP-PGGB831",filebeat,"8.17.0","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","windows.powershell_operational",default,logs,"8.0.0","da9a681c-3265-4f44-a820-d74d0444418d",false,"8.17.0","-","Ejecutar un comando remoto",verified,process,4104,"Jan 26, 2025 @ 07:44:27.428","windows.powershell_operational","Jan 26, 2025 @ 14:31:06.000",event,windows,"Microsoft-Windows-PowerShell",info,"-","C:\WINDOWS\TEMP\SDIAG_ebfdc8f0-b955-4066-a80e-bdce86d374e2",ps1,"CL_Utility.ps1","C:\WINDOWS\TEMP\SDIAG_ebfdc8f0-b955-4066-a80e-bdce86d374e2\CL_Utility.ps1","C:\WINDOWS\TEMP\SDIAG_ebfdc8f0-b955-4066-a80e-bdce86d374e2\CL_Utility.ps1","x86_64","-","DESKTOP-PGGB831","caa1d453-ab67-4999-bba9-2a27f98fe24d","fe80::5266:3ed0:990b:b7ba, 192.168.0.5","52-54-00-F1-EB-C3","desktop-pggb831","19045.5371","-",windows,"10.0.19041.5369 (WinBuild.160101.0800)","Windows 10 Pro N","Windows 10 Pro N",windows,windows,"10.0","-",winlog,"-","-","-","-","-","-","-",advertencia,"-","-","-","-","-","-","Creando texto de bloque de script (1 de 1):
# Copyright Â© 2008, Microsoft Corporation. All rights reserved.


#Common utility functions
Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData

# Function to get user troubleshooting history
function Get-UserTSHistoryPath {
    return ""${env:localappdata}\diagnostics""
}

# Function to get admin troubleshooting history
function Get-AdminTSHistoryPath {
    return ""${env:localappdata}\elevateddiagnostics""
}

# Function to get user report folder path
function Get-UserReportPath {
    return ""${env:localappdata}\Microsoft\Windows\WER\ReportQueue""
}

# Function to get system report folder path
function Get-MachineReportPath {
    return ""${env:AllUsersProfile}\Microsoft\Windows\WER\ReportQueue""
}

# Function to get threshold to check whether a folder is old
function Get-ThresholdForCheckOlderFile {
    [int]$threshold = -1
    return $threshold
}

# Function to get threshold for deleting WER folder
function Get-ThresholdForFileDeleting() {
    [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting""
    [string]$registryEntryName = ""PurgeThreshholdValueInKB""
    [double]$defaultValue = 10.0

    return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue
}

# Function to get the size of a directory in kb
function Get-FolderSize([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return 0
    }

    if(-not $Global:DirectoryObject) {
        $Global:DirectoryObject = New-Object -comobject ""Scripting.FileSystemObject""
    }

    return ($Global:DirectoryObject.GetFolder($folder).Size) / 1kb
}

# Function to delete a folder
function Delete-Folder([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return
    }

    Remove-Item -literalPath $folder -Recurse -Force
}

# Function to delete old folders
function Delete-OldFolders($folder=$(throw ""No folder is specified"")) {
    if(($folder -eq $null) -or (-not(Test-Path $folder))) {
        return
    }

    [int]$threshold = Get-ThresholdForCheckOlderFile
    $folders = Get-ChildItem -LiteralPath ($folder.FullName) -Force | Where-Object {$_.PSIsContainer}
    if($folders -ne $null) {
        foreach($folder in $folders) {
            if((($folder.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0) {
                Delete-Folder ($folder.FullName)
            } else {
                Delete-OldFolders (Get-Item ($folder.FullName))
            }
        }
    }
}

# Function to get registry value
function Get-RegistryValue([string]$registryEntryPath = $(throw ""No registry entry path is specified""), [string]$registryEntryName = $(throw ""No registry entry name is specified""), [double]$defaultValue = 0.0) {
    [double]$registryEntryValue = $defaultValue

    $registryEntry = Get-ItemProperty -Path $registryEntryPath -Name $registryEntryName
    if($registryEntry -ne $null) {
        $registryEntryValue = $registryEntry.$registryEntryName
    }

	return $registryEntryValue
}

# Function to get the percentage that WER queue can take up
function Get-Percentage() {
    [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting""
    [string]$registryEntryName = ""MaxQueueSizePercentage""
    [double]$defaultValue = 100.0

    return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue
}

# Function to get free disk space on machine
function Get-FreeSpace {
    [double]$freeSpace = 0.0
    [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12""
    $drives = Get-WmiObject -query $wql
    if($null -ne $drives) {
        foreach($drive in $drives) {
            $freeSpace += ($drive.freeSpace)
        }
    }

    return ($freeSpace / 1KB)
}

# Function to get all unnecessary files
function Get-UnnecessaryFiles([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return $null
    }

    [int]$threshold = Get-ThresholdForCheckOlderFile

    return (Get-ChildItem -literalPath $folder -Recurse -Force | Where-Object {($_.PSIsContainer) -and ((($_.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0)})
}

# Function to format disk space (KB -> MB)
function Format-DiskSpaceMB([double]$space = $(throw ""No space is specified"")) {
    return [string]([Math]::Round(($space / 1KB), 3))
}

# Function to format disk space (B -> GB)
Function Format-DiskSpaceGB([double]$space = $(throw ""No space is specified"")) {
    return [string]([Math]::Round(($space / 1GB), 3))
}

# Function to attach item to the list with delimiter ""/""
function AttachTo-List([string]$list = $(throw ""No list is specified""), [string]$item = $(throw ""No item is specified""))
{
    if([String]::IsNullOrEmpty($list))
    {
        return $item
    }

    if([String]::IsNullOrEmpty($item))
    {
        return $list
    }

    return $list + ""/"" + $item
}

# Function to parse the the list with delimiter ""/""
function Parse-List([string]$list = $(throw ""No list is specified""))
{
    if($list -eq $null)
    {
        return $null
    }

    return $list.Split(""/"", [StringSplitOptions]::RemoveEmptyEntries)
}

# Function to get list length
function Get-ListLength([string]$list = $(throw ""No list is specified""))
{
    if($list -eq $null)
    {
        return 0
    }

    $result = Parse-List $list

    if($result -is [string])
    {
        return 1
    }
    elseif($result -is [object[]])
    {
        return $result.count
    }
    else
    {
        return 0
    }
}

# Function to convert to WQL path
function ConvertTo-WQLPath([string]$wqlPath = $(throw ""No WQL path is specified""))
{
    if($wqlPath -eq $null)
    {
        return """"
    }

    return $wqlPath.Replace(""\"", ""\\"")
}

# Function to check whether the shortcut is valid
function Test-ValidLink([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified""))
{
    if(($wmiLinkFile -eq $null) -or ([String]::IsNullOrEmpty($wmiLinkFile.Target)))
    {
        return $false
    }

    return Test-Path $wmiLinkFile.Target
}

# Function to chech whether have permission to delete the shortcut file
function Test-Delete([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified""))
{
    if($wmiLinkFile -eq $null)
    {
        return $false
    }

    return ($wmiLinkFile.AccessMask -band 0x10000) -eq 0x10000
}

# Function to get desktop path
function Get-DesktopPath()
{
$methodDefinition = @""
    public static string GetDesktopPath
    {
        get
        {
            return Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);
        }
    }
""@

    $type = Add-Type -MemberDefinition $methodDefinition -Name ""DesktopPath"" -PassThru

    return $type::GetDesktopPath
}

# Function to get startup path
function Get-StartupPath()
{
$methodDefinition = @""
    public static string GetStartupPath
    {
        get
        {
            return Environment.GetFolderPath(Environment.SpecialFolder.Startup);
        }
    }
""@

    $type = Add-Type -MemberDefinition $methodDefinition -Name ""StartupPath"" -PassThru

    return $type::GetStartupPath
}

# Function to remove all files in the list
function Remove-FileList([string]$list = $(throw ""No list is specified""))
{
    if([String]::IsNullOrEmpty($list))
    {
        return
    }

    try
    {
        Parse-List $list | Foreach-Object {
            if(-not([String]::IsNullOrEmpty($_)))
            {
                Remove-Item $_ -Force
            }
        }
    }
    catch
    {
        $_ | ConvertTo-Xml | Update-DiagReport -id DeleteFileExceptions -Name $localizationString.filesFailToRemove_name -Description $localizationString.filesFailToRemove_description -Verbosity Warning
    }
}

# Function to get the last access time of an Icon
function Get-LastAccessTime([string]$filePath = $(throw ""No file path is specified""))
{
    if([String]::IsNullOrEmpty($filePath) -or -not(Test-Path $filePath))
    {
        throw ""No file path found""
    }

$typeDefinition = @""

using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using ComType = System.Runtime.InteropServices.ComTypes;

public sealed class FileInfo
{
    private FileInfo()
    {
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    struct UAINFO
    {
        internal int cbSize;
        internal int dwMask;
        internal float R;
        internal uint cLaunches;
        internal uint cSwitches;
        internal int dwTime;
        internal ComType.FILETIME ftExecute;
        [MarshalAs(UnmanagedType.Bool)] internal bool fExcludeFromMFU;

        internal UAINFO(int dwMask)
        {
            this.cbSize = Marshal.SizeOf(typeof(UAINFO));
            this.dwMask = dwMask;
            this.R = 0;
            this.cLaunches = 0;
            this.cSwitches = 0;
            this.dwTime = 0;
            this.ftExecute = new ComType.FILETIME();
            this.fExcludeFromMFU = false;
        }
    }

    internal const int UAIM_FILETIME = 1;
    internal static Guid UAIID_SHORTCUTS = new Guid(""F4E57C4B-2036-45F0-A9AB-443BCFE33D9F"");

    [ComImport, Guid(""90D75131-43A6-4664-9AF8-DCCEB85A7462""), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    interface IShellUserAssist
    {
        int FireEvent(ref Guid pguidGrp, int eCmd, string pszPath, int dwTimeElapsed);
        int QueryEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui);
        int SetEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui);
        int RenameEntry(ref Guid pguidGrp, string pszFrom, string pszTo);
        int DeleteEntry(ref Guid pguidGrp, string pszPath);
        int Enable(bool fEnable);
    }

    [ComImport, Guid(""DD313E04-FEFF-11d1-8ECD-0000F87A470C"")]
    internal class UserAssist { }

    public static DateTime GetLastAccessTime(string filePath)
    {
        if(String.IsNullOrEmpty(filePath))
        {
            throw new ArgumentException(""The file path is null or empty"");
        }

        UAINFO uaInfo = new UAINFO(UAIM_FILETIME);
        IShellUserAssist iShellUserAssist = new UserAssist() as IShellUserAssist;
        if (iShellUserAssist == null)
        {
            throw new InvalidOperationException(""Can't get iShellUserAssist interface"");
        }

        try
        {
            Marshal.ThrowExceptionForHR(iShellUserAssist.QueryEntry(ref UAIID_SHORTCUTS, filePath, ref uaInfo));
        }
        catch
        {
            throw new InvalidOperationException(""Can't query info about"" + filePath);
        }

        long fileTime = (((long)uaInfo.ftExecute.dwHighDateTime) << 32) + uaInfo.ftExecute.dwLowDateTime;

        return DateTime.FromFileTime(fileTime);
    }
}
""@

    $type = Add-Type -TypeDefinition $typeDefinition -PassThru

    return $type[0]::GetLastAccessTime($filePath)
}

# Function to check whether the icon is pointing to a file
function Test-FileShortcut([Wmi]$wmiLinkFile = $(throw ""No wmi link file is specified""))
{
    if($wmiLinkFile -eq $null)
    {
        return $false
    }

    [string]$target = $wmiLinkFile.Target
    if([String]::IsNullOrEmpty($target) -or -not(Test-Path $target))
    {
        return $false
    }

    return -not((Get-Item $target).PSIsContainer)
}

# Function to create a choice in interaction page
function Get-Choice([string]$name = $(throw ""No choice name is specified""), [string]$description = $(throw ""No choice description is specified""),
                   [string]$value = $(throw ""No choice value is specified""), [xml]$extension)
{
    return @{""Name""=$name;""Description""=$description;""Value""=$value;""ExtensionPoint""=$extension.InnerXml}
}

# Function to check whether the current machine is domain joined
Function Test-DomainJoined()
{
    return (Get-WmiObject -query ""select * from win32_ntdomain where Status ='OK'"") -ne $null
}

# Function to update time source
Function Update-TimeSource([string]$timeSource = $(throw ""No time source is specified""))
{
    w32tm.exe /config /update /manualpeerlist:""$timeSource""
}

# Function to get system drive info
function Get-SystemDriveInfo() {
    [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12 AND Name = '"" + ${env:systemdrive} + ""'""
    return Get-WmiObject -query $wql
}

# Function to get time service status
function Get-ServiceStatus([string]$serviceName=$(throw ""No service name is specified"")) {
   [bool]$startService = $true

   [WMI]$timeService = @(Get-WmiObject -Query ""Select * From Win32_Service Where Name = `""$serviceName`"""")[0]
   if($null -ne $timeService) {
      [ServiceProcess.ServiceControllerStatus]$timeServicesStatus = (Get-Service $serviceName).Status
      if(([ServiceProcess.ServiceControllerStatus]::Stopped -eq $timeServicesStatus) -or ([ServiceProcess.ServiceControllerStatus]::StopPending -eq $timeServicesStatus)) {
         $startService = $false
      }
   }

   return $startService
}

# Function to wait for expected service status
function WaitFor-ServiceStatus([string]$serviceName=$(throw ""No service name is specified""), [ServiceProcess.ServiceControllerStatus]$serviceStatus=$(throw ""No service status is specified"")) {
    [ServiceProcess.ServiceController]$sc = New-Object ""ServiceProcess.ServiceController"" $serviceName
    [TimeSpan]$timeOut = New-Object TimeSpan(0,0,0,5,0)
    $sc.WaitForStatus($serviceStatus, $timeOut)
}

Id. de bloque de script: 89b410bb-e4ac-43cf-ba05-eabec14a64fd
Ruta de acceso: C:\WINDOWS\TEMP\SDIAG_ebfdc8f0-b955-4066-a80e-bdce86d374e2\CL_Utility.ps1","0pGnkCL8x8hai2EgE2ybNM885GI=","89b410bb-e4ac-43cf-ba05-eabec14a64fd","# Copyright Â© 2008, Microsoft Corporation. All rights reserved.


#Common utility functions
Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData

# Function to get user troubleshooting history
function Get-UserTSHistoryPath {
    return ""${env:localappdata}\diagnostics""
}

# Function to get admin troubleshooting history
function Get-AdminTSHistoryPath {
    return ""${env:localappdata}\elevateddiagnostics""
}

# Function to get user report folder path
function Get-UserReportPath {
    return ""${env:localappdata}\Microsoft\Windows\WER\ReportQueue""
}

# Function to get system report folder path
function Get-MachineReportPath {
    return ""${env:AllUsersProfile}\Microsoft\Windows\WER\ReportQueue""
}

# Function to get threshold to check whether a folder is old
function Get-ThresholdForCheckOlderFile {
    [int]$threshold = -1
    return $threshold
}

# Function to get threshold for deleting WER folder
function Get-ThresholdForFileDeleting() {
    [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting""
    [string]$registryEntryName = ""PurgeThreshholdValueInKB""
    [double]$defaultValue = 10.0

    return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue
}

# Function to get the size of a directory in kb
function Get-FolderSize([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return 0
    }

    if(-not $Global:DirectoryObject) {
        $Global:DirectoryObject = New-Object -comobject ""Scripting.FileSystemObject""
    }

    return ($Global:DirectoryObject.GetFolder($folder).Size) / 1kb
}

# Function to delete a folder
function Delete-Folder([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return
    }

    Remove-Item -literalPath $folder -Recurse -Force
}

# Function to delete old folders
function Delete-OldFolders($folder=$(throw ""No folder is specified"")) {
    if(($folder -eq $null) -or (-not(Test-Path $folder))) {
        return
    }

    [int]$threshold = Get-ThresholdForCheckOlderFile
    $folders = Get-ChildItem -LiteralPath ($folder.FullName) -Force | Where-Object {$_.PSIsContainer}
    if($folders -ne $null) {
        foreach($folder in $folders) {
            if((($folder.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0) {
                Delete-Folder ($folder.FullName)
            } else {
                Delete-OldFolders (Get-Item ($folder.FullName))
            }
        }
    }
}

# Function to get registry value
function Get-RegistryValue([string]$registryEntryPath = $(throw ""No registry entry path is specified""), [string]$registryEntryName = $(throw ""No registry entry name is specified""), [double]$defaultValue = 0.0) {
    [double]$registryEntryValue = $defaultValue

    $registryEntry = Get-ItemProperty -Path $registryEntryPath -Name $registryEntryName
    if($registryEntry -ne $null) {
        $registryEntryValue = $registryEntry.$registryEntryName
    }

	return $registryEntryValue
}

# Function to get the percentage that WER queue can take up
function Get-Percentage() {
    [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting""
    [string]$registryEntryName = ""MaxQueueSizePercentage""
    [double]$defaultValue = 100.0

    return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue
}

# Function to get free disk space on machine
function Get-FreeSpace {
    [double]$freeSpace = 0.0
    [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12""
    $drives = Get-WmiObject -query $wql
    if($null -ne $drives) {
        foreach($drive in $drives) {
            $freeSpace += ($drive.freeSpace)
        }
    }

    return ($freeSpace / 1KB)
}

# Function to get all unnecessary files
function Get-UnnecessaryFiles([string]$folder = $(throw ""No folder is specified"")) {
    if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) {
        return $null
    }

    [int]$threshold = Get-ThresholdForCheckOlderFile

    return (Get-ChildItem -literalPath $folder -Recurse -Force | Where-Object {($_.PSIsContainer) -and ((($_.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0)})
}

# Function to format disk space (KB -> MB)
function Format-DiskSpaceMB([double]$space = $(throw ""No space is specified"")) {
    return [string]([Math]::Round(($space / 1KB), 3))
}

# Function to format disk space (B -> GB)
Function Format-DiskSpaceGB([double]$space = $(throw ""No space is specified"")) {
    return [string]([Math]::Round(($space / 1GB), 3))
}

# Function to attach item to the list with delimiter ""/""
function AttachTo-List([string]$list = $(throw ""No list is specified""), [string]$item = $(throw ""No item is specified""))
{
    if([String]::IsNullOrEmpty($list))
    {
        return $item
    }

    if([String]::IsNullOrEmpty($item))
    {
        return $list
    }

    return $list + ""/"" + $item
}

# Function to parse the the list with delimiter ""/""
function Parse-List([string]$list = $(throw ""No list is specified""))
{
    if($list -eq $null)
    {
        return $null
    }

    return $list.Split(""/"", [StringSplitOptions]::RemoveEmptyEntries)
}

# Function to get list length
function Get-ListLength([string]$list = $(throw ""No list is specified""))
{
    if($list -eq $null)
    {
        return 0
    }

    $result = Parse-List $list

    if($result -is [string])
    {
        return 1
    }
    elseif($result -is [object[]])
    {
        return $result.count
    }
    else
    {
        return 0
    }
}

# Function to convert to WQL path
function ConvertTo-WQLPath([string]$wqlPath = $(throw ""No WQL path is specified""))
{
    if($wqlPath -eq $null)
    {
        return """"
    }

    return $wqlPath.Replace(""\"", ""\\"")
}

# Function to check whether the shortcut is valid
function Test-ValidLink([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified""))
{
    if(($wmiLinkFile -eq $null) -or ([String]::IsNullOrEmpty($wmiLinkFile.Target)))
    {
        return $false
    }

    return Test-Path $wmiLinkFile.Target
}

# Function to chech whether have permission to delete the shortcut file
function Test-Delete([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified""))
{
    if($wmiLinkFile -eq $null)
    {
        return $false
    }

    return ($wmiLinkFile.AccessMask -band 0x10000) -eq 0x10000
}

# Function to get desktop path
function Get-DesktopPath()
{
$methodDefinition = @""
    public static string GetDesktopPath
    {
        get
        {
            return Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory);
        }
    }
""@

    $type = Add-Type -MemberDefinition $methodDefinition -Name ""DesktopPath"" -PassThru

    return $type::GetDesktopPath
}

# Function to get startup path
function Get-StartupPath()
{
$methodDefinition = @""
    public static string GetStartupPath
    {
        get
        {
            return Environment.GetFolderPath(Environment.SpecialFolder.Startup);
        }
    }
""@

    $type = Add-Type -MemberDefinition $methodDefinition -Name ""StartupPath"" -PassThru

    return $type::GetStartupPath
}

# Function to remove all files in the list
function Remove-FileList([string]$list = $(throw ""No list is specified""))
{
    if([String]::IsNullOrEmpty($list))
    {
        return
    }

    try
    {
        Parse-List $list | Foreach-Object {
            if(-not([String]::IsNullOrEmpty($_)))
            {
                Remove-Item $_ -Force
            }
        }
    }
    catch
    {
        $_ | ConvertTo-Xml | Update-DiagReport -id DeleteFileExceptions -Name $localizationString.filesFailToRemove_name -Description $localizationString.filesFailToRemove_description -Verbosity Warning
    }
}

# Function to get the last access time of an Icon
function Get-LastAccessTime([string]$filePath = $(throw ""No file path is specified""))
{
    if([String]::IsNullOrEmpty($filePath) -or -not(Test-Path $filePath))
    {
        throw ""No file path found""
    }

$typeDefinition = @""

using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using ComType = System.Runtime.InteropServices.ComTypes;

public sealed class FileInfo
{
    private FileInfo()
    {
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    struct UAINFO
    {
        internal int cbSize;
        internal int dwMask;
        internal float R;
        internal uint cLaunches;
        internal uint cSwitches;
        internal int dwTime;
        internal ComType.FILETIME ftExecute;
        [MarshalAs(UnmanagedType.Bool)] internal bool fExcludeFromMFU;

        internal UAINFO(int dwMask)
        {
            this.cbSize = Marshal.SizeOf(typeof(UAINFO));
            this.dwMask = dwMask;
            this.R = 0;
            this.cLaunches = 0;
            this.cSwitches = 0;
            this.dwTime = 0;
            this.ftExecute = new ComType.FILETIME();
            this.fExcludeFromMFU = false;
        }
    }

    internal const int UAIM_FILETIME = 1;
    internal static Guid UAIID_SHORTCUTS = new Guid(""F4E57C4B-2036-45F0-A9AB-443BCFE33D9F"");

    [ComImport, Guid(""90D75131-43A6-4664-9AF8-DCCEB85A7462""), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    interface IShellUserAssist
    {
        int FireEvent(ref Guid pguidGrp, int eCmd, string pszPath, int dwTimeElapsed);
        int QueryEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui);
        int SetEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui);
        int RenameEntry(ref Guid pguidGrp, string pszFrom, string pszTo);
        int DeleteEntry(ref Guid pguidGrp, string pszPath);
        int Enable(bool fEnable);
    }

    [ComImport, Guid(""DD313E04-FEFF-11d1-8ECD-0000F87A470C"")]
    internal class UserAssist { }

    public static DateTime GetLastAccessTime(string filePath)
    {
        if(String.IsNullOrEmpty(filePath))
        {
            throw new ArgumentException(""The file path is null or empty"");
        }

        UAINFO uaInfo = new UAINFO(UAIM_FILETIME);
        IShellUserAssist iShellUserAssist = new UserAssist() as IShellUserAssist;
        if (iShellUserAssist == null)
        {
            throw new InvalidOperationException(""Can't get iShellUserAssist interface"");
        }

        try
        {
            Marshal.ThrowExceptionForHR(iShellUserAssist.QueryEntry(ref UAIID_SHORTCUTS, filePath, ref uaInfo));
        }
        catch
        {
            throw new InvalidOperationException(""Can't query info about"" + filePath);
        }

        long fileTime = (((long)uaInfo.ftExecute.dwHighDateTime) << 32) + uaInfo.ftExecute.dwLowDateTime;

        return DateTime.FromFileTime(fileTime);
    }
}
""@

    $type = Add-Type -TypeDefinition $typeDefinition -PassThru

    return $type[0]::GetLastAccessTime($filePath)
}

# Function to check whether the icon is pointing to a file
function Test-FileShortcut([Wmi]$wmiLinkFile = $(throw ""No wmi link file is specified""))
{
    if($wmiLinkFile -eq $null)
    {
        return $false
    }

    [string]$target = $wmiLinkFile.Target
    if([String]::IsNullOrEmpty($target) -or -not(Test-Path $target))
    {
        return $false
    }

    return -not((Get-Item $target).PSIsContainer)
}

# Function to create a choice in interaction page
function Get-Choice([string]$name = $(throw ""No choice name is specified""), [string]$description = $(throw ""No choice description is specified""),
                   [string]$value = $(throw ""No choice value is specified""), [xml]$extension)
{
    return @{""Name""=$name;""Description""=$description;""Value""=$value;""ExtensionPoint""=$extension.InnerXml}
}

# Function to check whether the current machine is domain joined
Function Test-DomainJoined()
{
    return (Get-WmiObject -query ""select * from win32_ntdomain where Status ='OK'"") -ne $null
}

# Function to update time source
Function Update-TimeSource([string]$timeSource = $(throw ""No time source is specified""))
{
    w32tm.exe /config /update /manualpeerlist:""$timeSource""
}

# Function to get system drive info
function Get-SystemDriveInfo() {
    [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12 AND Name = '"" + ${env:systemdrive} + ""'""
    return Get-WmiObject -query $wql
}

# Function to get time service status
function Get-ServiceStatus([string]$serviceName=$(throw ""No service name is specified"")) {
   [bool]$startService = $true

   [WMI]$timeService = @(Get-WmiObject -Query ""Select * From Win32_Service Where Name = `""$serviceName`"""")[0]
   if($null -ne $timeService) {
      [ServiceProcess.ServiceControllerStatus]$timeServicesStatus = (Get-Service $serviceName).Status
      if(([ServiceProcess.ServiceControllerStatus]::Stopped -eq $timeServicesStatus) -or ([ServiceProcess.ServiceControllerStatus]::StopPending -eq $timeServicesStatus)) {
         $startService = $false
      }
   }

   return $startService
}

# Function to wait for expected service status
function WaitFor-ServiceStatus([string]$serviceName=$(throw ""No service name is specified""), [ServiceProcess.ServiceControllerStatus]$serviceStatus=$(throw ""No service status is specified"")) {
    [ServiceProcess.ServiceController]$sc = New-Object ""ServiceProcess.ServiceController"" $serviceName
    [TimeSpan]$timeOut = New-Object TimeSpan(0,0,0,5,0)
    $sc.WaitForStatus($serviceStatus, $timeOut)
}",1,1,"-","-","S-1-5-21-2510084649-976009835-3302264030-1001","{efbe5ff7-6fed-0000-dc70-beefed6fdb01}",wineventlog,"Microsoft-Windows-PowerShell/Operational","DESKTOP-PGGB831",4104,"Al crear llamadas","6,344","4,032","{a0c1853b-5c40-4b15-8766-3cf1c58f985a}","Microsoft-Windows-PowerShell",31470,"Ejecutar un comando remoto","DESKTOP-PGGB831","S-1-5-21-2510084649-976009835-3302264030-1001",PC,User,1
"Jan 26, 2025 @ 07:30:12.203",AZSkFzvraPYB5YHX2THn,"-",".ds-logs-elastic_agent.filebeat-default-2025.01.16-000001","-","dc32aca6-a92d-4b83-94af-3651bdcacf6d","da9a681c-3265-4f44-a820-d74d0444418d","DESKTOP-PGGB831","-",filebeat,"8.17.0","Microsoft-Windows-Sysmon/Operational",filebeat,"elastic_agent.filebeat","winlog-default",winlog,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent.filebeat",default,logs,"8.0.0","da9a681c-3265-4f44-a820-d74d0444418d",false,"8.17.0","No se encontrÃ³ el canal especificado.","-",verified,"-","-","-","elastic_agent.filebeat","Jan 26, 2025 @ 14:30:13.000","-","-","-","-","winlog-windows.sysmon_operational-8aec0dd6-a34d-4122-a5ef-708e7473756d","-","-","-","-","-","x86_64","-","DESKTOP-PGGB831","caa1d453-ab67-4999-bba9-2a27f98fe24d","fe80::5266:3ed0:990b:b7ba, 192.168.1.100","52-54-00-F1-EB-C3","desktop-pggb831","19045.5371","-",windows,"10.0.19041.5369 (WinBuild.160101.0800)","Windows 10 Pro N","Windows 10 Pro N",windows,windows,"10.0","winlog-windows.sysmon_operational-8aec0dd6-a34d-4122-a5ef-708e7473756d",filestream,"winlog-windows.sysmon_operational-8aec0dd6-a34d-4122-a5ef-708e7473756d","-",393216,13070,"-","C:\Program Files\Elastic\Agent\data\elastic-agent-8.17.0-96f2b9\logs\elastic-agent-20250126.ndjson",145172230,error,"input.winlog","118,623",120,"winlog/input.go","github.com/elastic/beats/v7/filebeat/input/winlog.eventlogRunner.Run","winlog-default","Encountered channel not found error when opening Windows Event Log","-","-","-","-","-",filebeat,"-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
"Jan 26, 2025 @ 07:29:58.687",AZSkFzvraPYB5YHX2TBJ,"-",".ds-logs-elastic_agent-default-2025.01.16-000001","-","dc32aca6-a92d-4b83-94af-3651bdcacf6d","da9a681c-3265-4f44-a820-d74d0444418d","DESKTOP-PGGB831","-",filebeat,"8.17.0","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","elastic_agent",default,logs,"8.0.0","da9a681c-3265-4f44-a820-d74d0444418d",false,"8.17.0","-","-",verified,"-","-","-","elastic_agent","Jan 26, 2025 @ 14:30:13.000","-","-","-","-","-","-","-","-","-","-","x86_64","-","DESKTOP-PGGB831","caa1d453-ab67-4999-bba9-2a27f98fe24d","fe80::5266:3ed0:990b:b7ba, 192.168.1.100","52-54-00-F1-EB-C3","desktop-pggb831","19045.5371","-",windows,"10.0.19041.5369 (WinBuild.160101.0800)","Windows 10 Pro N","Windows 10 Pro N",windows,windows,"10.0","-",filestream,"-","-",393216,13070,"-","C:\Program Files\Elastic\Agent\data\elastic-agent-8.17.0-96f2b9\logs\elastic-agent-20250126.ndjson",145172230,info,"-","3,575",48,"capabilities/capabilities.go","github.com/elastic/elastic-agent/internal/pkg/capabilities.LoadFile","elastic-agent","Capabilities file not found in C:\Program Files\Elastic\Agent\capabilities.yml","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-"
